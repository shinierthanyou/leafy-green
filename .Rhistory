setwd("~/leafy-green")
setwd("~/leafy-green")
knitr::opts_chunk$set(echo = FALSE,cache = TRUE)
library(xlsx)
library(ggplot2)
library(gplots)
library(gridExtra)
library(corrplot)
library(dplyr)
library(png)
library(grid)
library(heatmaply)
Data <- read.xlsx(file = "Entire.xlsx", sheetName = "Sheet1")
F1 = Data[c(34:1846),]
F1 = F1[-c(13)]
F1$HD = F1$Height09 - F1$Height08
F1$Height09 = as.character(F1$Height09)
F1$Height09 = as.numeric(F1$Height09)
F1$Column = as.factor(F1$Column)
F1$Flower.Level = as.factor(F1$Flower.Level)
F1$HD = F1$Height09 - F1$Height08
attach(F1)
lm(Anth ~ Column, Row, Height)
mod = lm(Anth ~ Column, Row, Height)
summary(anth)
summary(QAnth)
summary(Anth)
summary(Column)
levels(Column)
summary(Row)
summary(Height)
as.factor(Row)
summary(Row)
mod = lm(Anth ~ Column, Row, Height)
anova(mod)
mod = lm(Anth ~ Column, Row, Height)
mod = lm(Anth ~ Column)
anova(mod)
mod = lm(Anth ~ Row)
anova(mod)
mod = lm(Anth ~ Height)
anova(mod)
mod = lm(Chl ~ Height)
anova(mod)
mod = lm(Chl ~ Row)
anova(mod)
mod = lm(Chl ~ Column)
anova(mod)
mod = lm(Flav ~ Column)
anova(mod)
mod = lm(Flav ~ Row)
anova(mod)
mod = lm(Flav ~ Height)
anova(mod)
mod = lm(Height08 ~ Row)
mod = lm(Height08 ~ Column)
anova(mod)
mod = lm(Height09 ~ Column)
anova(mod)
mod = lm(Height09 ~ Row)
anova(mod)
mod = lm(HD ~ Row)
anova(mod)
mod = lm(HD ~ Column)
anova(mod)
#Import and Arrange Data
Data <- read.xlsx(file = "Entire.xlsx", sheetName = "Sheet1")
F1 = Data[c(34:1846),]
F1 = F1[-c(13)]
F1$HD = F1$Height09 - F1$Height08
#Assign Description
F1$Height09 = as.character(F1$Height09)
F1$Height09 = as.numeric(F1$Height09)
F1$Column = as.factor(F1$Column)
F1$Flower.Level = as.factor(F1$Flower.Level)
#Removing Anthocyanin Outliers
OBA <-boxplot(F1$Anth,range = 3.5, plot = F)$out
OA = F1[which(F1$Anth %in% OBA),];OA
F1 <- F1[-which(F1$Anth %in% OBA),]
#Overall Means
F1$MAnth = mean(F1$Anth, na.rm = T)
F1$MChl = mean(F1$Chl, na.rm = T)
F1$MFlav = mean(F1$Flav, na.rm = T)
F1$M18 = mean(F1$Height08, na.rm = T)
F1$M19 = mean(F1$Height09, na.rm = T)
F1$MHD = mean(F1$HD, na.rm = T)
#Remove Overall Mean
F1$Anth2 = F1$Anth - F1$MAnth
F1$Chl2 = F1$Chl - F1$MChl
F1$Flav2 = F1$Flav - F1$MFlav
F1$H182 = F1$Height08 - F1$M18
F1$H192 = F1$Height09 - F1$M19
F1$HD2 = F1$HD - F1$MHD
#Leaf Height Chemical Mean
LM = group_by(F1, Height)
LM = summarise(LM, LMAnth = mean(Anth, na.rm = T), LMChl = mean(Chl, na.rm =T), LMFlav = mean(Flav,na.rm = T))
F1 = merge(F1, LM, by.x = "Height", all = TRUE)
#Overall Mean - Leaf Height Mean
F1$LMAnth2 = F1$MAnth - F1$LMAnth
F1$LMFlav2 = F1$MFlav - F1$LMFlav
#Update Measures
F1$Anth3 = F1$Anth2 + F1$LMAnth2
F1$Flav3 = F1$Flav2 + F1$LMFlav2
#Row Mean
RM = group_by(F1, Row)
RM = summarise(RM, RAnth = mean(Anth, na.rm = T), RChl = mean(Chl, na.rm =T), RFlav = mean(Flav,na.rm = T), R18 = mean(Height08, na.rm = T), R19 = mean(Height09, na.rm =T ), RHD = mean(HD, na.rm = T))
F1 = merge(F1, RM, by.x = "Row", all = TRUE)
#Overall Mean - Row Mean
F1$RAnth2 = F1$MAnth - F1$RAnth
F1$RChl2 = F1$MChl - F1$RChl
F1$RFlav2 = F1$MFlav - F1$RFlav
F1$R182 = F1$M18 - F1$R18
F1$R192 = F1$M19 - F1$R19
F1$RHD2 = F1$MHD - F1$RHD
#Update Measures
F1$Anth4 = F1$Anth3 + F1$RAnth2
F1$Chl4 = F1$Chl2 + F1$RChl2
F1$Flav4 = F1$Flav3 + F1$RFlav2
F1$H184 = F1$H182 + F1$R182
F1$H194 = F1$H192 + F1$R192
F1$HD4 = F1$HD2 + F1$RHD2
#Column Mean
CM = group_by(F1, Column)
CM = summarise(CM, CAnth = mean(Anth, na.rm = T), CChl = mean(Chl, na.rm =T), CFlav = mean(Flav,na.rm = T), C18 = mean(Height08, na.rm = T), C19 = mean(Height09, na.rm =T), CHD = (HD, na.rm = T))
#Import and Arrange Data
Data <- read.xlsx(file = "Entire.xlsx", sheetName = "Sheet1")
F1 = Data[c(34:1846),]
F1 = F1[-c(13)]
F1$HD = F1$Height09 - F1$Height08
#Assign Description
F1$Height09 = as.character(F1$Height09)
F1$Height09 = as.numeric(F1$Height09)
F1$Column = as.factor(F1$Column)
F1$Flower.Level = as.factor(F1$Flower.Level)
#Removing Anthocyanin Outliers
OBA <-boxplot(F1$Anth,range = 3.5, plot = F)$out
OA = F1[which(F1$Anth %in% OBA),];OA
F1 <- F1[-which(F1$Anth %in% OBA),]
#Overall Means
F1$MAnth = mean(F1$Anth, na.rm = T)
F1$MChl = mean(F1$Chl, na.rm = T)
F1$MFlav = mean(F1$Flav, na.rm = T)
F1$M18 = mean(F1$Height08, na.rm = T)
F1$M19 = mean(F1$Height09, na.rm = T)
F1$MHD = mean(F1$HD, na.rm = T)
#Remove Overall Mean
F1$Anth2 = F1$Anth - F1$MAnth
F1$Chl2 = F1$Chl - F1$MChl
F1$Flav2 = F1$Flav - F1$MFlav
F1$H182 = F1$Height08 - F1$M18
F1$H192 = F1$Height09 - F1$M19
F1$HD2 = F1$HD - F1$MHD
#Leaf Height Chemical Mean
LM = group_by(F1, Height)
LM = summarise(LM, LMAnth = mean(Anth, na.rm = T), LMChl = mean(Chl, na.rm =T), LMFlav = mean(Flav,na.rm = T))
F1 = merge(F1, LM, by.x = "Height", all = TRUE)
#Overall Mean - Leaf Height Mean
F1$LMAnth2 = F1$MAnth - F1$LMAnth
F1$LMFlav2 = F1$MFlav - F1$LMFlav
#Update Measures
F1$Anth3 = F1$Anth2 + F1$LMAnth2
F1$Flav3 = F1$Flav2 + F1$LMFlav2
#Row Mean
RM = group_by(F1, Row)
RM = summarise(RM, RAnth = mean(Anth, na.rm = T), RChl = mean(Chl, na.rm =T), RFlav = mean(Flav,na.rm = T), R18 = mean(Height08, na.rm = T), R19 = mean(Height09, na.rm =T ), RHD = mean(HD, na.rm = T))
F1 = merge(F1, RM, by.x = "Row", all = TRUE)
#Overall Mean - Row Mean
F1$RAnth2 = F1$MAnth - F1$RAnth
F1$RChl2 = F1$MChl - F1$RChl
F1$RFlav2 = F1$MFlav - F1$RFlav
F1$R182 = F1$M18 - F1$R18
F1$R192 = F1$M19 - F1$R19
F1$RHD2 = F1$MHD - F1$RHD
#Update Measures
F1$Anth4 = F1$Anth3 + F1$RAnth2
F1$Chl4 = F1$Chl2 + F1$RChl2
F1$Flav4 = F1$Flav3 + F1$RFlav2
F1$H184 = F1$H182 + F1$R182
F1$H194 = F1$H192 + F1$R192
F1$HD4 = F1$HD2 + F1$RHD2
#Column Mean
CM = group_by(F1, Column)
CM = summarise(CM, CAnth = mean(Anth, na.rm = T), CChl = mean(Chl, na.rm =T), CFlav = mean(Flav,na.rm = T), C18 = mean(Height08, na.rm = T), C19 = mean(Height09, na.rm =T), CHD = mean(HD, na.rm = T))
F1 = merge(F1, CM, by.x = "Column", all = TRUE)
#Overall Mean - Column Mean
F1$CFlav2 = F1$MFlav - F1$CFlav
F1$C182 = F1$M18 - F1$C18
F1$C192 = F1$M19 - F1$C19
F1$CHD2 = F1$MHD - F1$CHD
#Update Measures
F1$Flav5 = F1$Flav4 + F1$CFlav2
F1$H185 = F1$H184 + F1$C182
F1$H195 = F1$H194 + F1$C192
F1$HD5 = F1$HD4 + F1$CHD2
F1$Chl5 = F1$Chl4
F1$Anth5 = F1$Anth4
-171.20+1.1.12+0.83-313.28
1.12+0.83-313.28-171.20
30/4
modA1 = lm(F1$Anth5 ~ F1$Tree.ID)
summary(modA1)
head(summary(modA1))
summary(modA1)
modA2 = lm(F1$Anth5 ~ F1$Height)
anova(modA2)
plot(modA2)
summary(modA2)
summary(modA2)
modA22 = lm(HH$Anth ~ HM$Anth)
#Subset Leaf Height
HWT = group_by(F1, Height, Tree.ID)
HWT = summarise(HWT, Anth = mean(Anth5, na.rm = T), Chl = mean(Chl5, na.rm = T), Flav = mean(Flav5, na.rm = T), H18 = mean(H185, na.rm = T), H19 = mean(H195, na.rm = T), HDiff = mean(HDiff, na.rm = T))
#Subset Leaf Height
HWT = group_by(F1, Height, Tree.ID)
HWT = summarise(HWT, Anth = mean(Anth5, na.rm = T), Chl = mean(Chl5, na.rm = T), Flav = mean(Flav5, na.rm = T), H18 = mean(H185, na.rm = T), H19 = mean(H195, na.rm = T), HDiff = mean(HD5, na.rm = T))
HM = HWT$Height == "M"
HM = HWT[HM,]
HH = HWT$Height == "H"
HH = HWT[HH,]
HL = HWT$Height == "L"
HL = HWT[HL,]
modA22 = lm(HH$Anth ~ HM$Anth)
anova(modA22)
plot(modA22)
summary(modA22)
summary(modA22)
modA3 = lm(F1$Anth5 ~ F1$Row)
summary(modA3)
#Anthocyanin
AP1 = ggplot(F1) + aes(x = Row, y = Anth5) + geom_boxplot(fill = "dodgerblue1") + ylab("Anth") + xlab("Row") + ggtitle("Anthocyanin by Row") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = 0, colour = "red");AP1
AP12 <-ggplot(R) +aes(x = Row, y = AnthR) + geom_point() +geom_hline(yintercept = mean(F1$Anth5, na.rm = T), colour = "dodgerblue1")+ ylab("Anthocyanin") + xlab("Row") + ggtitle("Anthocyanin Row Means")+theme_bw()+theme(plot.title = element_text(hjust = 0.5));AP12
R = group_by(F1, Row)
R = summarise(R, AnthR = mean(Anth5, na.rm = T), ChlR = mean(Chl5, na.rm =T), FlavR = mean(Flav5,na.rm = T), H18R = mean(H185, na.rm = T), H19R = mean(H195, na.rm =T), HDR = mean(HDiff, na.rm =T))
R = group_by(F1, Row)
R = summarise(R, AnthR = mean(Anth5, na.rm = T), ChlR = mean(Chl5, na.rm =T), FlavR = mean(Flav5,na.rm = T), H18R = mean(H185, na.rm = T), H19R = mean(H195, na.rm =T), HDR = mean(HD5, na.rm =T))
AP12 <-ggplot(R) +aes(x = Row, y = AnthR) + geom_point() +geom_hline(yintercept = mean(F1$Anth5, na.rm = T), colour = "dodgerblue1")+ ylab("Anthocyanin") + xlab("Row") + ggtitle("Anthocyanin Row Means")+theme_bw()+theme(plot.title = element_text(hjust = 0.5));AP12
#Chlorophyll
CP1 = ggplot(F1) + aes(x = Row, y = Chl5) + geom_boxplot(fill = "dodgerblue1") + ylab("Chl") + xlab("Row") + ggtitle("Chlorophyll by Row") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = 0, colour = "red");CP1
CP12 <-ggplot(R) +aes(x = Row, y = ChlR) + geom_point() +geom_hline(yintercept = mean(F1$Chl5, na.rm = T), colour = "dodgerblue1")+ ylab("Chlorophyll") + xlab("Row") + ggtitle("Chlorophyll Row Means")+theme_bw()+theme(plot.title = element_text(hjust = 0.5));CP12
modC3 = lm(F1$Chl5 ~ F1$Row)
anova(modC3)
plot(modC3)
summary(modC3)
#Flavonol
FP1 = ggplot(F1) + aes(x = Row, y = Flav5) + geom_boxplot(fill = "dodgerblue1") + ylab("Flav") + xlab("Row") + ggtitle("Flavonol by Row") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = 0, colour = "red");FP1
FP12 <-ggplot(R) +aes(x = Row, y = FlavR) + geom_point() +geom_hline(yintercept = mean(F1$Flav5, na.rm = T), colour = "dodgerblue1")+ ylab("Flavonol") + xlab("Row") + ggtitle("Flavonol Row Means")+theme_bw()+theme(plot.title = element_text(hjust = 0.5));FP12
modF3 = lm(F1$Flav5 ~ F1$Row)
anova(modF3)
plot(modF3)
summary(modF3)
modHD1 = lm(F1$HD5 ~ F1$Tree.ID)
modHD1 = lm(F1$Tree.ID ~ F1$HD5)
F1$HD5
View(F1)
