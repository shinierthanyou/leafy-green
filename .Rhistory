Dup <-read.xlsx("Full.xlsx", sheetName ="Dup")
head(Dup)
#Isolate Crimson Glory Outgroup
CG = Data[c(1:11),]
#Isolate East Cape 201 Parent
EC201 = Data[c(12:21),]
#Isolate East Cape 103 Parent
EC103 = Data[c(22:33),]
#Isolate Offspring from the Parental Cross
F1 = Data[c(34:1825),]
HWT = group_by(F1, Height, Tree.ID)
HWT = summarise(HWT, Anth = mean(Anth, na.rm = T), Chl = mean(Chl, na.rm = T), Flav = mean(Flav, na.rm = T), NBI = mean(NBI, na.rm = T))
head(HWT)
High = HWT[c(1:159),]
Mid = HWT[c(319:477),]
Low = HWT[c(160:318),]
AHLA = lm(High$Anth ~ Low$Anth)
anova(AHLA)
as.table(summary(AHLA))
head((summary(AHLA)))
summary(AHLA)
#Divide data into Columns maaan.
summary(F1$Column)
HHA <-ggplot(F1) +aes(Anth,color= "dodgerblue1", fill=Height) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Anthocyanin") + ggtitle("Anthocyanin by Height") +theme_bw() +theme(plot.title = element_text(hjust = 0.5));HHA
HHA <-ggplot(F1) +aes(Anth,color= "dodgerblue1", fill= "dodgerblue1") +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Anthocyanin") + ggtitle("Anthocyanin by Height") +theme_bw() +theme(plot.title = element_text(hjust = 0.5));HHA
HHA <-ggplot(F1) +aes(Anth,color= "dodgerblue1", fill= "dodgerblue1") +geom_histogram(), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Anthocyanin") + ggtitle("Anthocyanin by Height") +theme_bw() +theme(plot.title = element_text(hjust = 0.5));HHA
HHA <-ggplot(F1) +aes(Anth) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" ), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Anthocyanin") + ggtitle("Anthocyanin by Height") +theme_bw() +theme(plot.title = element_text(hjust = 0.5));HHA
HHA <-ggplot(F1) +aes(Anth) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" ) alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Anthocyanin") + ggtitle("Anthocyanin by Height") +theme_bw() +theme(plot.title = element_text(hjust = 0.5));HHA
HHA <-ggplot(F1) +aes(Anth) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" ), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Anthocyanin") + ggtitle("Anthocyanin by Height") +theme_bw() +theme(plot.title = element_text(hjust = 0.5));HHA
HHA <-ggplot(F1) +aes(Anth) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Anthocyanin") + ggtitle("Anthocyanin by Height") +theme_bw() +theme(plot.title = element_text(hjust = 0.5));HHA
HHA <-ggplot(F1) +aes(Anth) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1")+ geom_density(alpha=.2, colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Anthocyanin") + ggtitle("Anthocyanin by Height") +theme_bw() +theme(plot.title = element_text(hjust = 0.5));HHA
HHC <-ggplot(F1) +aes(Chl) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1")+ geom_density(alpha=.2, colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Anthocyanin") + ggtitle("Anthocyanin by Height") +theme_bw() +theme(plot.title = element_text(hjust = 0.5));HHC
HMC <-ggplot(F1) +aes(x = Tree.ID, y = Chl, colour = Height, fill = Height) + geom_point() +geom_hline(yintercept = mean(F1$Chl), colour = "dodgerblue1")+ ylab("Chlorophyll") + xlab("Tree ID") + ggtitle("Chlorophyll Height Measures")+theme_bw()+theme(plot.title = element_text(hjust = 0.5));HMC
HHC <-ggplot(F1) +aes(Chl) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1")+ geom_density(alpha=.2, colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Anthocyanin") + ggtitle("Chlorphyll Distribution") +theme_bw() +theme(plot.title = element_text(hjust = 0.5));HHC
HWT = group_by(F1, Height, Tree.ID)
HWT = summarise(HWT, Anth = mean(Anth, na.rm = T), Chl = mean(Chl, na.rm = T), Flav = mean(Flav, na.rm = T), NBI = mean(NBI, na.rm = T))
head(HWT)
High = HWT[c(1:159),]
Mid = HWT[c(319:477),]
Low = HWT[c(160:318),]
HighMid = rbind(High,Mid)
HHN <-ggplot(HighMid) +aes(Anth,color=Height, fill=Height) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Nitrogen") + ggtitle("Nitrogen by Height") +theme_bw() +theme(plot.title = element_text(hjust = 0.5));HHN
ggplot(HighMid) +aes(Anth,color=Height, fill=Height) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Nitrogen") + ggtitle("Anthocyanin by Height") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
HighLow = rbind(High,Low)
MidLow = rbind(Mid,Low)
ggplot(HighLow) +aes(Anth,color=Height, fill=Height) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Nitrogen") + ggtitle("Anthocyanin by Height") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
ggplot(HighMid) +aes(Anth,color=Height, fill=Height) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Nitrogen") + ggtitle("Anthocyanin by Height") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
ggplot(MidLow) +aes(Anth,color=Height, fill=Height) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Nitrogen") + ggtitle("Anthocyanin by Height") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
ggplot(HighLow) +aes(Chl,color=Height, fill=Height) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Nitrogen") + ggtitle("Anthocyanin by Height") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
ggplot(HighLow) +aes(Chl,color=Height, fill=Height) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Chlorophyll") + ggtitle("Chlorophyll by Height") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
ggplot(HighLow) +aes(Anth,color=Height, fill=Height) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Anthocyanin") + ggtitle("Anthocyanin by Height") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
ggplot(HighLow) +aes(Chl,color=Height, fill=Height) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Chlorophyll") + ggtitle("Chlorophyll by Height") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
ggplot(HighMid) +aes(Chl,color=Height, fill=Height) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Chlorophyll") + ggtitle("Chlorophyll by Height") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
ggplot(MidLow) +aes(Chl,color=Height, fill=Height) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Chlorophyll") + ggtitle("Chlorophyll by Height") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
ggplot(HighLow) +aes(Flav,color=Height, fill=Height) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Flavonol") + ggtitle("Flavonol by Height") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
ggplot(HighMid) +aes(Flav,color=Height, fill=Height) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Flavonol") + ggtitle("Flavonol by Height") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
ggplot(MidLow) +aes(Flav,color=Height, fill=Height) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Flavonol") + ggtitle("Flavonol by Height") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
ggplot(HighLow) +aes(NBI,color=Height, fill=Height) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("NBI") + ggtitle("Nitrogen by Height") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
ggplot(HighMid) +aes(NBI,color=Height, fill=Height) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("NBI") + ggtitle("Nitrogen by Height") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
ggplot(MidLow) +aes(NBI,color=Height, fill=Height) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("NBI") + ggtitle("Nitrogen by Height") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
#Anthocyanin Boxplot
FBA2 = ggplot(Dat) + aes(x = Tree.ID, y = Anth5) + geom_boxplot(colour = "turquoise4") + ylab("Anthocyanin Measure") + xlab("F1") + ggtitle("F1 Anth After Correction") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$Anth5), colour = "orchid3")
setwd("~/leafy-green")
knitr::opts_chunk$set(echo = TRUE,cache = TRUE)
library(xlsx)
library(ggplot2)
library(gplots)
library(gridExtra)
library(corrplot)
library(dplyr)
library(png)
library(grid)
library(heatmaply)
library(corrplot)
H08  = read.xlsx("Height phenotype 20 April 2018 and 2019", sheetName = "Phenotypes April 2018")
H08  = read.xlsx("Height phenotype 20 April 2018 and 2019.xlsx", sheetName = "Phenotypes April 2018")
H09 = read.xlsx("Height phenotype 20 April 2018 and 2019.xlsx", sheetName = "Phenotypes April 2019")
H08$Tree.ID = H08$NA.
H09$Tree.ID = H09$NA.
HeightData = cbind(H08,H09)
HeightData = cbind(H08,H09, by.x = "Tree.ID")
H08 = read.xlsx("Height phenotype 20 April 2018 and 2019.xlsx", sheetName = "Phenotypes April 2018")
H09 = read.xlsx("Height phenotype 20 April 2018 and 2019.xlsx", sheetName = "Phenotypes April 2019")
H08$Tree.ID = H08$NA.
H09$Tree.ID = H09$NA.
HeightData = cbind(H08,H09, by.x = "Tree.ID")
HeightData = merge(H08,H09, by.x = "Tree.ID")
HeightData = merge(H08,H09, by.y = "Tree.ID")
HeightData = merge(H08,H09, by.x = "Tree.ID")
HeightData = merge(H08,H09, by.x = "NA.")
HeightData = cbind(H08,H09, by.x = "NA.")
HeightData = full_join(H08,H09, by.x = "NA.")
H08 = read.xlsx("Height phenotype 20 April 2018 and 2019.xlsx", sheetName = "Phenotypes April 2018")
H09 = read.xlsx("Height phenotype 20 April 2018 and 2019.xlsx", sheetName = "Phenotypes April 2019")
ViewH08
View(H08)
H08$Tree.ID = H08$NA.
H09$Tree.ID = H09$NA.
H08 = H08[c(4,12)]
View(H09)
H09 = H09[c(13,4)]
View(H09)
H08 = H08[c(12,4)]
H08 = read.xlsx("Height phenotype 20 April 2018 and 2019.xlsx", sheetName = "Phenotypes April 2018")
H08$Tree.ID = H08$NA.
H08 = H08[c(12,4)]
H089 = merge(H08,H09, by.x = "Tree.ID")
H089 = cbind(H08.H09)
View(H09)
H089 = cbind(H08.H09)
H089 = full_join(H08.H09)
H089 = merge(H08,H09)
View(H089)
H08 = read.xlsx("Height phenotype 20 April 2018 and 2019.xlsx", sheetName = "Phenotypes April 2018")
H09 = read.xlsx("Height phenotype 20 April 2018 and 2019.xlsx", sheetName = "Phenotypes April 2019")
H08$Tree.ID = H08$NA.
H09$Tree.ID = H09$NA.
H08 = H08[c(12,4)]
H09 = H09[c(13,4)]
H089 = merge(H08,H09)
View(H089)
H089 = merge(H08,H09, by.x = "Tree.ID")
H08 = read.xlsx("Height phenotype 20 April 2018 and 2019.xlsx", sheetName = "Phenotypes April 2018")
H09 = read.xlsx("Height phenotype 20 April 2018 and 2019.xlsx", sheetName = "Phenotypes April 2019")
H08$Tree.ID = H08$NA.
H09$Tree.ID = H09$NA.
H08 = H08[c(12,4)]
H09 = H09[c(13,4)]
H089 = merge(H08,H09, by.x = "Tree.ID")
H089 = cbind(H08,H09, by.x = "Tree.ID")
H089 = full_join(H08,H09)
H08$Tree.ID = as.factor(H08$Tree.ID)
H09$Tree.ID = as.factor(H09$Tree.ID)
H08$Height = as.numeric(H08$Height)
H09$Height = as.numeric(H08$Height)
H09$Height = as.numeric(H09$Height)
H089 = full_join(H08,H09)
View(H089)
H089 = merge(H08,H09, by.x = "Tree.ID")
H089 = cbind(H08,H09, by.x = "Tree.ID")
H089 = cbind(H08,H09)
H08$Height08 = H08$Height
H08 = read.xlsx("Height phenotype 20 April 2018 and 2019.xlsx", sheetName = "Phenotypes April 2018")
H09 = read.xlsx("Height phenotype 20 April 2018 and 2019.xlsx", sheetName = "Phenotypes April 2019")
H08$Tree.ID = H08$NA.
H08$Height08 = H08$Height
H09$Tree.ID = H09$NA.
H09$Height09 = H09$Height
Vewi(H08)
View(H8)
View(H08)
H08 = H08[c(12,13)]
H09 = H09[c(13,14)]
H089 = cbind(H08,H09)
View(H08)
H08 = read.xlsx("Height phenotype 20 April 2018 and 2019.xlsx", sheetName = "Phenotypes April 2018")
H09 = read.xlsx("Height phenotype 20 April 2018 and 2019.xlsx", sheetName = "Phenotypes April 2019")
H08$Tree.ID = H08$NA.
H08$Height08 = H08$Height
H09$Tree.ID = H09$NA.
H09$Height09 = H09$Height
H08 = H08[c(12,13)]
H09 = H09[c(13,14)]
H089 = merge(H08.H09, by.x = "Tree.ID"
H089 = merge(H08.H09, by.x = "Tree.ID")
H089 = merge(H08.H09, by.x = "Tree.ID")
H089 = merge(H08,H09, by.x = "Tree.ID")
Vewi(H089)
View(H089)
# Import Data Measures
Data <-read.xlsx("Full.xlsx", sheetName ="Full")
head(Data)
Data$Column = as.factor(Data$Column)
Data$Row = as.factor(Data$Row)
# Import Replicate Data
Dup <-read.xlsx("Full.xlsx", sheetName ="Dup")
head(Dup)
#Isolate Crimson Glory Outgroup
CG = Data[c(1:11),]
#Isolate East Cape 201 Parent
EC201 = Data[c(12:21),]
#Isolate East Cape 103 Parent
EC103 = Data[c(22:33),]
#Isolate Offspring from the Parental Cross
F1 = Data[c(34:1825),]
Dat = F1
#Identifying outliers outside
OBA <-boxplot(Dat$Anth,range = 3.5, plot = F)$out
OBC <-boxplot(Dat$Chl,range = 3, plot = F)$out
OBF <-boxplot(Dat$Flav,range = 3, plot = F)$out
OBN <-boxplot(Dat$NBI,range = 3,plot=F)$out
#Isolating outliers exceeding
OA = Dat[which(Dat$Anth %in% OBA),];OA
OC = Dat[which(Dat$Anth %in% OBC),];OC
OF = Dat[which(Dat$Anth %in% OBF),];OF
ON = Dat[which(Dat$Anth %in% OBN),];ON
Dat <- Dat[-which(Dat$Anth %in% OBA),]
DATG <- ggplot(F1) + aes(x = Tree.ID, y = Anth,) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Anth") + xlab("Tree ID") + ggtitle("Anthocyanin Raw Data") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$Anth))
DATG2 <- ggplot(Dat) + aes(x = Tree.ID, y = Anth,) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Anth") + xlab("Tree ID") + ggtitle("Anthocyanin Outliers Removed") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$Anth))
grid.arrange(DATG,DATG2)
#Total Mean
Dat$ATmean = mean(Dat$Anth)
Dat$CTmean = mean(Dat$Chl)
Dat$FTmean = mean(Dat$Flav)
Dat$NTmean = mean(Dat$NBI)
#Remove Total Mean
Dat$Anth2 = Dat$Anth - Dat$ATmean
Dat$Chl2 = Dat$Chl - Dat$CTmean
Dat$Flav2 = Dat$Flav - Dat$FTmean
Dat$NBI2 = Dat$NBI - Dat$NTmean
#Height Mean for Anth and Flav
DatH = group_by(Dat, Height)
DatH = summarise(DatH, HAnth = mean(Anth, na.rm = T), HChl = mean(Chl, na.rm =T), HFlav = mean(Flav,na.rm = T), HNBI = mean(NBI, na.rm = T))
#Add Height Mean to Data
Dat =merge(Dat, DatH, by.x = "Height")
#Calculate Height Mean Deviation from Total Mean
Dat$ATH = Dat$ATmean - Dat$HAnth
Dat$CTH = Dat$CTmean - Dat$HChl
Dat$FTH = Dat$FTmean - Dat$HFlav
Dat$NTH = Dat$NTmean - Dat$HNBI
#Controlling for Height Anth and Flav
Dat$Anth3 = Dat$Anth2 + Dat$ATH
Dat$Chl3 = Dat$Chl2 + Dat$CTH
Dat$Flav3 = Dat$Flav2 + Dat$FTH
Dat$NBI3 = Dat$NBI2 + Dat$NTH
#Column Mean for Chl, Flav,NBI
DatC = group_by(Dat, Column)
DatC = summarise(DatC, CAnth = mean(Anth, na.rm = T), CChl = mean(Chl, na.rm = T) ,CFlav = mean(Flav,na.rm = T), CNBI = mean(NBI,na.rm = T))
#Add Column Mean to Data
Dat =merge(Dat, DatC, by.x = "Column")
#Calculate Column Mean Deviation from Total Mean
Dat$ATC = Dat$ATmean - Dat$CAnth
Dat$CTC = Dat$CTmean - Dat$CChl
Dat$FTC = Dat$FTmean - Dat$CFlav
Dat$NTC = Dat$NTmean - Dat$CNBI
#Controlling for Column Chl, Flav and NBI
Dat$Anth4 = Dat$Anth3 + Dat$ATC
Dat$Chl4 = Dat$Chl2 + Dat$CTC
Dat$Flav4 = Dat$Flav3 + Dat$FTC
Dat$NBI4 = Dat$NBI3 + Dat$NTC
#Row Mean for Anth, Chl, Flav and and NBI
DatR = group_by(Dat, Row)
DatR = summarise(DatR, RAnth = mean(Anth,na.rm = T),RChl = mean(Chl,na.rm = T), RFlav = mean(Flav,na.rm = T), RNBI = mean(NBI,na.rm = T))
#Add Row Mean to Data
Dat =merge(Dat, DatR, by.x = "Row")
#Calculate Row Mean Deviation from Total Mean
Dat$ATR = Dat$ATmean - Dat$RAnth
Dat$CTR = Dat$CTmean - Dat$RChl
Dat$FTR = Dat$FTmean - Dat$RFlav
Dat$NTR = Dat$NTmean - Dat$RNBI
#Controlling for Row in Anth, Chl, Flav and NBI
Dat$Anth5 = Dat$Anth4 + Dat$ATR
Dat$Chl5 = Dat$Chl4 + Dat$CTR
Dat$Flav5 = Dat$Flav4 + Dat$FTR
Dat$NBI5 = Dat$NBI4 + Dat$NTR
View(Dat)
DatTree = group_by(Dat, Tree.ID)
DatTree = group_by(Dat, Tree.ID, Column, Row)
DatTree = summarise(DatTree, Anth = mean(Anth4), Flav = mean(Flav5), Chl = mean(Chl3),NBI = mean(NBI4))
View(DatTree)
DatTree = merge(DatTree, H089, by.x = "Tree.ID")
View(DatTree)
DatTree = group_by(Dat, Tree.ID, Column, Row)
DatTree = summarise(DatTree, Anth = mean(Anth4), Flav = mean(Flav5), Chl = mean(Chl3),NBI = mean(NBI4))
View(DatTree)
H08 = read.xlsx("Height phenotype 20 April 2018 and 2019.xlsx", sheetName = "Phenotypes April 2018")
H09 = read.xlsx("Height phenotype 20 April 2018 and 2019.xlsx", sheetName = "Phenotypes April 2019")
H08$Tree.ID = H08$NA.
H08$Height08 = H08$Height
H09$Tree.ID = H09$NA.
H09$Height09 = H09$Height
H08 = H08[c(12,13)]
H09 = H09[c(13,14)]
H089 = merge(H08,H09, by.x = "Tree.ID")
H089$Tree.ID = as.factor(H089$Tree.ID)
DatTree = group_by(Dat, Tree.ID, Column, Row)
DatTree = summarise(DatTree, Anth = mean(Anth4), Flav = mean(Flav5), Chl = mean(Chl3),NBI = mean(NBI4))
DatTree$Tree.ID = as.factor(DatTree$Tree.ID)
DatTree = merge(DatTree, H089, by.x = "Tree.ID")
View(DatTree)
H08 = read.xlsx("Height phenotype 20 April 2018 and 2019.xlsx", sheetName = "Phenotypes April 2018")
H09 = read.xlsx("Height phenotype 20 April 2018 and 2019.xlsx", sheetName = "Phenotypes April 2019")
H08$Tree.ID = H08$NA.
H08$Height08 = H08$Height
H09$Tree.ID = H09$NA.
H09$Height09 = H09$Height
H08 = H08[c(12,13)]
H09 = H09[c(13,14)]
H089 = merge(H08,H09, by.x = "Tree.ID")
H089$Tree.ID = as.factor(H089$Tree.ID)
DatTree = group_by(Dat, Tree.ID, Column, Row)
DatTree = summarise(DatTree, Anth = mean(Anth4), Flav = mean(Flav5), Chl = mean(Chl3),NBI = mean(NBI4))
DatTree$Tree.ID = as.factor(DatTree$Tree.ID)
H089 = merge(H089,DatTree, by.x = "Tree.ID")
View(H089)
H08 = read.xlsx("Height phenotype 20 April 2018 and 2019.xlsx", sheetName = "Phenotypes April 2018")
H09 = read.xlsx("Height phenotype 20 April 2018 and 2019.xlsx", sheetName = "Phenotypes April 2019")
H08$Tree.ID = H08$NA.
H08$Height08 = H08$Height
H09$Tree.ID = H09$NA.
H09$Height09 = H09$Height
H08 = H08[c(12,13)]
H09 = H09[c(13,14)]
H089 = merge(H08,H09, by.x = "Tree.ID")
H089$Tree.ID = as.factor(H089$Tree.ID)
DatTree = group_by(Dat, Tree.ID, Column, Row)
DatTree = summarise(DatTree, Anth = mean(Anth4), Flav = mean(Flav5), Chl = mean(Chl3),NBI = mean(NBI4))
DatTree$Tree.ID = as.factor(DatTree$Tree.ID)
H089 = merge(H089,DatTree, by.x = "Tree.ID", x.all = TRUE)
View(H089)
H08 = read.xlsx("Height phenotype 20 April 2018 and 2019.xlsx", sheetName = "Phenotypes April 2018")
H09 = read.xlsx("Height phenotype 20 April 2018 and 2019.xlsx", sheetName = "Phenotypes April 2019")
H08$Tree.ID = H08$NA.
H08$Height08 = H08$Height
H09$Tree.ID = H09$NA.
H09$Height09 = H09$Height
H08 = H08[c(12,13)]
H09 = H09[c(13,14)]
H089 = merge(H08,H09, by.x = "Tree.ID")
H089$Tree.ID = as.factor(H089$Tree.ID)
DatTree = group_by(Dat, Tree.ID, Column, Row)
DatTree = summarise(DatTree, Anth = mean(Anth4), Flav = mean(Flav5), Chl = mean(Chl3),NBI = mean(NBI4))
DatTree$Tree.ID = as.factor(DatTree$Tree.ID)
H089 = merge(H089,DatTree, by.x = "Tree.ID", all.x = TRUE)
View(H089)
H08 = read.xlsx("Height phenotype 20 April 2018 and 2019.xlsx", sheetName = "Phenotypes April 2018")
H09 = read.xlsx("Height phenotype 20 April 2018 and 2019.xlsx", sheetName = "Phenotypes April 2019")
H08$Tree.ID = H08$NA.
H08$Height08 = H08$Height
H09$Tree.ID = H09$NA.
H09$Height09 = H09$Height
H08 = H08[c(12,13)]
H09 = H09[c(13,14)]
H089 = merge(H08,H09, by.x = "Tree.ID")
H089$Tree.ID = as.factor(H089$Tree.ID)
DatTree = group_by(Dat, Tree.ID, Column, Row)
DatTree = summarise(DatTree, Anth = mean(Anth4), Flav = mean(Flav5), Chl = mean(Chl3),NBI = mean(NBI4))
DatTree$Tree.ID = as.factor(DatTree$Tree.ID)
H089 = merge(H089,DatTree, by.x = "Tree.ID", all.y = TRUE)
View(H089)
H08 = read.xlsx("Height phenotype 20 April 2018 and 2019.xlsx", sheetName = "Phenotypes April 2018")
H09 = read.xlsx("Height phenotype 20 April 2018 and 2019.xlsx", sheetName = "Phenotypes April 2019")
H08$Tree.ID = H08$NA.
H08$Height08 = H08$Height
H09$Tree.ID = H09$NA.
H09$Height09 = H09$Height
H08 = H08[c(12,13)]
H09 = H09[c(13,14)]
H089 = merge(H08,H09, by.x = "Tree.ID")
H089$Tree.ID = as.factor(H089$Tree.ID)
DatTree = group_by(Dat, Tree.ID, Column, Row)
DatTree = summarise(DatTree, Anth = mean(Anth4), Flav = mean(Flav5), Chl = mean(Chl3),NBI = mean(NBI4))
DatTree$Tree.ID = as.factor(DatTree$Tree.ID)
H089 = merge(H089,DatTree, by.x = "Tree.ID", all.y = TRUE, all.x = TRUE)
View(H089)
H08 = read.xlsx("Height phenotype 20 April 2018 and 2019.xlsx", sheetName = "Phenotypes April 2018")
H09 = read.xlsx("Height phenotype 20 April 2018 and 2019.xlsx", sheetName = "Phenotypes April 2019")
H08$Tree.ID = H08$NA.
H08$Height08 = H08$Height
H09$Tree.ID = H09$NA.
H09$Height09 = H09$Height
H08 = H08[c(12,13)]
H09 = H09[c(13,14)]
H089 = merge(H08,H09, by.x = "Tree.ID")
H089$Tree.ID = as.factor(H089$Tree.ID)
DatTree = group_by(Dat, Tree.ID, Column, Row)
DatTree = summarise(DatTree, Anth = mean(Anth4), Flav = mean(Flav5), Chl = mean(Chl3),NBI = mean(NBI4))
DatTree$Tree.ID = as.factor(DatTree$Tree.ID)
H089 = merge(H089,DatTree, by.x = "Tree.ID", all = TRUE)
H08 = read.xlsx("Height phenotype 20 April 2018 and 2019.xlsx", sheetName = "Phenotypes April 2018")
H09 = read.xlsx("Height phenotype 20 April 2018 and 2019.xlsx", sheetName = "Phenotypes April 2019")
H08$Tree.ID = H08$NA.
H08$Height08 = H08$Height
H09$Tree.ID = H09$NA.
H09$Height09 = H09$Height
H08 = H08[c(12,13)]
H09 = H09[c(13,14)]
H089 = merge(H08,H09, by.x = "Tree.ID")
H089$Tree.ID = as.factor(H089$Tree.ID)
DatTree = group_by(Dat, Tree.ID, Column, Row)
DatTree = summarise(DatTree, Anth = mean(Anth4), Flav = mean(Flav5), Chl = mean(Chl3),NBI = mean(NBI4))
DatTree$Tree.ID = as.factor(DatTree$Tree.ID)
H089 = merge(H089,DatTree, by.x = "Tree.ID", all = TRUE)
View(H089)
H08 = read.xlsx("Height phenotype 20 April 2018 and 2019.xlsx", sheetName = "Phenotypes April 2018")
H09 = read.xlsx("Height phenotype 20 April 2018 and 2019.xlsx", sheetName = "Phenotypes April 2019")
H08$Tree.ID = H08$NA.
H08$Height08 = H08$Height
H09$Tree.ID = H09$NA.
H09$Height09 = H09$Height
H08 = H08[c(12,13)]
H09 = H09[c(13,14)]
H089 = merge(H08,H09, by.x = "Tree.ID")
H089$Tree.ID = as.factor(H089$Tree.ID)
write.xlsx("H089. xlsx", sheetName = "H089")
write.xlsx("H089.xlsx", sheetName = "H089")
write.xlsx(H089."H089.xlsx", sheetName = "H089")
write.xlsx(H089, "H089.xlsx", sheetName = "H089")
H089 = read.xlsx("H0892.xlsx", sheetName = "H089")
H089 = merge(H089,DatTree, by.x = "Tree.ID", all = TRUE)
View(H089)
H089$Diff = H089$Height09 - H089$Height08
H089$Height08 = as.numeric(H089$Height08)
H089$Height09  = as.numeric(H089$Height09)
H089$Diff = H089$Height09 - H089$Height08
View(H089$Diff)
View(H089)
DatTree = group_by(Dat, Tree.ID, Column, Row)
DatTree = summarise(DatTree, Anth = mean(Anth4), Flav = mean(Flav5), Chl = mean(Chl3),NBI = mean(NBI4))
DatTree$Tree.ID = as.factor(DatTree$Tree.ID)
H089 = read.xlsx("H0892.xlsx", sheetName = "H089")
H089 = merge(H089,DatTree, by.x = "Tree.ID", all = TRUE)
H089$Height08 = as.numeric(H089$Height08)
H089$Height09  = as.numeric(H089$Height09)
H089$Diff = H089$Height09 - H089$Height08
View(H089)
DatTree = group_by(Dat, Tree.ID, Column, Row)
DatTree = summarise(DatTree, Anth = mean(Anth4), Flav = mean(Flav5), Chl = mean(Chl3),NBI = mean(NBI4))
DatTree$Tree.ID = as.factor(DatTree$Tree.ID)
H089 = read.xlsx("H0892.xlsx", sheetName = "H089")
H089 = merge(H089,DatTree, by.x = "Tree.ID", all = TRUE)
View(H089)
H089$Height08 = as.numeric(H089$Height08)
H089$Height09  = as.numeric(H089$Height09)
View(H089)
H089$Height08 = as.character(H089$Height08)
H089$Height08 = as.numeric(H089$Height08)
H089$Height09 = as.character(H089$Height09)
H089$Height09  = as.numeric(H089$Height09)
H089$Diff = H089$Height09 - H089$Height08
View(H089)
DatTree = group_by(Dat, Tree.ID, Column, Row)
DatTree = summarise(DatTree, Anth = mean(Anth4), Flav = mean(Flav5), Chl = mean(Chl3),NBI = mean(NBI4))
DatTree$Tree.ID = as.factor(DatTree$Tree.ID)
H089 = read.xlsx("H0892.xlsx", sheetName = "H089")
H089 = merge(H089,DatTree, by.x = "Tree.ID", all = TRUE)
H089$Height08 = as.character(H089$Height08)
H089$Height08 = as.numeric(H089$Height08)
H089$Height09 = as.character(H089$Height09)
H089$Height09  = as.numeric(H089$Height09)
H089$Diff = H089$Height09 - H089$Height08
View(H089)
H0A = lm(H089$Diff ~ H089$Chl)
anova(H0A)
H0A = lm(H089$Diff ~ H089$Anth)
anova(H0A)
H0C = lm(H089$Diff ~ H089$Chl)
anova(H0C)
H0F = lm(H089$Flav ~ H089$Diff)
anova(H0F)
H0N = lm(H089$NBI ~ H089$Diff)
anova(H0N)
anova(H0F)
H08A = lm(H089$Anth ~ H089$Height08)
anova(H08A)
H09A = lm(H089$Anth ~ H089$Height09)
anova(H09A)
H08A = lm(H089$Anth ~ H089$Height08)
anova(H08A)
H08C = lm(H089$Chl ~ H089$Height08)
anova(H08C)
H0C = lm(H089$Chl ~ H089$Diff)
anova(H0C)
H09C = lm(H089$Chl ~ H089$Height09)
anova(H09C)
H08F = lm(H089$Flav ~ H089$Height08)
anova(H08F)
H09F = lm(H089$Flav ~ H089$Height09)
anova(H09F)
H08N = lm(H089$NBI ! H089$Height08)
H08N = lm(H089$NBI ~ H089$Height08)
anova(H08N)
H09N = lm(H089$NBI ~ H089$Height09)
anova(H09N)
H089$Height08 = as.character(H089$Height08)
H089$Height08 = as.numeric(H089$Height08)
H089$Height09 = as.character(H089$Height09)
H089$Height09  = as.numeric(H089$Height09)
H089$Diff = H089$Height09 - H089$Height08
H0A = lm(H089$Anth ~ H089$Diff)
anova(H0A)
H08A = lm(H089$Anth ~ H089$Height08)
anova(H08A)
H09A = lm(H089$Anth ~ H089$Height09)
anova(H09A)
H0C = lm(H089$Chl ~ H089$Diff)
anova(H0C)
H08C = lm(H089$Chl ~ H089$Height08)
anova(H08C)
H09C = lm(H089$Chl ~ H089$Height09)
anova(H09C)
H0F = lm(H089$Flav ~ H089$Diff)
anova(H0F)
H08F = lm(H089$Flav ~ H089$Height08)
anova(H08F)
H09F = lm(H089$Flav ~ H089$Height09)
anova(H09F)
H0N = lm(H089$NBI ~ H089$Diff)
anova(H0N)
H08N = lm(H089$NBI ~ H089$Height08)
anova(H08N)
H09N = lm(H089$NBI ~ H089$Height09)
anova(H09N)
DatTree = group_by(Dat, Tree.ID, Column, Row)
DatTree = summarise(DatTree, Anth = mean(Anth4), Flav = mean(Flav5), Chl = mean(Chl3),NBI = mean(NBI4))
DatTree$Tree.ID = as.factor(DatTree$Tree.ID)
H089 = read.xlsx("H0892.xlsx", sheetName = "H089")
H089 = merge(H089,DatTree, by.x = "Tree.ID", all = TRUE)
write.xlsx(H089, "H0893.xlsx", sheetName = "089")
setwd("~/leafy-green")
Diff = read.xlsx("H08932.xlsx", sheetName = "Diff")
heatmaply(Diff,Colv = FALSE, Rowv = FALSE, xlab = "Column",ylab = "Row", main = "Height difference 2018/19")
