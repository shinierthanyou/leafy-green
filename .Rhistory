library("xlsx")
library("xlsx")
library("xlsx")
library("xlsx")
knitr::opts_chunk$set(echo = TRUE,cache = TRUE)
library(xlsx)
library(ggplot2)
library(gplots)
library(gridExtra)
library(corrplot)
library(dplyr)
library(png)
library(grid)
library(heatmaply)
# Import Data Measures
Data <-read.xlsx("Full.xlsx", sheetName ="Full")
head(Data)
# Import Replicate Data
Dup <-read.xlsx("Full.xlsx", sheetName ="Dup")
head(Dup)
#Isolate Crimson Glory Outgroup
CG = Data[c(1:11),]
head(CG)
#Isolate East Cape 201 Parent
EC201 = Data[c(12:21),]
head(EC201)
#Isolate East Cape 103 Parent
EC103 = Data[c(22:33),]
head(EC103)
#Isolate Offspring from the Parental Cross
F1 = Data[c(34:1825),]
head(F1)
Mrg <-group_by(F1,Tree.ID,Row,Column)
Mrg <-summarise(Mrg,count = n(),Chl = mean(Chl,na.rm =T), NBI = mean(NBI, na.rm=T), Anth = mean(Anth, ra.rm = T), Flav = mean(Flav, na.rm = T))
View(Mrg)
Hdat <- read.xlsx("HeightData.xlsx", sheetName = "Phenotypes April 2018")
TH = (Hdat[c(1,4)])
TH$ID = TH$NA.
Mrg$ID = Mrg$Tree.ID
View(TH)
TH  = TH[-c(1)]
View(TH)
View(Mrg)
Mrg = Mrg[-c(1)]
View(Mrg)
EZ <- merge(TH,Mrg, by.x = "ID")
View(EZ)
EZ <- merge(TH,Mrg, by.x = "ID", by.y = "ID")
View(EZ)
EZ <- merge(TH,Mrg, by = "ID")
View(EZ)
EZ <- merge(TH,Mrg, by = "ID", sort = TRUE)
View(EZ)
Hdat <- read.xlsx("HeightData.xlsx", sheetName = "Phenotypes April 2018")
summary(Hdat$Height)
TH = (Hdat[c(1,4)])
Mrg <-group_by(F1,Tree.ID,Row,Column)
Mrg$Row = as.numeric(Mrg$Row)
summary(Mrg$Row)
Mrg <-summarise(Mrg,count = n(),Chl = mean(Chl,na.rm =T), NBI = mean(NBI, na.rm=T), Anth = mean(Anth, ra.rm = T), Flav = mean(Flav, na.rm = T))
View(Mrg)
TH$ID = TH$NA.
Mrg$ID = Mrg$Tree.ID
TH  = TH[-c(1)]
Mrg = Mrg[-c(1)]
View(Mrg)
EZ <- merge(TH,Mrg, by = "ID", sort = TRUE)
View(EZ)
EZ <- merge(TH,Mrg,sort = TRUE)
View(EZ)
EZ <- merge(TH,Mrg, all = FALSE)
View(EZ)
knitr::opts_chunk$set(echo = TRUE,cache = FALSE)
library(xlsx)
library(ggplot2)
library(gplots)
library(gridExtra)
library(corrplot)
library(dplyr)
library(png)
library(grid)
library(heatmaply)
# Import Data Measures
Data <-read.xlsx("Full.xlsx", sheetName ="Full")
head(Data)
# Import Replicate Data
Dup <-read.xlsx("Full.xlsx", sheetName ="Dup")
head(Dup)
#Isolate Crimson Glory Outgroup
CG = Data[c(1:11),]
head(CG)
#Isolate East Cape 201 Parent
EC201 = Data[c(12:21),]
head(EC201)
#Isolate East Cape 103 Parent
EC103 = Data[c(22:33),]
head(EC103)
#Isolate Offspring from the Parental Cross
F1 = Data[c(34:1825),]
head(F1)
View(F1)
#Select Column for Row, Column, Tree.ID, Flav, NBI
Bas = F1[c(4,5,8,13,14,15,16)]
#Select Column for Row, Column, Tree.ID, Flav, NBI
Bas = F1[c(4,5,8,13,14,15,16)]
View(zF)
Bas = group_by(Bas,Column,Row,Tree.ID)
Bas = summarise(Bas, Flav = mean(Flav, na.rm = T), NBI = mean(NBI, na.rm = T))
#Write to excel
write.xlsx(as.data.frame(Bas), file = "comp.xlsx", sheetName = "Column", col.names = T)
#Select Column for Row, Column, Tree.ID, Flav, NBI
Bas = F1[c(4,5,8,13,14,15,16)]
Bas = group_by(Bas,Column,Row,Tree.ID)
Bas = summarise(Bas, Flav = mean(Flav, na.rm = T), NBI = mean(NBI, na.rm = T), Anth = mean(Anth, na.rm = T), Chl = mean(Chl, na.rm = T))
#Write to excel
write.xlsx(as.data.frame(Bas), file = "comp.xlsx", sheetName = "Column", col.names = T)
#Write to excel
#write.xlsx(as.data.frame(xF), file = "xF.xlsx", sheetName = "Height", col.names = T)
#Import altered data
HDat <-read.xlsx("xF2.xlsx", sheetName ="Sheet2")
#Select Column for Row, Column, Tree.ID, Flav, NBI
Bas = group_by(Bas,Column,Row,Tree.ID)
Bas = summarise(HDat, Flav = mean(Flav, na.rm = T), NBI = mean(NBI, na.rm = T), Anth = mean(Anth, na.rm = T), Chl = mean(Chl, na.rm = T))
#Write to excel
write.xlsx(as.data.frame(Bas), file = "comp.xlsx", sheetName = "Column", col.names = T)
#Select Column for Row, Column, Tree.ID, Flav, NBI
Bas = group_by(HDat,Column,Row,Tree.ID)
Bas = summarise(Bas, Flav = mean(Flav, na.rm = T), NBI = mean(NBI, na.rm = T), Anth = mean(Anth, na.rm = T), Chl = mean(Chl, na.rm = T))
#Write to excel
write.xlsx(as.data.frame(Bas), file = "comp.xlsx", sheetName = "Column", col.names = T)
= "Sheet1")
Fin = read.xlsx("zF2.xlsx", sheetName = "Sheet1")
LMC = lm(Fin$Chl ~ Fin$Column*Fin$Row
anova(LMC)
LMC = lm(Fin$Chl ~ Fin$Column*Fin$Row)
anova(LMC)
LMA = lm(Fin$Anth ~ Fin$Column*Fin$Row)
anova(LMA)
LMF = lm(Fin$Flav ~ Fin$Column*Fin$Row)
LMF = lm(Fin$Flav ~ Fin$Column*Fin$Row)
anova(LMF)
LMN = lm(Fin$NBI ~ Fin$Column*Fin$Row)
anova(LMN)
AnthDoc <-read.xlsx("Anth.xlsx", sheetName = "Anth")
heatmaply(AnthDoc, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE)
ChlDoc<-read.xlsx("Chl.xlsx", sheetName = "Chl")
heatmaply(ChlDoc, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE)
NBIDoc<-read.xlsx("NBI.xlsx", sheetName = "NBI")
heatmaply(NBIDoc, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE)
FlavDoc<-read.xlsx("Flav.xlsx", sheetName = "Flav")
heatmaply(FlavDoc, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE)
#Select Column,Row,Height,Tree.ID,Flav,Anth
xF = F1[c(4,5,8,11,14,15)]
xF = group_by(xF, Height, Row, Column,Tree.ID)
xF = summarise(xF, Anth = mean(Anth, na.rm=T),Flav = mean(Flav,na.rm =T))
#Write to excel
#write.xlsx(as.data.frame(xF), file = "xF.xlsx", sheetName = "Height", col.names = T)
#Import altered data
HDat <-read.xlsx("xF2.xlsx", sheetName ="Sheet2")
#New Anthocyanin Anova
AHA = lm(HDat$Anth ~ HDat$Height)
anova(AHA)
#New Flavonol Anova
FHA = lm(HDat$Flav ~ HDat$Height)
anova(FHA)
#Write height data to excel
#Select Column for Row, Column, Tree.ID, Flav, NBI
#Bas = group_by(HDat,Column,Row,Tree.ID)
#Bas = summarise(Bas, Flav = mean(Flav, na.rm = T), NBI = mean(NBI, na.rm = T), Anth = mean(Anth, na.rm = T), Chl = mean(Chl, na.rm = T))
#Write to excel
#write.xlsx(as.data.frame(Bas), file = "comp.xlsx", sheetName = "Column", col.names = T)
setwd("~/GitHub/leafy-green")
knitr::opts_chunk$set(echo = TRUE,cache = FALSE)
library(xlsx)
library(ggplot2)
library(gplots)
library(gridExtra)
library(corrplot)
library(dplyr)
library(png)
library(grid)
library(heatmaply)
# Import Data Measures
Data <-read.xlsx("Full.xlsx", sheetName ="Full")
head(Data)
# Import Replicate Data
Dup <-read.xlsx("Full.xlsx", sheetName ="Dup")
head(Dup)
#Isolate Crimson Glory Outgroup
CG = Data[c(1:11),]
head(CG)
#Isolate East Cape 201 Parent
EC201 = Data[c(12:21),]
head(EC201)
#Isolate East Cape 103 Parent
EC103 = Data[c(22:33),]
head(EC103)
#Isolate Offspring from the Parental Cross
F1 = Data[c(34:1825),]
head(F1)
knitr::opts_chunk$set(echo = TRUE,cache = TRUE)
library(xlsx)
library(ggplot2)
library(gplots)
library(gridExtra)
library(corrplot)
library(dplyr)
library(png)
library(grid)
library(heatmaply)
library(corrplot)
Dat = F1
#Total Mean
Dat$ATmean = mean(Dat$Anth)
Dat$CTmean = mean(Dat$Chl)
Dat$FTmean = mean(Dat$Flav)
Dat$NTmean = mean(Dat$NBI)
#Remove Total Mean
Dat$Anth2 = Dat$Anth - Dat$ATmean
Dat$Chl2 = Dat$Chl - Dat$CTmean
Dat$Flav2 = Dat$Flav - Dat$FTmean
Dat$NBI2 = Dat$NBI - Dat$NTmean
#Height Mean
DatH = group_by(Dat, Height,Column,Row)
DatH = summarise(DatH, HAnth = mean(Anth, na.rm = T), HChl = mean(Chl, na.rm = T), HFlav = mean(Flav,na.rm = T), HNBI = mean(NBI, na.rm = T))
merge(df1, df2, by = "Height", all = TRUE)
merge(Dat, DatH, by = "Height", all = TRUE)
View(Dat)
View(DatH)
#Height Mean
DatH = group_by(Dat, Height,Column,Row)
#Height Mean
DatH = group_by(Dat, Height)
