setwd("~/leafy-green")
knitr::opts_chunk$set(echo = FALSE,cache = TRUE)
library(xlsx)
library(ggplot2)
library(gplots)
library(gridExtra)
library(corrplot)
library(dplyr)
library(png)
library(grid)
library(heatmaply)
#Import and Arrange Data
Data <- read.xlsx(file = "Entire.xlsx", sheetName = "Sheet1")
F1 = Data[c(34:1846),]
F1 = F1[-c(13)]
#Assign Description
F1$Height09 = as.character(F1$Height09)
F1$Height09 = as.numeric(F1$Height09)
F1$Column = as.factor(F1$Column)
F1$Flower.Level = as.factor(F1$Flower.Level)
#Removing Anthocyanin Outliers
OBA <-boxplot(F1$Anth,range = 3.5, plot = F)$out
OA = F1[which(F1$Anth %in% OBA),];OA
F1 <- F1[-which(F1$Anth %in% OBA),]
#Overall Means
F1$MAnth = mean(F1$Anth, na.rm = T)
F1$MChl = mean(F1$Chl, na.rm = T)
F1$MFlav = mean(F1$Flav, na.rm = T)
F1$M18 = mean(F1$Height08, na.rm = T)
F1$M19 = mean(F1$Height09, na.rm = T)
#Remove Overall Mean
F1$Anth2 = F1$Anth - F1$MAnth
F1$Chl2 = F1$Chl - F1$MChl
F1$Flav2 = F1$Flav - F1$MFlav
F1$H182 = F1$Height08 - F1$M18
F1$H192 = F1$Height09 - F1$M19
#Leaf Height Chemical Mean
LM = group_by(F1, Height)
LM = summarise(LM, LMAnth = mean(Anth, na.rm = T), LMChl = mean(Chl, na.rm =T), LMFlav = mean(Flav,na.rm = T))
F1 = merge(F1, LM, by.x = "Height", all = TRUE)
#Overall Mean - Leaf Height Mean
F1$LMAnth2 = F1$MAnth - F1$LMAnth
F1$LMChl2 = F1$MChl - F1$LMChl
F1$LMFlav2 = F1$MFlav - F1$LMFlav
#Update Measures
F1$Anth3 = F1$Anth2 + F1$LMAnth2
F1$Chl3 = F1$Chl2 + F1$LMChl2
F1$Flav3 = F1$Flav2 + F1$LMFlav2
#Row Mean
RM = group_by(F1, Row)
RM = summarise(RM, RAnth = mean(Anth, na.rm = T), RChl = mean(Chl, na.rm =T), RFlav = mean(Flav,na.rm = T), R18 = mean(Height08, na.rm = T), R19 = mean(Height09, na.rm =T ))
F1 = merge(F1, RM, by.x = "Row", all = TRUE)
#Overall Mean - Row Mean
F1$RAnth2 = F1$MAnth - F1$RAnth
F1$RChl2 = F1$MChl - F1$RChl
F1$RFlav2 = F1$MFlav - F1$RFlav
F1$R182 = F1$M18 - F1$R18
F1$R192 = F1$M19 - F1$R19
#Update Measures
F1$Anth4 = F1$Anth2 + F1$RAnth2
F1$Chl4 = F1$Chl2 + F1$RChl2
F1$Flav4 = F1$Flav2 + F1$RFlav2
F1$H184 = F1$H182 + F1$R182
F1$H194 = F1$H192 + F1$R192
#Column Mean
CM = group_by(F1, Column)
CM = summarise(CM, CAnth = mean(Anth, na.rm = T), CChl = mean(Chl, na.rm =T), CFlav = mean(Flav,na.rm = T), C18 = mean(Height08, na.rm = T), C19 = mean(Height09, na.rm =T))
F1 = merge(F1, CM, by.x = "Column", all = TRUE)
#Overall Mean - Column Mean
F1$CAnth2 = F1$MAnth - F1$CAnth
F1$CChl2 = F1$MChl - F1$CChl
F1$CFlav2 = F1$MFlav - F1$CFlav
F1$C182 = F1$M18 - F1$C18
F1$C192 = F1$M19 - F1$C19
#Update Measures
F1$Anth5 = F1$Anth4 + F1$CAnth2
F1$Chl5 = F1$Chl4 + F1$CChl2
F1$Flav5 = F1$Flav4 + F1$CFlav2
F1$H185 = F1$H184 + F1$C182
F1$H195 = F1$H194 + F1$C192
#Height Differences Between 2018 and 2019
F1$HDiff = F1$H195 - F1$H185
Tree = group_by(F1,Tree.ID)
Tree = summarise(Tree, AnthT = mean(Anth5, na.rm = T), ChlT = mean(Chl5, na.rm =T), FlavT = mean(Flav5,na.rm = T), H18T = mean(H185, na.rm = T), H19T = mean(H195, na.rm =T), HDT = mean(HDiff, na.rm =T))
modA1 = lm(F1$Anth5 ~ F1$Tree.ID)
anova(modA1)
modA12 <-augment(modA1)
ggplot(lm(Anth5~Tree.ID, data=F1)) + geom_point(aes(x=.fitted, y=.resid))
ggplot(lm(Anth5~Tree.ID, data=F1)) + geom_point(aes(x=.fitted, y=.resid)+geom_hline(yintercept = c(-0.2,0,0.2))
ggplot(lm(Anth5~Tree.ID, data=F1)) + geom_point(aes(x=.fitted, y=.resid)+geom_hline(yintercept = c(-0.2,0,0.2)
ggplot(lm(Anth5~Tree.ID, data=F1)) + geom_point(aes(x=.fitted, y=.resid) +geom_hline(yintercept = c(-0.2,0,0.2)))
ggplot(lm(Anth5~Tree.ID, data=F1)) + geom_point(aes(x=.fitted, y=.resid) +geom_hline(yintercept = 0)
ggplot(lm(Anth5~Tree.ID, data=F1)) + geom_point(aes(x=.fitted, y=.resid) +geom_hline(yintercept = 0))
ggplot(lm(Anth5~Tree.ID, data=F1)) + geom_point(aes(x=.fitted, y=.resid)) +geom_hline(yintercept = 0)
ggplot(lm(Anth5~Tree.ID, data=F1)) + geom_point(aes(x=.fitted, y=.resid)) +geom_hline (yintercept = c(-0.2,0,0.2)
ggplot(lm(Anth5~Tree.ID, data=F1)) + geom_point(aes(x=.fitted, y=.resid)) +geom_hline (yintercept = c(-0.2,0,0.2))
ggplot(lm(Anth5~Tree.ID, data=F1)) + geom_point(aes(x=.fitted, y=.resid)) +geom_hline(yintercept = c(-0.2,0,0.2))
ggplot(lm(Anth5~Tree.ID, data=F1)) + geom_point(aes(x=.fitted, y=.resid)) +geom_hline(yintercept = c(-0.1,0,0.1))
ggplot(lm(Anth5~Tree.ID, data=F1)) + geom_point(aes(x=.fitted, y=.resid)) +geom_hline(yintercept = c(-0.1,0,0.1), colour = "") + theme_bw()
ggplot(lm(Anth5~Tree.ID, data=F1)) + geom_point(aes(x=.fitted, y=.resid)) +geom_hline(yintercept = c(-0.1,0,0.1), colour = "dodgerblue1") + theme_bw()
ggplot(lm(Anth5~Tree.ID, data=F1)) + geom_point(aes(x=.fitted, y=.resid), colour = "turquoise3") +geom_hline(yintercept = c(-0.1,0,0.1), colour = "dodgerblue1") + theme_bw()
ggplot(lm(Anth5~Tree.ID, data=F1)) + geom_point(aes(x=.fitted, y=.resid), colour = "turquoise3", shape = 1) +geom_hline(yintercept = c(-0.1,0,0.1), colour = "dodgerblue1") + theme_bw()
ggplot(lm(Anth5~Tree.ID, data=F1)) + geom_point(aes(x=.fitted, y=.resid), colour = "turquoise1", shape = 1) +geom_hline(yintercept = c(-0.1,0,0.1), colour = "dodgerblue1") + theme_bw()
ggplot(lm(Anth5~Tree.ID, data=F1)) + geom_point(aes(x=.fitted, y=.resid), colour = "dodgerblue1", shape = 1) +geom_hline(yintercept = c(-0.1,0,0.1), colour = "red") + theme_bw()
AP34 = ggplot(lm(Anth5~Tree.ID, data=F1)) + geom_point(aes(x=.fitted, y=.resid), colour = "dodgerblue1", shape = 1) +geom_hline(yintercept = c(-0.1,0,0.1), colour = "red") + theme_bw(), ggtitle("Residual Plot Anth ~ Tree"); AP43
AP34 = ggplot(lm(Anth5~Tree.ID, data=F1)) + geom_point(aes(x=.fitted, y=.resid), colour = "dodgerblue1", shape = 1) +geom_hline(yintercept = c(-0.1,0,0.1), colour = "red") + theme_bw() +ggtitle("Residual Plot Anth ~ Tree"); AP43
AP34 = ggplot(lm(Anth5~Tree.ID, data=F1)) + geom_point(aes(x=.fitted, y=.resid), colour = "dodgerblue1", shape = 1) +geom_hline(yintercept = c(-0.1,0,0.1), colour = "red") + theme_bw() +ggtitle("Residual Plot Anth ~ Tree"); AP34
AP34 = ggplot(lm(Anth5~Tree.ID, data=F1)) + geom_point(aes(x=.fitted, y=.resid), colour = "dodgerblue1", shape = 1) +geom_hline(yintercept = c(-0.1,0,0.1), colour = "red") + theme_bw() +ggtitle("Residual Plot Anth ~ Tree")+theme(plot.title = element_text(hjust = 0.5)); AP34
grid.arrange(AP3,AP32,AP33,AP34)
AnthDoc <-read.xlsx("ABC2.xlsx", sheetName = "Anth")
heatmaply(AnthDoc, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "Anthocyanin Map")
AP3 = ggplot(F1) + aes(x = Tree.ID, y = Anth5) + geom_boxplot(fill = "dodgerblue1") + ylab("Anth") + xlab("Tree.ID") + ggtitle("Anthocyanin Measures Tree Distributions") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = 0, colour = "red");AP3
AP32 <-ggplot(Tree) +aes(x = Tree.ID, y = AnthT) + geom_point() +geom_hline(yintercept = mean(F1$Anth5, na.rm = T), colour = "dodgerblue1")+ ylab("Anthocyanin") + xlab("Tree.ID") + ggtitle("Anthocyanin Tree Means")+theme_bw()+theme(plot.title = element_text(hjust = 0.5));AP32
AP33 <-ggplot(Tree) +aes(AnthT) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Anthocyanin") + ggtitle("Anthocyanin Distribution of F1 Trees After Correction") +theme_bw() +theme(plot.title = element_text(hjust = 0.5));AP33
AP34 = ggplot(lm(Anth5~Tree.ID, data=F1)) + geom_point(aes(x=.fitted, y=.resid), colour = "dodgerblue1", shape = 1) +geom_hline(yintercept = c(-0.1,0,0.1), colour = "red") + theme_bw() +ggtitle("Residual Plot Anth ~ Tree")+theme(plot.title = element_text(hjust = 0.5)); AP34
grid.arrange(AP3,AP32,AP33,AP34)
grid.arrange(AP3,AP32,AP33,AP34)
AnthDoc <-read.xlsx("ABC2.xlsx", sheetName = "Anth")
heatmaply(AnthDoc, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "Anthocyanin Map")
AP3 = ggplot(F1) + aes(x = Tree.ID, y = Anth5) + geom_boxplot(fill = "dodgerblue1") + ylab("Anth") + xlab("Tree.ID") + ggtitle("Anthocyanin Measures Tree Distributions") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = 0, colour = "red");AP3
AP32 <-ggplot(Tree) +aes(x = Tree.ID, y = AnthT) + geom_point() +geom_hline(yintercept = mean(F1$Anth5, na.rm = T), colour = "dodgerblue1")+ ylab("Anthocyanin") + xlab("Tree.ID") + ggtitle("Anthocyanin Tree Means")+theme_bw()+theme(plot.title = element_text(hjust = 0.5));AP32
AP33 <-ggplot(Tree) +aes(AnthT) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Anthocyanin") + ggtitle("Anthocyanin Distribution of F1 Trees") +theme_bw() +theme(plot.title = element_text(hjust = 0.5));AP33
AP34 = ggplot(lm(Anth5~Tree.ID, data=F1)) + geom_point(aes(x=.fitted, y=.resid), colour = "dodgerblue1", shape = 1) +geom_hline(yintercept = c(-0.1,0,0.1), colour = "red") + theme_bw() +ggtitle("Residual Plot Anth ~ Tree")+theme(plot.title = element_text(hjust = 0.5)); AP34
grid.arrange(AP3,AP32,AP33,AP34)
grid.arrange(AP3,AP32,AP33,AP34)
grid.arrange(AP3,AP32,ncol(1)
grid.arrange(AP3,AP32,ncol=1)
grid.arrange(AP3,AP32,ncol=1)
CorA1 = ggplot(F1) +aes(x = Anth5, y = Chl5) + geom_point(colour = "turquoise3") + ylab("Chlorophyll") + xlab("Anthocyanin") + ggtitle("Anthocyanin and Chlorophyll")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
CorA2 = ggplot(F1) +aes(x = Anth5, y = Flav5) + geom_point(colour = "turquoise3") + ylab("Flavonol") + xlab("Anthocyanin") + ggtitle("Anthocyanin and Flavonol")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
CorA3 = ggplot(F1) +aes(x = Anth5, y = H185) + geom_point(colour = "turquoise3") + ylab("Height") + xlab("Anthocyanin") + ggtitle("Anthocyanin and Height 2018")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
CorA4 = ggplot(F1) +aes(x = Anth5, y = H195) + geom_point(colour = "turquoise3") + ylab("Height") + xlab("Anthocyanin") + ggtitle("Anthocyanin and Height 2019")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
CorA5 = ggplot(F1) +aes(x = Anth5, y = HDiff) + geom_point(colour = "turquoise3") + ylab("Height") + xlab("Anthocyanin") + ggtitle("Anthocyanin and Height Difference 2018-19")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
CorC1 = ggplot(F1) +aes(x = Chl5, y = Flav5) + geom_point(colour = "turquoise3") + ylab("Flavonol") + xlab("Chlorophyll") + ggtitle("Chlorophyll and Flavonol")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
CorC2 = ggplot(F1) +aes(x = Chl5, y = H185) + geom_point(colour = "turquoise3") + ylab("Height") + xlab("Chlorophyll") + ggtitle("Chlorophyll and Height 2018")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
CorC3 = ggplot(F1) +aes(x = Chl5, y = H195) + geom_point(colour = "turquoise3") + ylab("Height") + xlab("Chlorophyll") + ggtitle("Chlorophyll and Height 2019")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
CorC4 = ggplot(F1) +aes(x = Chl5, y = HDiff) + geom_point(colour = "turquoise3") + ylab("Height") + xlab("Chlorophyll") + ggtitle("Chlorophyll and Height Difference 2018-19")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
CorF1 = ggplot(F1) +aes(x = Flav5, y = H185) + geom_point(colour = "turquoise3") + ylab("Height") + xlab("Flavonol") + ggtitle("Flavonol and Height 2018")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
CorF2 = ggplot(F1) +aes(x = Flav5, y = H195) + geom_point(colour = "turquoise3") + ylab("Height") + xlab("Flavonol") + ggtitle("Flavonol and Height 2019")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
CorF3 = ggplot(F1) +aes(x = Flav5, y = HDiff) + geom_point(colour = "turquoise3") + ylab("Height") + xlab("Flavonol") + ggtitle("Flavonol and Height Difference 2018-19")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
Cor181 = ggplot(F1) +aes(x = H185, y = H195) + geom_point(colour = "turquoise3") + ylab("Height 2019") + xlab("Height 2018") + ggtitle("Height 2018 Compared with 2019")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
Cor182 = ggplot(F1) +aes(x = H185, y = HDiff) + geom_point(colour = "turquoise3") + ylab("Height Difference") + xlab("Height 2018") + ggtitle("2018 Height and Height Difference 2018-19")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
Cor192 = ggplot(F1) +aes(x = H195, y = HDiff) + geom_point(colour = "turquoise3") + ylab("Height Difference") + xlab("Height 2019") + ggtitle("2019 Height and Height Difference 2018-19")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
grid.arrange(CorA1, CorA2, CorA3, CorA4, CorA5, CorC1, CorC2, CorC3, CorC4, CorF1, CorF1, CorF1, Cor181, Cor182, Cor192, ncol = 2)
CorA1 = ggplot(F1) +aes(x = Anth5, y = Chl5) + geom_point(colour = "turquoise3") + ylab("Chlorophyll") + xlab("Anthocyanin") + ggtitle("Anthocyanin and Chlorophyll")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
CorA2 = ggplot(F1) +aes(x = Anth5, y = Flav5) + geom_point(colour = "turquoise3") + ylab("Flavonol") + xlab("Anthocyanin") + ggtitle("Anthocyanin and Flavonol")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
CorA3 = ggplot(F1) +aes(x = Anth5, y = H185) + geom_point(colour = "turquoise3") + ylab("Height") + xlab("Anthocyanin") + ggtitle("Anthocyanin and Height 2018")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
CorA4 = ggplot(F1) +aes(x = Anth5, y = H195) + geom_point(colour = "turquoise3") + ylab("Height") + xlab("Anthocyanin") + ggtitle("Anthocyanin and Height 2019")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
CorA5 = ggplot(F1) +aes(x = Anth5, y = HDiff) + geom_point(colour = "turquoise3") + ylab("Height") + xlab("Anthocyanin") + ggtitle("Anthocyanin and Height Difference 2018-19")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
CorC1 = ggplot(F1) +aes(x = Chl5, y = Flav5) + geom_point(colour = "turquoise3") + ylab("Flavonol") + xlab("Chlorophyll") + ggtitle("Chlorophyll and Flavonol")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
CorC2 = ggplot(F1) +aes(x = Chl5, y = H185) + geom_point(colour = "turquoise3") + ylab("Height") + xlab("Chlorophyll") + ggtitle("Chlorophyll and Height 2018")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
CorC3 = ggplot(F1) +aes(x = Chl5, y = H195) + geom_point(colour = "turquoise3") + ylab("Height") + xlab("Chlorophyll") + ggtitle("Chlorophyll and Height 2019")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
CorC4 = ggplot(F1) +aes(x = Chl5, y = HDiff) + geom_point(colour = "turquoise3") + ylab("Height") + xlab("Chlorophyll") + ggtitle("Chlorophyll and Height Difference 2018-19")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
CorF1 = ggplot(F1) +aes(x = Flav5, y = H185) + geom_point(colour = "turquoise3") + ylab("Height") + xlab("Flavonol") + ggtitle("Flavonol and Height 2018")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
CorF2 = ggplot(F1) +aes(x = Flav5, y = H195) + geom_point(colour = "turquoise3") + ylab("Height") + xlab("Flavonol") + ggtitle("Flavonol and Height 2019")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
CorF3 = ggplot(F1) +aes(x = Flav5, y = HDiff) + geom_point(colour = "turquoise3") + ylab("Height") + xlab("Flavonol") + ggtitle("Flavonol and Height Difference 2018-19")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
Cor181 = ggplot(F1) +aes(x = H185, y = H195) + geom_point(colour = "turquoise3") + ylab("Height 2019") + xlab("Height 2018") + ggtitle("Height 2018 Compared with 2019")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
Cor182 = ggplot(F1) +aes(x = H185, y = HDiff) + geom_point(colour = "turquoise3") + ylab("Height Difference") + xlab("Height 2018") + ggtitle("2018 Height and Height Difference 2018-19")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
Cor192 = ggplot(F1) +aes(x = H195, y = HDiff) + geom_point(colour = "turquoise3") + ylab("Height Difference") + xlab("Height 2019") + ggtitle("2019 Height and Height Difference 2018-19")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
grid.arrange(CorA1, CorA2, CorA3, CorA4, CorA5, CorC1, CorC2, CorC3, CorC4, CorF1, CorF1, CorF1, Cor181, Cor182, Cor192, ncol = 2)
grid.arrange(CorA1, CorA2, CorA3, CorA4, CorA5, CorC1, CorC2, CorC3, CorC4, CorF1, CorF1, CorF1, Cor181, Cor182, Cor192, ncol = 2)
grid.arrange(CorA1, CorA2, CorA3, CorA4, CorA5, ncol = 2)
grid.arrange(CorA1, CorA2, CorA3, CorA4, CorA5, ncol = 2)
Cor182 = ggplot(F1) +aes(x = H185, y = HDiff) + geom_point(colour = "turquoise3", size = 1) + ylab("Height Difference") + xlab("Height 2018") + ggtitle("2018 Height and Height Difference 2018-19")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
Cor182 = ggplot(F1) +aes(x = H185, y = HDiff) + geom_point(colour = "turquoise3", shape = 1) + ylab("Height Difference") + xlab("Height 2018") + ggtitle("2018 Height and Height Difference 2018-19")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
Cor182 = ggplot(F1) +aes(x = H185, y = HDiff) + geom_point(colour = "turquoise3", shape = 1) + ylab("Height Difference") + xlab("Height 2018") + ggtitle("2018 Height and Height Difference 2018-19")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth();Cor182
grid.arrange(CorA1, CorA2, CorA3, CorA4,ncol = 2)
CorA1 = ggplot(F1) +aes(x = Anth5, y = Chl5) + geom_point(colour = "turquoise3", shape = 1) + ylab("Chlorophyll") + xlab("Anthocyanin") + ggtitle("Anthocyanin and Chlorophyll")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
CorA2 = ggplot(F1) +aes(x = Anth5, y = Flav5) + geom_point(colour = "turquoise3", shape = 1) + ylab("Flavonol") + xlab("Anthocyanin") + ggtitle("Anthocyanin and Flavonol")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
CorA3 = ggplot(F1) +aes(x = Anth5, y = H185) + geom_point(colour = "turquoise3", shape = 1) + ylab("Height") + xlab("Anthocyanin") + ggtitle("Anthocyanin and Height 2018")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
CorA4 = ggplot(F1) +aes(x = Anth5, y = H195) + geom_point(colour = "turquoise3", shape = 1) + ylab("Height") + xlab("Anthocyanin") + ggtitle("Anthocyanin and Height 2019")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
CorA5 = ggplot(F1) +aes(x = Anth5, y = HDiff) + geom_point(colour = "turquoise3", shape = 1) + ylab("Height") + xlab("Anthocyanin") + ggtitle("Anthocyanin and Height Difference 2018-19")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
CorC1 = ggplot(F1) +aes(x = Chl5, y = Flav5) + geom_point(colour = "turquoise3", shape = 1) + ylab("Flavonol") + xlab("Chlorophyll") + ggtitle("Chlorophyll and Flavonol")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
CorC2 = ggplot(F1) +aes(x = Chl5, y = H185) + geom_point(colour = "turquoise3", shape = 1) + ylab("Height") + xlab("Chlorophyll") + ggtitle("Chlorophyll and Height 2018")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
CorC3 = ggplot(F1) +aes(x = Chl5, y = H195) + geom_point(colour = "turquoise3", shape = 1) + ylab("Height") + xlab("Chlorophyll") + ggtitle("Chlorophyll and Height 2019")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
CorC4 = ggplot(F1) +aes(x = Chl5, y = HDiff) + geom_point(colour = "turquoise3", shape = 1) + ylab("Height") + xlab("Chlorophyll") + ggtitle("Chlorophyll and Height Difference 2018-19")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
CorF1 = ggplot(F1) +aes(x = Flav5, y = H185) + geom_point(colour = "turquoise3", shape = 1) + ylab("Height") + xlab("Flavonol") + ggtitle("Flavonol and Height 2018")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
CorF2 = ggplot(F1) +aes(x = Flav5, y = H195) + geom_point(colour = "turquoise3", shape = 1) + ylab("Height") + xlab("Flavonol") + ggtitle("Flavonol and Height 2019")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
CorF3 = ggplot(F1) +aes(x = Flav5, y = HDiff) + geom_point(colour = "turquoise3", shape = 1) + ylab("Height") + xlab("Flavonol") + ggtitle("Flavonol and Height Difference 2018-19")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
Cor181 = ggplot(F1) +aes(x = H185, y = H195) + geom_point(colour = "turquoise3", shape = 1) + ylab("Height 2019") + xlab("Height 2018") + ggtitle("Height 2018 Compared with 2019")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
Cor182 = ggplot(F1) +aes(x = H185, y = HDiff) + geom_point(colour = "turquoise3", shape = 1) + ylab("Height Difference") + xlab("Height 2018") + ggtitle("2018 Height and Height Difference 2018-19")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth();Cor182
grid.arrange(CorA1, CorA2, CorA3, CorA4,ncol = 2)
grid.arrange(CorA5, CorC1, CorC2, CorC3,ncol = 2)
grid.arrange(CorC4, CorF1, CorF2, CorF3,ncol = 2)
grid.arrange(Cor181, Cor182, Cor192,ncol = 2)
mod198 = lm(F1$H195 ~ F1$HDiff)
anova(mod188)
mod198 = lm(F1$H195 ~ F1$HDiff)
anova(mod198)
plot(mod198)
F2 = split(F1,"Height")
View(F2)
F2$Height
HM <- subset(F1, "Height" = M)
HM
HM <- subset(F1, Height = M)
HM
HM <- F1$Height == "M"
HM
F1[HM]
F1[HM,]
HM = F1[HM,]
HM
#Subset Leaf Height
HM = F1$Height == "M"
HM = F1[HM,]
HH = F1$Height == "H"
HH = F1[HH,]
Hl = F1$Height == "L"
HL = F1[HL,]
#Subset Leaf Height
HM = F1$Height == "M"
HM = F1[HM,]
HH = F1$Height == "H"
HH = F1[HH,]
HL = F1$Height == "L"
HL = F1[HL,]
AP4 = ggplot(data = subset(F1, !is.na(Height))) + aes(x =Height, y = Anth5) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Flav") + xlab("Height") + ggtitle("Anthocyanin by Collection Height") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = 0, colour = "red")+stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3);AP4
AP42 = ggplot() +aes(x = HM$Anth5, y = HH$Anth5) + geom_point() +geom_hline(yintercept = mean(HM$Anth5+HH$Anth5, na.rm = T), colour = "dodgerblue1")+ ylab("Anthocyanin") + xlab("Row") + ggtitle("Anthocyanin Row Means")+theme_bw()+theme(plot.title = element_text(hjust = 0.5));AP42
AP42 = ggplot() +aes(x = HM$Anth5, y = HH$Anth5) + geom_point(), colour = "dodgerblue1")+ ylab("Anthocyanin") + xlab("Row") + ggtitle("Anthocyanin Row Means")+theme_bw()+theme(plot.title = element_text(hjust = 0.5));AP42
AP42 = ggplot() +aes(x = HM$Anth5, y = HH$Anth5) +geom_point(colour = "dodgerblue1")+ ylab("Anthocyanin") + xlab("Row") + ggtitle("Anthocyanin Row Means")+theme_bw()+theme(plot.title = element_text(hjust = 0.5));AP42
modA22 = lm(HH$Anth5 ~HL$Anth5)
HWT = summarise(HWT, Anth = mean(Anth5, na.rm = T), Chl = mean(Chl5, na.rm = T), Flav = mean(Flav5, na.rm = T), H18 = mean(H185, na.rm = T), H19 = mean(H195, na.rm = T), HDiff = mean(HDiff, na.rm = T))
#Subset Leaf Height
HWT = group_by(F1, Height, Tree.ID)
HWT = summarise(HWT, Anth = mean(Anth5, na.rm = T), Chl = mean(Chl5, na.rm = T), Flav = mean(Flav5, na.rm = T), H18 = mean(H185, na.rm = T), H19 = mean(H195, na.rm = T), HDiff = mean(HDiff, na.rm = T))
#Subset Leaf Height
HWT = group_by(F1, Height, Tree.ID)
HWT = summarise(HWT, Anth = mean(Anth5, na.rm = T), Chl = mean(Chl5, na.rm = T), Flav = mean(Flav5, na.rm = T), H18 = mean(H185, na.rm = T), H19 = mean(H195, na.rm = T), HDiff = mean(HDiff, na.rm = T))
HM = HWT$Height == "M"
HM = HWT[HM,]
HH = HWT$Height == "H"
HH = HWT[HH,]
HL = HWT$Height == "L"
HL = HWT[HL,]
plot(HM$Anth ~ HL$Anth)
AP12 <-ggplot() +aes(x = HM$Anth, y = HH$Anth) + geom_point() +geom_hline(yintercept = lm(HM$Anth ~ HH$Anth)), colour = "dodgerblue1")+ ylab("Anthocyanin") + xlab("Row") + ggtitle("Anthocyanin Row Means")+theme_bw()+theme(plot.title = element_text(hjust = 0.5));AP12
AP12 <-ggplot() +aes(x = HM$Anth, y = HH$Anth) + geom_point() +geom_hline(yintercept = lm(HM$Anth ~ HH$Anth), colour = "dodgerblue1")+ ylab("Anthocyanin") + xlab("Row") + ggtitle("Anthocyanin Row Means")+theme_bw()+theme(plot.title = element_text(hjust = 0.5));AP12
AP12 <-ggplot() +aes(x = HM$Anth, y = HH$Anth) + geom_point()+ ylab("Anthocyanin") + xlab("Row") + ggtitle("Anthocyanin Row Means")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))abline(lm(HM$Anth ~ HH$Anth));AP12
AP12 <-ggplot() +aes(x = HM$Anth, y = HH$Anth) + geom_point()+ ylab("Anthocyanin") + xlab("Row") + ggtitle("Anthocyanin Row Means")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+abline(lm(HM$Anth ~ HH$Anth));AP12
AP12 <-ggplot(HWT)+aes(x = HM$Anth, y = HH$Anth) + geom_point()+ ylab("Anthocyanin") + xlab("Row") + ggtitle("Anthocyanin Row Means")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+abline(lm(HM$Anth ~ HH$Anth));AP12
AP12 <-ggplot(HWT)+aes(x = HM$Anth, y = HH$Anth) + geom_point()+ ylab("Anthocyanin") + xlab("Row") + ggtitle("Anthocyanin Row Means")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+abline(lm(HM$Anth ~ HH$Anth));AP12
AP12 <-ggplot(HWT)+aes(x = HM$Anth, y = HH$Anth) + geom_point()+ ylab("Anthocyanin") + xlab("Row") + ggtitle("Anthocyanin Row Means")+theme_bw()+theme(plot.title = element_text(hjust = 0.5)+geom_smooth();AP12
AP12 <-ggplot(HWT)+aes(x = HM$Anth, y = HH$Anth) + geom_point()+ ylab("Anthocyanin") + xlab("Row") + ggtitle("Anthocyanin Row Means") +theme_bw() +theme(plot.title = element_text(hjust = 0.5) +geom_smooth();AP12
AP12 <-ggplot(HWT)+aes(x = HM$Anth, y = HH$Anth) + geom_point()+ ylab("Anthocyanin") + xlab("Row") + ggtitle("Anthocyanin Row Means") +theme_bw() +theme(plot.title = element_text(hjust = 0.5) +geom_smooth()
AP12 = ggplot() +aes(x = HH$Anth, y = HM$Anth) + geom_point(colour = "turquoise3", shape = 1) + ylab("Height Difference") + xlab("Height 2018") + ggtitle("2018 Height and Height Difference 2018-19")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth();AP12
ggplot() +aes(x = HH$Anth, y = HM$Anth) + geom_point(colour = "turquoise3", shape = 1) + ylab("Height Difference") + xlab("Height 2018") + ggtitle("2018 Height and Height Difference 2018-19")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
ggplot() +aes(x = HH$Anth, y = HM$Anth) + geom_point(colour = "turquoise3", shape = 1) + ylab("Mid Height") + xlab("High Height") + ggtitle("2018 Height and Height Difference 2018-19")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
ggplot() +aes(x = HH$Anth, y = HM$Anth) + geom_point(colour = "turquoise3", shape = 1) + ylab("Mid") + xlab("High") + ggtitle("Anthocyanin of High and Mid Leaves")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
AP4 = ggplot(data = subset(F1, !is.na(Height))) + aes(x =Height, y = Anth5) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Flav") + xlab("Height") + ggtitle("Anthocyanin by Collection Height") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = 0, colour = "red")+stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3);AP4
ggplot() +aes(x = HH$Anth, y = HM$Anth) + geom_point(colour = "turquoise3", shape = 1) + ylab("Mid") + xlab("High") + ggtitle("Anthocyanin of High and Mid Leaves")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
ggplot() +aes(x = HL$Anth, y = HM$Anth) + geom_point(colour = "turquoise3", shape = 1) + ylab("Mid") + xlab("Low") + ggtitle("Anthocyanin of High and Mid Leaves")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
ggplot() +aes(x = HH$Anth, y = HL$Anth) + geom_point(colour = "turquoise3", shape = 1) + ylab("Low") + xlab("High") + ggtitle("Anthocyanin of High and Mid Leaves")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
?geom_smooth
ggplot() +aes(x = HH$Anth, y = HL$Anth) + geom_point(colour = "turquoise3", shape = 1) + ylab("Low") + xlab("High") + ggtitle("Anthocyanin of High and Mid Leaves")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth(method = "lm")
ggplot() +aes(x = HL$Anth, y = HM$Anth) + geom_point(colour = "turquoise3", shape = 1) + ylab("Mid") + xlab("Low") + ggtitle("Anthocyanin of High and Mid Leaves")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth(method = "lm")
ggplot() +aes(x = HH$Anth, y = HM$Anth) + geom_point(colour = "turquoise3", shape = 1) + ylab("Mid") + xlab("High") + ggtitle("Anthocyanin of High and Mid Leaves")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth(method = "lm")
AP4 = ggplot(data = subset(F1, !is.na(Height))) + aes(x =Height, y = Anth5) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Flav") + xlab("Height") + ggtitle("Anthocyanin by Collection Height") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = 0, colour = "red")+stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3);AP4
ggplot() +aes(x = HH$Anth, y = HM$Anth) + geom_point(colour = "turquoise3", shape = 1) + ylab("Mid") + xlab("High") + ggtitle("Anthocyanin of High and Mid Leaves")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth(method = "lm")
ggplot() +aes(x = HL$Anth, y = HM$Anth) + geom_point(colour = "turquoise3", shape = 1) + ylab("Mid") + xlab("Low") + ggtitle("Anthocyanin of High and Mid Leaves")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth(method = "lm")
ggplot() +aes(x = HH$Anth, y = HL$Anth) + geom_point(colour = "turquoise3", shape = 1) + ylab("Low") + xlab("High") + ggtitle("Anthocyanin of High and Mid Leaves")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth(method = "lm")
modA2 = lm(F1$Anth5 ~ F1$Height)
anova(modA2)
plot(modA2)
modA2 = lm(HH$Anth ~ HM$Anth)
anova(modA2)
plot(modA2)
AP4 = ggplot(data = subset(F1, !is.na(Height))) + aes(x =Height, y = Anth5) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Flav") + xlab("Height") + ggtitle("Anthocyanin by Collection Height") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = 0, colour = "red")+stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3);AP4
AP42 = ggplot() +aes(x = HH$Anth, y = HM$Anth) + geom_point(colour = "turquoise3", shape = 1) + ylab("Mid") + xlab("High") + ggtitle("Anthocyanin of High and Mid Leaves")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth(method = "lm")
AP43 = ggplot() +aes(x = HL$Anth, y = HM$Anth) + geom_point(colour = "turquoise3", shape = 1) + ylab("Mid") + xlab("Low") + ggtitle("Anthocyanin of High and Mid Leaves")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth(method = "lm")
AP44 = ggplot() +aes(x = HH$Anth, y = HL$Anth) + geom_point(colour = "turquoise3", shape = 1) + ylab("Low") + xlab("High") + ggtitle("Anthocyanin of High and Mid Leaves")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth(method = "lm")
grid.arrange(AP42,AP43,AP44)
grid.arrange(AP42,AP43,AP44, ncol = 2)
#Subset Leaf Height
FLWR = group_by(F1, Flower.Level, Tree.ID)
FLWR = summarise(FLWR, Anth = mean(Anth5, na.rm = T), Chl = mean(Chl5, na.rm = T), Flav = mean(Flav5, na.rm = T), H18 = mean(H185, na.rm = T), H19 = mean(H195, na.rm = T), HDiff = mean(HDiff, na.rm = T))
#Subset Leaf Height
FLWR = group_by(F1, Flower.Level, Tree.ID)
FLWR = summarise(FLWR, Anth = mean(Anth5, na.rm = T), Chl = mean(Chl5, na.rm = T), Flav = mean(Flav5, na.rm = T), H18 = mean(H185, na.rm = T), H19 = mean(H195, na.rm = T), HDiff = mean(HDiff, na.rm = T))
FLWR0 = FLWR$Flower.Level == "0"
FLWR0 = FLWR[FLWR0]
FLWR$Flower.Level = as.factor(FLWR$Flower.Level)
FLWR0 = FLWR$Flower.Level == "0"
FLWR0 = FLWR[FLWR0]
FLWR0 = FLWR[FLWR0,]
knitr::opts_chunk$set(echo = FALSE,cache = TRUE)
library(xlsx)
library(ggplot2)
library(gplots)
library(gridExtra)
library(corrplot)
library(dplyr)
library(png)
library(grid)
library(heatmaply)
#Import and Arrange Data
Data <- read.xlsx(file = "Entire.xlsx", sheetName = "Sheet1")
#Subset Leaf Height
FLWR = group_by(F1, Flower.Level, Tree.ID)
FLWR = summarise(FLWR, Anth = mean(Anth5, na.rm = T), Chl = mean(Chl5, na.rm = T), Flav = mean(Flav5, na.rm = T), H18 = mean(H185, na.rm = T), H19 = mean(H195, na.rm = T), HDiff = mean(HDiff, na.rm = T))
FLWR$Flower.Level = as.factor(FLWR$Flower.Level)
FLWR0 = FLWR$Flower.Level == "0"
FLWR0 = FLWR[FLWR0,]
FLWR1 = FLWR$Flower.Level == "1"
FLWR1 = FLWR[FLWR1,]
FLWR2 = FLWR$Flower.Level == "2"
FLWR2 = FLWR[FLWR2,]
FLWR3 = FLWR$Flower.Level == "3"
FLWR3 = FLWR[FLWR3,]
ggplot() +aes(x = FLWR0$Anth, y = FLWR1$Anth) + geom_point(colour = "turquoise3", shape = 1) + ylab("Mid") + xlab("High") + ggtitle("Anthocyanin of High vs Mid Leaves")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth(method = "lm")
moof = lm(FLWR0$Anth ~ FLWR1$Anth)
t.test(FLWR0$Anth, FLWR1$Anth)
t.test(FLWR0$Anth, FLWR1$Anth)
t.test(FLWR0$Anth, FLWR2$Anth)
t.test(FLWR0$Anth, FLWR3$Anth)
t.test(FLWR1$Anth, FLWR2$Anth)
t.test(FLWR2$Anth, FLWR3$Anth)
t.test(FLWR2$Anth, FLWR3$Anth)
t.test(FLWR0$Anth, FLWR1$Anth)
t.test(FLWR0$Anth, FLWR2$Anth)
t.test(FLWR0$Anth, FLWR3$Anth)
t.test(FLWR1$Anth, FLWR2$Anth)
t.test(FLWR1$Anth, FLWR3$Anth)
t.test(FLWR2$Anth, FLWR3$Anth)
