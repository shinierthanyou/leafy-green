#Boxplot Flavanol Replicates
AFlav <- ggplot(Data) + aes(x = Allocation, y = Flav) + geom_boxplot() +geom_hline(yintercept = FMA, color = "purple4") + ylab("Flavanol Measure") + xlab("Allocation") + ggtitle("Flavonol of Tree Allocation") + theme_classic();plot +stat_boxplot(notch = TRUE)
#Boxplot NBI Replicates
ANBI <- ggplot(Data) + aes(x = Allocation, y = NBI) + geom_boxplot() +geom_hline(yintercept = NMA, color = "purple4") + ylab("NBI Measure") + xlab("Allocation") + ggtitle("NBI of Tree Allocation") + theme_classic();plot +stat_boxplot(notch = TRUE)
#Display Plots
grid.arrange(AAnth,AChl,AFlav,ANBI, ncol=2)
#Chlorophyll
mod5 <-lm(Data$Chl ~ Data$Allocation)
anova(mod5)
#Nitrogen
mod6 <-lm(Data$NBI ~ Data$Allocation)
anova(mod5)
#Flavanol
mod7 <-lm(Data$Flav ~ Data$Allocation)
anova(mod7)
#Anthocyanin
mod8 <-lm(Data$Anth ~ Data$Allocation)
anova(mod8)
#Binding parents into single dataset
Parent <- rbind(EC201,EC103)
#Anthocyanin Mean
AMP = mean(Parent$Anth)
#Anthocyanin Boxplot
PAnth <- ggplot(Parent) + aes(x = Tree.ID, y = Anth) + geom_boxplot() +geom_hline(yintercept = AMP, color = "purple4") + ylab("Anthocyanin Measure") + xlab("Tree ID") + ggtitle("Anthocyanin of Parent Trees") + theme_classic();plot +stat_boxplot(notch = TRUE)
#Anthocyanin histogram
PHAnth <- ggplot(Parent) + aes(x = Anth) + geom_histogram()
#Anthocyanin Display plots
grid.arrange(PAnth, PHAnth)
#Anthocyanin T.test
t.test(Parent$Anth ~ Parent$Tree.ID)
#Chlorophyll Mean
CMP = mean(Parent$Chl)
#Chlorophyll Boxplot
PChl <- ggplot(Parent) + aes(x = Tree.ID, y = Chl) + geom_boxplot() +geom_hline(yintercept = CMP, color = "purple4") + ylab("Chlorophyll Measure") + xlab("Tree ID") + ggtitle("Chlorophyll of Parent Trees") + theme_classic();plot +stat_boxplot(notch = TRUE)
#Chlorophyll histogram
PHChl <- ggplot(Parent) + aes(x = Chl) + geom_histogram()
#Anthocyanin Display plots
grid.arrange(PChl, PHChl)
#Anthocyanin T.test
t.test(Parent$Chl ~ Parent$Tree.ID)
#Flavonol Mean
FMP = mean(Parent$Flav)
#Anthocyanin Boxplot
PFlav <- ggplot(Parent) + aes(x = Tree.ID, y = Flav) + geom_boxplot() +geom_hline(yintercept = FMP, color = "purple4") + ylab("Flavanol Measure") + xlab("Tree ID") + ggtitle("Flavonol of Parent Trees") + theme_classic();plot +stat_boxplot(notch = TRUE)
#Anthocyanin histogram
PHFlav <- ggplot(Parent) + aes(x = Flav) + geom_histogram()
#Anthocyanin Display plots
grid.arrange(PFlav, PHFlav)
#Anthocyanin T.test
t.test(Parent$Flav ~ Parent$Tree.ID)
#NBI Mean
NMP = mean(Parent$NBI)
#NBI Boxplot
PNBI <- ggplot(Parent) + aes(x = Tree.ID, y = NBI) + geom_boxplot() +geom_hline(yintercept = NMP, color = "purple4") + ylab("NBI Measure") + xlab("Tree ID") + ggtitle("Anthocyanin of Parent Trees") + theme_classic();plot +stat_boxplot(notch = TRUE)
#NBI histogram
PHNBI <- ggplot(Parent) + aes(x = NBI) + geom_histogram()
#Anthocyanin Display plots
grid.arrange(PNBI, PHNBI)
#Anthocyanin T.test
t.test(Parent$NBI ~ Parent$Tree.ID)
#Grouping F1 Measures By Tree
F12 <-group_by(F1,Tree.ID)
F12 <- summarise(F12,Chl = mean(Chl,na.rm=T), NBI = mean(NBI, ra.nm = T), Anth = mean(Anth, na.rm=T),Flav = mean(Flav,na.rm =T))
View(F12)
#Anthocyanin Mean
AMF = mean(F12$Anth);AMF
#Chlorophyll Mean
CMF = mean(F12$Chl);CMF
#Flavanol Mean
FMF = mean(F12$Flav);FMF
#NBI Mean
NMF = mean(F12$NBI); NMF
#Boxplot Anthocyanin F1
FAnth <- ggplot(F1) + aes(x = Tree.ID, y = Anth) + geom_boxplot() +geom_hline(yintercept = AMF, color = "purple4") + ylab("Anthocyanin Measure") + xlab("Tree ID") + ggtitle("Anthocyanin of F1 population") + theme_classic();plot +stat_boxplot(notch = TRUE)
#Histogram of Anthocyanin Distribution
FHAnth <- ggplot(F12) + aes(x = Anth) + geom_histogram()
#Display Anthocyanin Plots
grid.arrange(FAnth,FHAnth)
#Anthocyanin ANOVA
FAA = lm(F1$Anth ~ F1$Tree.ID)
anova(FAA)
#Boxplot Chlorophyll F1
FChl <- ggplot(F1) + aes(x = Tree.ID, y = Chl) + geom_boxplot() +geom_hline(yintercept = CMF, color = "purple4") + ylab("Chlorophyll Measure") + xlab("Tree ID") + ggtitle("Chlorophyll of F1 Population") + theme_classic();plot +stat_boxplot(notch = TRUE)
#Histogram of Chlorophyll
FHChl <- ggplot(F12) + aes(x = Chl) + geom_histogram()
#Display Chlorophyll Plots
grid.arrange(FChl, FHChl)
#Chlorophyll ANOVA
FCA = lm(F1$Chl ~ F1$Tree.ID)
anova(FCA)
#Boxplot Flavanol F1
FFlav <- ggplot(F1) + aes(x = Tree.ID, y = Flav) + geom_boxplot() +geom_hline(yintercept = FMF, color = "purple4") + ylab("Flavanol Measure") + xlab("Tree ID") + ggtitle("Flavonol of F1 Population") + theme_classic();plot +stat_boxplot(notch = TRUE)
#Histogram of Flavonol
FHFlav <- ggplot(F12) + aes(x = Flav) + geom_histogram()
#Display Chlorophyll Plots
grid.arrange(FFlav, FHFlav)
#Flavonol ANOVA
FFA = lm(F1$Flav ~ F1$Tree.ID)
anova(FFA)
#Boxplot NBI F1
FNBI <- ggplot(F1) + aes(x = Tree.ID, y = NBI) + geom_boxplot() +geom_hline(yintercept = NMF, color = "purple4") + ylab("NBI Measure") + xlab("Tree ID") + ggtitle("NBI of F1 Population") + theme_classic();plot +stat_boxplot(notch = TRUE)
#Histogram of NBI
FHNBI <- ggplot(F1) + aes(x = NBI) + geom_histogram()
#Display NBI Plots
grid.arrange(FNBI, FHNBI)
#NBI ANOVA
FNA = lm(F1$NBI ~ F1$Tree.ID)
anova(FNA)
#Boxplot Anthocyanin Height
HAnth <- ggplot(F1) + aes(x = Height, y = Anth) + geom_boxplot() +geom_hline(yintercept = AMF, color = "purple4") + ylab("Anthocyanin Measure") + xlab("Height") + ggtitle("Anthocyanin of F1 population by Height") + theme_classic();plot +stat_boxplot(notch = TRUE)
#Boxplot Chlorophyll F1
HChl <- ggplot(F1) + aes(x = Height, y = Chl) + geom_boxplot() +geom_hline(yintercept = CMF, color = "purple4") + ylab("Chlorophyll Measure") + xlab("Height") + ggtitle("Chlorophyll of F1 Population") + theme_classic();plot +stat_boxplot(notch = TRUE)
#Boxplot Flavanol F1
HFlav <- ggplot(F1) + aes(x = Height, y = Flav) + geom_boxplot() +geom_hline(yintercept = FMF, color = "purple4") + ylab("Flavanol Measure") + xlab("Height") + ggtitle("Flavonol of F1 Population by Height") + theme_classic();plot +stat_boxplot(notch = TRUE)
#Boxplot NBI F1
HNBI <- ggplot(F1) + aes(x = Height, y = NBI) + geom_boxplot() +geom_hline(yintercept = NMF, color = "purple4") + ylab("NBI Measure") + xlab("Height") + ggtitle("NBI of F1 Population") + theme_classic();plot +stat_boxplot(notch = TRUE)
grid.arrange(HAnth,HChl,HFlav,HNBI)
#Anthocyanin ANOVA
HAA = lm(F1$Anth ~ F1$Height)
anova(HAA)
#Chlorophyll ANOVA
HCA = lm(F1$Chl ~ F1$Height)
anova(FCA)
#Flavonol ANOVA
HFA = lm(F1$Flav ~ F1$Height)
anova(HFA)
#NBI ANOVA
HNA = lm(F1$NBI ~ F1$Height)
anova(HNA)
#Grouping data by ROw
F1R = group_by(F1,Row)
F1R = summarise(F1R,Chl = mean(Chl,na.rm=T), NBI = mean(NBI, ra.nm = T), Anth = mean(Anth, na.rm=T),Flav = mean(Flav,na.rm =T))
#Boxplot Anthocyanin Height
RoAnth <- ggplot(F1) + aes(x = Row, y = Anth) + geom_boxplot() +geom_hline(yintercept = AMF, color = "purple4") + ylab("Anthocyanin Measure") + xlab("Row") + ggtitle("Anthocyanin of F1 population by Row") + theme_classic();plot +stat_boxplot(notch = TRUE)
#Histogram of Anthocyanin
RoHAnth <- ggplot(F1R) + aes(x = Anth) + geom_histogram()
#Display plots
grid.arrange(RoAnth,RoHAnth)
#Anthocyanin ANOVA
RoAA = lm(F1$Anth ~ F1$Row)
anova(RoAA)
#Boxplot Chlorophyll F1
RoChl <- ggplot(F1) + aes(x = Row, y = Chl) + geom_boxplot() +geom_hline(yintercept = CMF, color = "purple4") + ylab("Chlorophyll Measure") + xlab("Row") + ggtitle("Chlorophyll of F1 Population by Row") + theme_classic();plot +stat_boxplot(notch = TRUE)
#Histogram of Chlorophyll
RoHChl <- ggplot(F1R) + aes(x = Chl) + geom_histogram()
#Display plots
grid.arrange(RoChl,RoHChl)
#Anthocyanin ANOVA
RoCA = lm(F1$Chl ~ F1$Row)
anova(RoCA)
#Boxplot Flavanol F1
RoFlav <- ggplot(F1) + aes(x = Row, y = Flav) + geom_boxplot() +geom_hline(yintercept = FMF, color = "purple4") + ylab("Flavanol Measure") + xlab("Row") + ggtitle("Flavonol of F1 Population by Row") + theme_classic();plot +stat_boxplot(notch = TRUE)
#Histogram of Flavonol
RoHFlav <- ggplot(F1R) + aes(x = Flav) + geom_histogram()
#Display plots
grid.arrange(RoFlav,RoHFlav)
#Anthocyanin ANOVA
RoFA = lm(F1$Flav ~ F1$Row)
anova(RoFA)
#Boxplot NBI F1
RoNBI <- ggplot(F1) + aes(x = Row, y = NBI) + geom_boxplot() +geom_hline(yintercept = NMF, color = "purple4") + ylab("NBI Measure") + xlab("Row") + ggtitle("NBI of F1 Population by Row") + theme_classic();plot +stat_boxplot(notch = TRUE)
#Histogram of NBI
RoHNBI <- ggplot(F1R) + aes(x = NBI) + geom_histogram()
#Display plots
grid.arrange(RoNBI,RoHNBI)
#Anthocyanin ANOVA
RoNA = lm(F1$NBI ~ F1$Row)
anova(RoNA)
#Making Column Values Factors
F1$Column = as.factor(F1$Column)
#Grouping data by Column
F1C = group_by(F1,Column)
F1C = summarise(F1R,Chl = mean(Chl,na.rm=T), NBI = mean(NBI, ra.nm = T), Anth = mean(Anth, na.rm=T),Flav = mean(Flav,na.rm =T))
#Boxplot Anthocyanin Height
CAnth <- ggplot(F1) + aes(x = Column, y = Anth) + geom_boxplot() +geom_hline(yintercept = AMF, color = "purple4") + ylab("Anthocyanin Measure") + xlab("Column") + ggtitle("Anthocyanin of F1 population by Column") + theme_classic();plot +stat_boxplot(notch = TRUE);CAnth
#Anthocyanin ANOVA
CAA = lm(F1$Anth ~ F1$Column)
anova(CAA)
#Boxplot Chlorophyll F1
CChl <- ggplot(F1) + aes(x = Column, y = Chl) + geom_boxplot() +geom_hline(yintercept = CMF, color = "purple4") + ylab("Chlorophyll Measure") + xlab("Column") + ggtitle("Chlorophyll of F1 Population by Column") + theme_classic();plot +stat_boxplot(notch = TRUE, show.legend = TRUE);CChl
#Anthocyanin ANOVA
CCA = lm(F1$Chl ~ F1$Column)
anova(CCA)
#Boxplot Flavanol F1
CFlav <- ggplot(F1) + aes(x = Column, y = Flav) + geom_boxplot() +geom_hline(yintercept = FMF, color = "purple4") + ylab("Flavanol Measure") + xlab("Column") + ggtitle("Flavonol of F1 Population by Column") + theme_classic();plot +stat_boxplot(notch = TRUE);CFlav
#Anthocyanin ANOVA
CFA = lm(F1$Flav ~ F1$Column)
anova(CFA)
#Boxplot NBI F1
CNBI <- ggplot(F1) + aes(x = Column, y = NBI) + geom_boxplot() +geom_hline(yintercept = NMF, color = "purple4") + ylab("NBI Measure") + xlab("Column") + ggtitle("NBI of F1 Population by Column") + theme_classic();plot +stat_boxplot(notch = TRUE);CNBI
#Anthocyanin ANOVA
CNA = lm(F1$NBI ~ F1$Column)
anova(CNA)
AnthDoc <-read.xlsx("Anth.xlsx", sheetName = "Anth")
heatmaply(AnthDoc, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE)
ChlDoc<-read.xlsx("Chl.xlsx", sheetName = "Chl")
heatmaply(ChlDoc, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE)
NBIDoc<-read.xlsx("NBI.xlsx", sheetName = "NBI")
heatmaply(NBIDoc, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE)
FlavDoc<-read.xlsx("Flav.xlsx", sheetName = "Flav")
heatmaply(FlavDoc, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE)
#Anthocyanin
CRHA = lm(F1$Anth ~ F1$Height*F1$Column*F1$Row)
anova(CRHA)
#Remove insignificant variables
CRHA2 = lm(F1$Anth ~ F1$Height*F1$Row)
anova(CRHA2)
FY<- symmary(CRHA2)
FY<- summary(CRHA2)
FY$coefficients
#Anthocyanin ANOVA
HAA = lm(F1$Anth ~ F1$Height)
anova(HAA)
summary(HAA)
F12$Anth = F12$Anth - AMF
summary(F12$Anth)
#Select Column,Row,Height,Tree.ID,Flav,Anth
xF = group_by(F1, Height,Column,Row,Tree.ID)
summary(xF)
View(xF)
#Select Column,Row,Height,Tree.ID,Flav,Anth
xF = group_by(F1, Height)
summary(xF)
View(xF)
#Select Column,Row,Height,Tree.ID,Flav,Anth
xF = group_by(F1, F1$Height)
summary(xF)
View(xF)
A <- mean(F1$Row[data$Chl == "Chl"])
A <- mean(F1$Row[F1$Chl == "Chl"])
A
F12$Chl = as.factor(F12$Chl)
A <- mean(F1$Row[F1$Chl == "Chl"])
A
library(data.table)
A <- setDT(F1[F1$Row == "a", ])[, mean(F1$Anth)]
A
A <- setDT(F1[F1$Row == "1", ])[, mean(F1$Anth)]
A
F12<-data.frame(Row=sample(c("1","2","3"), 10, T), value=rnorm(10))
r1<-with(dat, tapply(value, factor, mean))
r1<-with(F12, tapply(value, factor, mean))
F12<-data.frame(Column=sample(c("1","2","3","4"), 10, T), value=rnorm(10))
r1<-with(F12, tapply(value, factor, mean))
F12
View(F12)
factor_means <- by(F1$Anth, F1$Row, mean)
View(factor_means)
fm <- mean(F1$Row[F1$Anth == 1:50])
fm <- mean(F1$Row[F1$Anth == c(1:50]))
fm <- mean(F1$Row[F1$Anth == c(1:50))
fm <- mean(F1$Row[F1$Anth == c(1:50)])
summary(fnn)
summary(fm)
summary(F1)
mean(F1$Row,F1$Anth)
knitr::opts_chunk$set(echo = TRUE,cache = TRUE)
library(xlsx)
library(ggplot2)
library(gplots)
library(gridExtra)
library(corrplot)
library(dplyr)
library(png)
library(grid)
library(heatmaply)
is.factor(F1)
is.factor(F1$Row)
levels(F1$Row)
is.factor(F1$Anth)
Co = F1[c(13,14,15,16)]
cor(Co)
corrplot(Co)
Co = F1[c(4,13,14,15,16)]
cor(Co)
corrplot(Co)
library(corrplot)
corrplot(Co)
Co = F1[c(13,14,15,16)]
cor(Co)
corrplot(Co)
ANChl = lm(F1$Chl ~ F1$Row)
plot(lm)
plot(ANChl)
summary(ANChl)
coef(ANChl)
Table = as.table(coef(ANChl))
Table
Tab = write.table(ceof(ANChl))
Tab = write.table(coef(ANChl))
data.table(Co)
Co = F1[c(4,13,14,15,16)]
data.table(Co)
?data.table
Co2= data.table(Co)
Co2= data.table (group_by((Co))
Co2= data.table Co[group_by(Co$Column)])
Co2 = data.table Co[group_by(Co$Column)])
Co2 = data.table (Co[group_by(Co$Column)]))
Co2 = data.table (Co[group_by(Co$Column)])
Co = F1[c(4,5,8,11,13,14,15,16)]
Co2 = data.table(Co)
Co2
View(Co2)
levels(Co2$Row)
A <- mean(F1$Row[F1$Chl == "28" "29" "3"  "30" "31" "32" "33" "34" "35" "36" "37" "38" "39" "4"  "40" "41" "42" "43" "44" "45" "46" "47" "48" "49" "5"  "50" "6"  "7"  "8"  "9" "0"  "1"  "10" "11" "12" "13" "14" "15" "16" "17" "18" "19" "2"  "20" "21" "22" "23" "24" "25" "26" "27"])
A <- mean(Co2$Row[Co2$Chl == "28" "29" "3"  "30" "31" "32" "33" "34" "35" "36" "37" "38" "39" "4"  "40" "41" "42" "43" "44" "45" "46" "47" "48" "49" "5"  "50" "6"  "7"  "8"  "9" "0"  "1"  "10" "11" "12" "13" "14" "15" "16" "17" "18" "19" "2"  "20" "21" "22" "23" "24" "25" "26" "27"])
A <- mean(Co2$Row[Co2$Chl == "28" "29" "3"  "30" "31" "32" "33" "34" "35" "36" "37" "38" "39" "4"  "40" "41" "42" "43" "44" "45" "46" "47" "48" "49" "5"  "50" "6"  "7"  "8"  "9" "0"  "1"  "10" "11" "12" "13" "14" "15" "16" "17" "18" "19" "2"  "20" "21" "22" "23" "24" "25" "26" "27",])
A <- mean(Co2$Chl[Co2$Row == "28" "29" "3"  "30" "31" "32" "33" "34" "35" "36" "37" "38" "39" "4"  "40" "41" "42" "43" "44" "45" "46" "47" "48" "49" "5"  "50" "6"  "7"  "8"  "9" "0"  "1"  "10" "11" "12" "13" "14" "15" "16" "17" "18" "19" "2"  "20" "21" "22" "23" "24" "25" "26" "27",])
Co2 = group_by(Co2,Row)
View(Co2)
hist(Co2$Row)
ROW = as.numeric(Co2$Row)
hist(ROW)
summary(ROW)
coef(ROW)
levels(ROW)
levels(Co2$Row)
frequency(Co2$Row)
frequency(levels(Co2$Row))
hist(ROW)
prop.table(ROW)
prop.table(Co2$Row)
Co2
Co2 = group_by(Co2,Col)
Co2 = group_by(Co2,Column)
View(Co2)
View(F1)
Con = F1[c(4:6,10,11:16)]
?sort
qplot(F1)
qplot(F1$An)
qplot(F1$Anth)
aqplot(Chl)
aqplot(F1$Chl)
qplot(F1$Chl)
Con = group_by(Con,Row)
Con = group_by(Con,Height)
#Bas = group_by(HDat,Column,Row,Tree.ID)
#Bas = summarise(Bas, Flav = mean(Flav, na.rm = T), NBI = mean(NBI, na.rm = T), Anth = mean(Anth, na.rm = T), Chl = mean(Chl, na.rm = T))
Con = summarise(Con, Anth = mean(Anth, na.rm = T), Chl = mean(Chl, na.rm = T), Flav = mean(Flavna.rm = T), NBI = mean(NBI, na.rm = T))
#Bas = group_by(HDat,Column,Row,Tree.ID)
#Bas = summarise(Bas, Flav = mean(Flav, na.rm = T), NBI = mean(NBI, na.rm = T), Anth = mean(Anth, na.rm = T), Chl = mean(Chl, na.rm = T))
Con = summarise(Con, Anth = mean(Anth, na.rm = T), Chl = mean(Chl, na.rm = T), Flav = mean(Flav,na.rm = T), NBI = mean(NBI, na.rm = T))
View(Con)
table(Con)
as.table(Con)
Con
###
RAnthC = mean(F1$Anth) - Con$Anth
RanthC
RAnthC
###
RAnthC = Con$Anth - ConH$Anth
Con = F1[c(4:6,10,11:16)]
ConH = group_by(Con,Height)
#Bas = group_by(HDat,Column,Row,Tree.ID)
#Bas = summarise(Bas, Flav = mean(Flav, na.rm = T), NBI = mean(NBI, na.rm = T), Anth = mean(Anth, na.rm = T), Chl = mean(Chl, na.rm = T))
ConH = summarise(Con, Anth = mean(Anth, na.rm = T), Chl = mean(Chl, na.rm = T), Flav = mean(Flav,na.rm = T), NBI = mean(NBI, na.rm = T))
###
RAnthC = Con$Anth - ConH$Anth
RAnthC
View(RAnthC)
Con$AMH = Con$Anth - ConH$Anth
View(Con)
Con$AM = mean(Con$Anth)
View(Con)
Con$AHM = ConH$Anth
View(Con)
View(ConH)
Con$HMean = ConH$Anth
View(Con)
Dat = F1
DatH = group_by(Dat, Height)
DatH = summarise(DatH, Anth = mean(Anth, na.rm = T), Chl = mean(Chl, na.rm = T), Flav = mean(Flav,na.rm = T), NBI = mean(NBI, na.rm = T))
Dat$ATmean = mean(Dat$Anth)
View(Dat)
Dat$CTmean = mean(Dat$Chl)
View(Dat)
Dat$FTmean = mean(Dat$Flav)
Dat$NTmean = mean(Dat$NBI)
Dat$AHmean = DatH$Anth
View(Dat)
Dat$Chl2 = Dat$CTmean - Dat$Chl
View(Dat)
Dat$Anth2 = Dat$ATmean - Dat$Anth
Dat$Flav2 = Dat$FTmean - Dat$Flav
Dat$NBI2 = Dat$NTmean - Dat$NBI
View(DatH)
Dat$Hmean <- row.names(DatH)
Dat$Hmean <- row.names(Dat)
merge(Dat,DatH)
merge(Dat,DatH, by.x = 2, by.y = 0, all.x = TRUE)
DatH$Hmean <- row.names(DatH)
merge(Dat,DatH, by.x = 2, by.y = 0, all.x = TRUE)
View(Dat)
knitr::opts_chunk$set(echo = TRUE,cache = TRUE)
library(xlsx)
library(ggplot2)
library(gplots)
library(gridExtra)
library(corrplot)
library(dplyr)
library(png)
library(grid)
library(heatmaply)
library(corrplot)
knitr::opts_chunk$set(echo = TRUE,cache = FALSE)
library(xlsx)
library(ggplot2)
library(gplots)
library(gridExtra)
library(corrplot)
library(dplyr)
library(png)
library(grid)
library(heatmaply)
# Import Data Measures
Data <-read.xlsx("Full.xlsx", sheetName ="Full")
head(Data)
# Import Replicate Data
Dup <-read.xlsx("Full.xlsx", sheetName ="Dup")
head(Dup)
#Isolate Crimson Glory Outgroup
CG = Data[c(1:11),]
head(CG)
#Isolate East Cape 201 Parent
EC201 = Data[c(12:21),]
head(EC201)
#Isolate East Cape 103 Parent
EC103 = Data[c(22:33),]
head(EC103)
#Isolate Offspring from the Parental Cross
F1 = Data[c(34:1825),]
head(F1)
DatH$Hmean <- rownames(DatH)
Dat = F1
DatH = group_by(Dat, Height)
DatH = summarise(DatH, Anth = mean(Anth, na.rm = T), Chl = mean(Chl, na.rm = T), Flav = mean(Flav,na.rm = T), NBI = mean(NBI, na.rm = T))
Dat$ATmean = mean(Dat$Anth)
Dat$CTmean = mean(Dat$Chl)
Dat$FTmean = mean(Dat$Flav)
Dat$NTmean = mean(Dat$NBI)
Dat$AHmean = DatH$Anth
Dat$Anth2 = Dat$ATmean - Dat$Anth
Dat$Chl2 = Dat$CTmean - Dat$Chl
Dat$Flav2 = Dat$FTmean - Dat$Flav
Dat$NBI2 = Dat$NTmean - Dat$NBI
DatH$Hmean <- rownames(DatH)
merge(Dat,DatH, by.x = 2, by.y = 0, all.x = TRUE)
View(Dat)
View(DatH)
DatH$HMChl = DatH$Chl
DatH$HMFlav = DatH$Flav
DatH$HMAnth = DatH$Anth
DatH$HMChl = DatH$Chl
DatH$HMFlav = DatH$Flav
DatH$HMNBI = DatH$NBI
View(DatH)
DatH = DatH[c(1,7:10)]
merge(Dat,DatH, by.x = 2, by.y = 0, all.x = TRUE)
View(Dat)
DatH$Hmean <- rownames(DatH)
merge(Dat,DatH, by.x = 2, by.y = 0, all.x = TRUE)
View(Dat)
merge(cbind(Dat, X=rownames(Dat)), cbind(DatH, variable=rownames(DatH)))
View(Dat)
View(Dat)
View(DatH)
DatH$Chl = Dat$Chl
#Height Mean
DatH = group_by(Dat, Height,Col,Row)
#Height Mean
DatH = group_by(Dat, Height,Column,Row)
DatH = summarise(DatH, Anth = mean(Anth, na.rm = T), Chl = mean(Chl, na.rm = T), Flav = mean(Flav,na.rm = T), NBI = mean(NBI, na.rm = T))
DatH$HMAnth = DatH$Anth
DatH$Chl = Dat$Chl
DatH$Chl = DatH$Chl
DatH$HMChl = DatH$Chl
DatH$HMFlav = DatH$Flav
DatH$HMNBI = DatH$NBI
merge(Dat,DatH)
View(Dat)
merge(cbind(Dat, X=rownames(Dat)), cbind(DatH, Chl=rownames(DatH)))
View(Dat)
merge(Dat,DatH)
View(Dat)
merge(cbind(Dat, X=rownames(Dat)), cbind(DatH, Height=rownames(DatH)))
View(Dat)
Dat$NBI2 = Dat$NBI - Dat$NTmean
#Remove Total Mean
Dat$Anth2 = Dat$Anth - Dat$ATmean
Dat$Chl2 = Dat$Chl - Dat$CTmean
Dat$Flav2 = Dat$Flav - Dat$FTmean
Dat$NBI2 = Dat$NBI - Dat$NTmean
View(Dat)
Dat = F1
#Total Mean
Dat$ATmean = mean(Dat$Anth)
Dat$CTmean = mean(Dat$Chl)
Dat$FTmean = mean(Dat$Flav)
Dat$NTmean = mean(Dat$NBI)
#Remove Total Mean
Dat$Anth2 = Dat$Anth - Dat$ATmean
Dat$Chl2 = Dat$Chl - Dat$CTmean
Dat$Flav2 = Dat$Flav - Dat$FTmean
Dat$NBI2 = Dat$NBI - Dat$NTmean
#Height Mean
DatH = group_by(Dat, Height,Column,Row)
DatH = summarise(DatH, HAnth = mean(Anth, na.rm = T), HChl = mean(Chl, na.rm = T), HFlav = mean(Flav,na.rm = T), HNBI = mean(NBI, na.rm = T))
merge(cbind(Dat, X=rownames(Dat)), cbind(DatH, Height=rownames(DatH)))
View(Dat)
