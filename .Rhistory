grid.arrange(FMN,FMN2)
#Histogram of Measurement Distribution
FHN2 <-ggplot(Dat12) +aes(NBI) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Nitrogen") + ggtitle("Nitrogen Distribution of F1 Trees After Correction") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
grid.arrange(FHN,FHN2)
#Height Boxplot
HBN2 <- ggplot(Dat) + aes(x = Height, y = NBI5,) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Nitrogen Measure") + xlab("Height") + ggtitle("NBI Height After Correction") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$NBI5))
#grid.arrange(HBN,HBN2, ncol = 2)
#Height Histogram
HHN2 <-ggplot(Dat) +aes(NBI5,color=Height, fill=Height) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Nitrogen") + ggtitle("Nitrogen by Height After Correction") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
#grid.arrange(HHN,HHN2)
#Height Means
HMN2 <-ggplot(Dat) +aes(x = Tree.ID, y = NBI5, colour = Height, fill = Height) + geom_point() +geom_hline(yintercept = mean(Dat$NBI5), colour = "dodgerblue1")+ ylab("Nitrogen") + xlab("Tree ID") + ggtitle("Nitrogen Height Measures After Correction")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))
grid.arrange(HMN,HMN2)
#Row
#Boxplot Nitrogen by Row
RoBN2 <- ggplot(Dat) + aes(x = Row, y = NBI5) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Nitrogen Measure") + xlab("Row") + ggtitle("Nitrogen by Row After Correction") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$NBI5), colour = "lightpink")
grid.arrange(RoBN,RoBN2)
#Mean Distribution
RoMN2 <-ggplot(Dat14) +aes(x = Row, y = NBI) + geom_point(colour = "turquoise3") +geom_hline(yintercept = mean(Dat14$NBI), colour = "orchid3")+ ylab("NBI") + xlab("Tree ID") + ggtitle("Nitrogen Row Means After Correction")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))
grid.arrange(RoMN,RoMN2)
#Histogram
RoHN2 <-ggplot(Dat14) +aes(NBI) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Nitrogen") + ggtitle("Nitrogen Distribution of F1 Rows After Correction") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
grid.arrange(RoHN,RoHN2)
#Column
#Boxplot Nitrogen Column
CBN2 <- ggplot(Dat) + aes(x = Column, y = NBI5) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Nitrogen Measure") + xlab("Column") + ggtitle("NBI Column After Correction") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$NBI5))
grid.arrange(CBN,CBN2, ncol=2)
#Loes Method
plot9 <-ggplot(Dat) + aes(x = Anth5, y = Chl5) + geom_point(shape = 21) +theme_bw() +geom_smooth()
plot10 <-ggplot(Dat) + aes(x = Anth5, y = Flav5) + geom_point(shape = 21) +theme_bw()+geom_smooth()
plot11<-ggplot(Dat) + aes(x = Anth5, y = NBI5) +geom_point(shape = 21) +theme_bw()+geom_smooth()
plot12<-ggplot(Dat) + aes(x = Chl5, y = Flav5) + geom_point(shape = 21) +theme_bw()+geom_smooth()
plot13<-ggplot(Dat) + aes(x = Chl5, y = NBI5) + geom_point(shape = 21) +theme_bw()+geom_smooth()
plot14<-ggplot(Dat) + aes(x = Flav5, y = NBI5) + geom_point(shape = 21) +theme_bw()+geom_smooth()
grid.arrange(plot9,plot10,plot11,plot12,plot13,plot14)
AnthComp = lm(Anth5 ~ Chl5*Flav5*NBI5, data = Dat)
anova(AnthComp)
ChlComp = lm(Chl5 ~ Anth5*Flav5*NBI5, data = Dat)
anova(ChlComp)
FlavComp = lm(Flav5 ~ Anth5*Chl5*NBI5, data = Dat)
anova(FlavComp)
NBIComp = lm(NBI5 ~ Anth5*Chl5*Flav5, data = Dat)
anova(NBIComp)
#Plots Flowering vs Non-Flowering
plot39 = ggplot(Dat) + aes(x = Flower, y = Anth5) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Anth") + xlab("Flower Status") + ggtitle("Anthocyanin") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$Anth5), colour = "red") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3)
plot40= ggplot(Dat) + aes(x = Flower, y = Chl5) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Chl") + xlab("Flower Status") + ggtitle("Chlorophyll") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$Chl5), colour = "red") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3)
plot41= ggplot(Dat) + aes(x = Flower, y = Flav5) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Flav") + xlab("Flower Status") + ggtitle("Flavonol") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$Flav5), colour = "red") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3)
plot42= ggplot(Dat) + aes(x = Flower, y = NBI5) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("NBI") + xlab("Flower Status") + ggtitle("NBI") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$NBI5), colour = "red") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3)
grid.arrange(plot39,plot40,plot41,plot42, top = "Chemical Measures Related to Flowering")
AF<- lm(Dat$Anth5 ~ Dat$Flower)
anova(AF)
summary(AF)
CF<- lm(Dat$Chl5 ~ Dat$Flower)
anova(CF)
summary(CF)
FF<- lm(Dat$Flav5 ~ Dat$Flower)
anova(FF)
summary(FF)
NF<- lm(Dat$NBI5 ~ Dat$Flower)
anova(NF)
summary(NF)
DatTree = group_by(Dat, Tree.ID, Column, Row)
DatTree = summarise(DatTree, Anth = mean(Anth4), Flav = mean(Flav5), Chl = mean(Chl3),NBI = mean(NBI4))
DatTree$Tree.ID = as.factor(DatTree$Tree.ID)
H089 = read.xlsx("H0892.xlsx", sheetName = "H089")
H089 = merge(H089,DatTree, by.x = "Tree.ID", all = TRUE)
#write.xlsx(H089, "H0893.xlsx", sheetName = "089")
H089$Height08 = as.character(H089$Height08)
H089$Height08 = as.numeric(H089$Height08)
H089$Height09 = as.character(H089$Height09)
H089$Height09  = as.numeric(H089$Height09)
H089$Diff = H089$Height09 - H089$Height08
EH = read.xlsx("H08932.xlsx", sheetName = "Sheet3")
EH$X1 = as.character(EH$X1)
EH$X1 = as.numeric(EH$X1)
EH$X2 = as.character(EH$X2)
EH$X2 = as.numeric(EH$X2)
EH$X3 = as.character(EH$X3)
EH$X3 = as.numeric(EH$X3)
EH$X4 = as.character(EH$X4)
EH$X4 = as.numeric(EH$X4)
heatmaply(EH,Colv = FALSE, Rowv = FALSE, xlab = "Column",ylab = "Row", main = "Tree Height Across Planting Block 2018")
H08A = lm(H089$Anth ~ H089$Height08)
anova(H08A)
H08C = lm(H089$Chl ~ H089$Height08)
anova(H08C)
H08F = lm(H089$Flav ~ H089$Height08)
anova(H08F)
H08N = lm(H089$NBI ~ H089$Height08)
anova(H08N)
EH9 = read.xlsx("H08932.xlsx", sheetName = "Sheet2")
EH9$X1 = as.character(EH9$X1)
EH9$X1 = as.numeric(EH9$X1)
EH9$X2 = as.character(EH9$X2)
EH9$X2 = as.numeric(EH9$X2)
EH9$X3 = as.character(EH9$X3)
EH9$X3 = as.numeric(EH9$X3)
EH9$X4 = as.character(EH9$X4)
EH9$X4 = as.numeric(EH9$X4)
heatmaply(EH9,Colv = FALSE, Rowv = FALSE, xlab = "Column",ylab = "Row", main = "Tree Height Across Planting Block 2019")
H09A = lm(H089$Anth ~ H089$Height09)
anova(H09A)
H09C = lm(H089$Chl ~ H089$Height09)
anova(H09C)
H09F = lm(H089$Flav ~ H089$Height09)
anova(H09F)
H09N = lm(H089$NBI ~ H089$Height09)
anova(H09N)
Diff = read.xlsx("H08932.xlsx", sheetName = "Diff")
heatmaply(Diff,Colv = FALSE, Rowv = FALSE, xlab = "Column",ylab = "Row", main = "Height difference between 2018 and 2019")
H0A = lm(H089$Anth ~ H089$Diff)
anova(H0A)
H0C = lm(H089$Chl ~ H089$Diff)
anova(H0C)
H0F = lm(H089$Flav ~ H089$Diff)
anova(H0F)
H0N = lm(H089$NBI ~ H089$Diff)
anova(H0N)
H0892 = read.xlsx("H08932.xlsx", sheetName = "Sheet1")
H0892$Height09 = as.character(H0892$Height09)
H0892$Height09 = as.numeric(H0892$Height09)
#Histogram
H1 = ggplot(H0892) +aes(Height08) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Height (cm)") + ggtitle("Height distribution of 2018") +theme_bw() +theme(plot.title = element_text(hjust = 0.5));H1
H2 = ggplot(H0892) +aes(Height09) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Height (cm)") + ggtitle("Height distribution of 2019") +theme_bw() +theme(plot.title = element_text(hjust = 0.5));H2
H3 = ggplot(H0892) +aes(Diff) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Height (cm)") + ggtitle("Height distribution of 2018/2019 Differences") +theme_bw() +theme(plot.title = element_text(hjust = 0.5));H3
#Row Height Distributions
R1 = ggplot(H0892) + aes(x = Row, y = Height08) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Height (cm)") + xlab("Row") + ggtitle("Height Measures by Row 2018") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(H0892$Height08), colour = "red");R1
R2 = ggplot(H0892) + aes(x = Row, y = Height09) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Height (cm)") + xlab("Row") + ggtitle("Height Measures by Row 2019") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(H0892$Height09), colour = "red");R2
R3 = ggplot(H0892) + aes(x = Row, y = Diff) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Height (cm)") + xlab("Row") + ggtitle("Difference in Height Measures 2018-19 by Row") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(H0892$Diff), colour = "red");R3
H089R = group_by(H0892, Row)
H089R = summarise(H089R, RowHM8 = mean(Height08, na.rm = T), RowHM9 = mean(Height09, na.rm = T), RDiff = mean(Diff, na.rm = T))
#Mean Distribution
R4 = ggplot(H089R) +aes(x = Row, y = RowHM8) + geom_point(colour = "turquoise3") +geom_hline(yintercept = mean(H089R$RowHM8), colour = "orchid3")+ ylab("Height (cm)") + xlab("Row") + ggtitle("Height Row Means 2018")+theme_bw()+theme(plot.title = element_text(hjust = 0.5));R4
R5 = ggplot(H089R) +aes(x = Row, y = RowHM9) + geom_point(colour = "turquoise3") +geom_hline(yintercept = mean(H089R$RowHM9), colour = "orchid3")+ ylab("Height (cm)") + xlab("Row") + ggtitle("Height Row Means 2019")+theme_bw()+theme(plot.title = element_text(hjust = 0.5));R5
R6 = ggplot(H089R) +aes(x = Row, y = RDiff) + geom_point(colour = "turquoise3") +geom_hline(yintercept = mean(H089R$RDiff), colour = "orchid3")+ ylab("Height (cm)") + xlab("Row") + ggtitle("Difference in Row Height Means 2018-19")+theme_bw()+theme(plot.title = element_text(hjust = 0.5));R6
HRA8 = lm(H0892$Height08 ~ H0892$Row)
anova(HRA8)
HRA9 = lm(H0892$Height09 ~ H0892$Row)
anova(HRA9)
HRAD = lm(H0892$Diff ~ H0892$Row)
anova(HRAD)
#Height Distributions
C1 = ggplot(H0892) + aes(x = Column, y = Height08) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Height (cm)") + xlab("Column") + ggtitle("Height Measures by Column 2018") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(H0892$Height08), colour = "red") +stat_summary(fun.y=mean, colour="green", geom="point", shape=18, size=3);C1
C2 = ggplot(H0892) + aes(x = Column, y = Height09) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Height (cm)") + xlab("Column") + ggtitle("Height Measures by Column 2019") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(H0892$Height09), colour = "red") +stat_summary(fun.y=mean, colour="green", geom="point", shape=18, size=3);C2
C3 = ggplot(H0892) + aes(x = Column, y = Diff) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Height (cm)") + xlab("Column") + ggtitle("Height Difference 2018-19 by Column") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(H0892$Diff), colour = "red") +stat_summary(fun.y=mean, colour="green", geom="point", shape=18, size=3);C3
HCA8 = lm(H0892$Height08 ~ H0892$Column)
anova(HCA8)
HCA9 = lm(H0892$Height09 ~ H0892$Column)
anova(HCA9)
HCAD = lm(H0892$Diff ~ H0892$Column)
anova(HCAD)
H089C = group_by(H0892, Column)
H089C = summarise(H089C, ColHM8 = mean(Height08, na.rm = T), ColHM9 = mean(Height09, na.rm = T), CDiff = mean(Diff, na.rm = T))
HData = merge(H0892 ,H089C, by.x = "Column", all = TRUE)
HData = merge(HData ,H089R, by.x = "Row", all = TRUE)
HData$HM8 = mean(HData$Height08)
HData$HM9 = mean(HData$Height09)
HData$CD8 = HData$ColHM8 - HData$HM8
HData$CD9 = HData$ColHM9 - HData$HM9
HData$RD8 = HData$RowHM8 - HData$HM8
HData$RD9 = HData$RowHM9 - HData$HM9
HData$F8 = HData$Height08 - HData$HM8 - HData$CD8 - HData$RD8
HData$F9 = HData$Height09 - HData$HM9 - HData$CD9 - HData$RD9
HData$FDiff = HData$F9 - HData$F8
#write.xlsx(HData, "HData.xlsx")
H82 = read.xlsx("HData2.xlsx", sheetName = "H8")
heatmaply(H82,Colv = FALSE, Rowv = FALSE, xlab = "Column",ylab = "Row", main = "Adjusted Height 2018")
H92 = read.xlsx("HData2.xlsx", sheetName = "H9")
heatmaply(H92,Colv = FALSE, Rowv = FALSE, xlab = "Column",ylab = "Row", main = "Adjusted Height 2019")
HD2 = read.xlsx("HData2.xlsx", sheetName = "Diff")
heatmaply(HD2,Colv = FALSE, Rowv = FALSE, xlab = "Column",ylab = "Row", main = " Adjusted Height difference between 2018 and 2019")
#Histogram
H12 = ggplot(HData) +aes(F8) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Height (cm)") + ggtitle("Adjusted Tree Height 2018") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
grid.arrange(H1,H12)
H22 = ggplot(HData) +aes(F9) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Height (cm)") + ggtitle("Adjusted Tree Height 2019") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
grid.arrange(H2,H22)
H32 = ggplot(HData) +aes(FDiff) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Height (cm)") + ggtitle("Adjusted Tree Height Differences 2018-2019") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
grid.arrange(H3,H32)
#Row Height Distributions
R12 = ggplot(HData) + aes(x = Row, y = F8) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Height (cm)") + xlab("Row") + ggtitle("Adjusted Row Heights 2018") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(HData$F8), colour = "red")
grid.arrange(R1,R12, top = "2018 Row Heights")
R22 = ggplot(HData) + aes(x = Row, y = F9) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Height (cm)") + xlab("Row") + ggtitle("Adjusted Row Heights 2019") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(HData$F9), colour = "red")
grid.arrange(R2,R22,  top = "2019 Row Heights")
R32 = ggplot(HData) + aes(x = Row, y = FDiff) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Height (cm)") + xlab("Row") + ggtitle("Adjusted Row Height Difference") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(HData$FDiff), colour = "red")
grid.arrange(R3, R32,  top = "2018-19 Difference Row Heights")
HDataR = group_by(HData, Row)
HDataR = summarise(HDataR, FRM8 = mean(F8, na.rm = T), FRM9 = mean(F9, na.rm = T), FRMDif = mean(FDiff, na.rm = T))
#Mean Distribution
R42 = ggplot(HDataR) +aes(x = Row, y = FRM8) + geom_point(colour = "turquoise3") +geom_hline(yintercept = mean(HDataR$FRM8), colour = "orchid3")+ ylab("Height (cm)") + xlab("Row") + ggtitle("Adjusted Height Row Means 2018")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))
grid.arrange(R4,R42,  top = "2018 Row Height Means")
R52 = ggplot(HDataR) +aes(x = Row, y = FRM9) + geom_point(colour = "turquoise3") +geom_hline(yintercept = mean(HDataR$FRM9), colour = "orchid3")+ ylab("Height (cm)") + xlab("Row") + ggtitle("Adjusted Height Row Means 2019")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))
grid.arrange(R5, R52,  top = "2019 Row Height Means")
R62 = ggplot(HDataR) +aes(x = Row, y = FRMDif) + geom_point(colour = "turquoise3") +geom_hline(yintercept = mean(HDataR$FRMDif), colour = "orchid3")+ ylab("Height (cm)") + xlab("Row") + ggtitle("Adjusted Row Height Difference")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))
grid.arrange(R6,R62, top = "2018-19 Difference Row Height Means")
HRA8 = lm(H0892$Height08 ~ H0892$Row)
anova(HRA8)
HRA9 = lm(H0892$Height09 ~ H0892$Row)
anova(HRA9)
HRAD = lm(H0892$Diff ~ H0892$Row)
anova(HRAD)
#Height Distributions
C12 = ggplot(HData) + aes(x = Column, y = F8) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Height (cm)") + xlab("Column") + ggtitle("Adjusted Column Heights 2018") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(HData$CD8), colour = "red") +stat_summary(fun.y=mean, colour="green", geom="point", shape=18, size=3)
grid.arrange(C1,C12,ncol = 2)
C22 = ggplot(HData) + aes(x = Column, y = F9) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Height (cm)") + xlab("Column") + ggtitle("Adjusted Column Heights 2019") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(HData$F9), colour = "red") +stat_summary(fun.y=mean, colour="green", geom="point", shape=18, size=3)
grid.arrange(C2,C22,ncol = 2)
C32 = ggplot(HData) + aes(x = Column, y = FDiff) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Height (cm)") + xlab("Column") + ggtitle("Adjusted Column Difference") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(HData$FDiff), colour = "red") +stat_summary(fun.y=mean, colour="green", geom="point", shape=18, size=3)
grid.arrange(C3,C32, ncol = 2)
FHCA8 = lm(HData$F8 ~ HData$Column)
anova(FHCA8)
FHCA9 = lm(HData$F9 ~ HData$Column)
anova(FHCA9)
FHCAD = lm(HData$FDiff ~ HData$Column)
anova(FHCAD)
Corr1 = ggplot(HData) +aes(x = F8, y = Anth) + geom_point(colour = "turquoise3") + ylab("Anthocyanin") + xlab("Height") + ggtitle("Height 2018 and Anthocyanin")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
Corr2 = ggplot(HData) +aes(x = F8, y = Chl) + geom_point(colour = "turquoise3") + ylab("Chlorophyll") + xlab("Height") + ggtitle("Height 2018 and Chlorophyll")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
Corr3 = ggplot(HData) +aes(x = F8, y = Flav) + geom_point(colour = "turquoise3") + ylab("Flavonol") + xlab("Height") + ggtitle("Height 2018 and Flavonol")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
Corr4 = ggplot(HData) +aes(x = F8, y = NBI) + geom_point(colour = "turquoise3") + ylab("NBI") + xlab("Height") + ggtitle("Height 2018 and NBI")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
grid.arrange(Corr1, Corr2, Corr3, Corr4)
An1 = lm(HData$F8 ~ HData$Anth)
anova(An1)
An2 = lm(HData$F8 ~ HData$Chl)
anova(An2)
An3 = lm(HData$F8 ~ HData$Flav)
anova(An1)
An4 = lm(HData$F8 ~ HData$NBI)
anova(An4)
Corr5 = ggplot(HData) +aes(x = F9, y = Anth) + geom_point(colour = "turquoise3") + ylab("Anthocyanin") + xlab("Height") + ggtitle("Height 2019 and Anthocyanin")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
Corr6 = ggplot(HData) +aes(x = F9, y = Chl) + geom_point(colour = "turquoise3") + ylab("Chlorophyll") + xlab("Height") + ggtitle("Height 2019 and Chlorophyll")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
Corr7 = ggplot(HData) +aes(x = F9, y = Flav) + geom_point(colour = "turquoise3") + ylab("Flavonol") + xlab("Height") + ggtitle("Height 2019 and Flavonol")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
Corr8 = ggplot(HData) +aes(x = F9, y = NBI) + geom_point(colour = "turquoise3") + ylab("NBI") + xlab("Height") + ggtitle("Height 2019 and NBI")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
grid.arrange(Corr5, Corr6, Corr7, Corr8)
An5 = lm(HData$F9 ~ HData$Anth)
anova(An5)
An6 = lm(HData$F9 ~ HData$Chl)
anova(An6)
An7 = lm(HData$F9 ~ HData$Flav)
anova(An7)
An8 = lm(HData$F9 ~ HData$NBI)
anova(An8)
Corr9 = ggplot(HData) +aes(x = FDiff, y = Anth) + geom_point(colour = "turquoise3") + ylab("Anthocyanin") + xlab("Height") + ggtitle("Height Difference and Anthocyanin")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
Corr10 = ggplot(HData) +aes(x = FDiff, y = Chl) + geom_point(colour = "turquoise3") + ylab("Chlorophyll") + xlab("Height") + ggtitle("Height Difference and Chlorophyll")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
Corr11 = ggplot(HData) +aes(x = FDiff, y = Flav) + geom_point(colour = "turquoise3") + ylab("Flavonol") + xlab("Height") + ggtitle("Height Difference and Flavonol")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
Corr12 = ggplot(HData) +aes(x = FDiff, y = NBI) + geom_point(colour = "turquoise3") + ylab("NBI") + xlab("Height") + ggtitle("Height Difference and NBI")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth()
grid.arrange(Corr9, Corr10, Corr11, Corr12)
An9 = lm(HData$FDiff ~ HData$Anth)
anova(An9)
An10 = lm(HData$FDiff ~ HData$Chl)
anova(An10)
An11 = lm(HData$FDiff ~ HData$Flav)
anova(An11)
An12 = lm(HData$FDiff ~ HData$NBI)
anova(An12)
Flower = group_by(Dat, Tree.ID, Flower)
Flower = summarise(Flower, Chl = mean(Chl))
Flower = Flower[c(1,2)]
HData = merge(HData, Flower, by.x = "Tree.ID", all = TRUE)
Flower = HData
Flower = Flower[c(1:3,7:10,23:26)]
Flower = Flower[-c(144,148:150,152:156,159,161:168,170:179),]
ggplot(Flower) + aes(x = Flower, y = F8) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Height") + xlab("Flower Status") + ggtitle("Adjusted Column Heights 2018") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Flower$F8), colour = "red") +stat_summary(fun.y=mean, colour="green", geom="point", shape=18, size=3)
ggplot(Flower) + aes(x = Flower, y = F9) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Height (cm)") + xlab("Flower Status") + ggtitle("Adjusted Column Heights 2019") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Flower$F9), colour = "red") +stat_summary(fun.y=mean, colour="green", geom="point", shape=18, size=3)
ggplot(Flower) + aes(x = Flower, y = FDiff) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Height (cm)") + xlab("Flower Status") + ggtitle("Adjusted Column Difference") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Flower$FDiff), colour = "red") +stat_summary(fun.y=mean, colour="green", geom="point", shape=18, size=3)
FH8 = lm(Flower$F8 ~ Flower$Flower)
anova(FH8)
summary(FH8)
FH9 = lm(Flower$F9 ~ Flower$Flower)
anova(FH9)
summary(FH9)
FD = lm(Flower$FDiff ~ Flower$Flower)
anova(FD)
summary(FD)
summary(mod3)$r.squared
summary(mod3)
summary(mod3)$r.squared
summary(mod3)
summary(mod3)$r.squared
summary(mod8)$r.squared
anova(mod8)
summary(mod5)$r.squared
summary(mod7)$r.squared
summary(mod6)$r.squared
#Binding parents into single dataset
Parent <- rbind(EC201,EC103)
#Anthocyanin
ParAnth = summary(Parent$Anth)$r.squared
#Anthocyanin
summary(Parent$Anth)$r.squared
#Binding parents into single dataset
Parent <- rbind(EC201,EC103)
#Anthocyanin
ParAnth = summary(Parent$Anth)
#Chlorophyll
ParChl = summary(Parent$Chl)
#Flavonol
ParFlav = summary(Parent$Flav)
#NBI
ParNBI = summary(Parent$NBI)
as.table(rbind(ParAnth,ParChl,ParFlav,ParNBI))
summary(lm(Parent$Anth ~ Parent$Tree.ID))$r.squared
summary(FAA)$r.squared
summary(FAA)$r.squared
#Chlorophyll F1 Comparison
FBC <- ggplot(F1) + aes(x = Tree.ID, y = Chl,) + geom_boxplot(colour = "turquoise4") + ylab("Chlorophyll Measure") + xlab("F1") + ggtitle("Chlorophyll of F1 Samples") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$Chl), colour = "orchid3");FBC
#Chl Mean Plot
FMC <-ggplot(F12) +aes(x = Tree.ID, y = Chl) + geom_point(colour = "turquoise3") +geom_hline(yintercept = mean(F12$Chl), colour = "orchid3")+ ylab("Chlorophyll") + xlab("Tree ID") + ggtitle("Chlorophyll of F1 Samples")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))
#Histogram of Measurement Distribution
FHC <-ggplot(F12) +aes(Chl) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Chlorophyll") + ggtitle("Chlorophyll Distribution of F1 Trees") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
#Display Plots
grid.arrange(FMC,FHC)
#Chlorophyll ANOVA
FAC = lm(F1$Chl ~ F1$Tree.ID)
anova(FAC)
summary(FAC)$r.squared
summary(FAF);r.squared
#Flavonol F1 Comparison
FBF <- ggplot(F1) + aes(x = Tree.ID, y = Flav,) + geom_boxplot(colour = "turquoise4") + ylab("Flavonol Measure") + xlab("F1") + ggtitle("Flavonol of F1 Samples") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$Flav), colour = "orchid3");FBF
#Flav Mean Plot
FMF <-ggplot(F12) +aes(x = Tree.ID, y = Flav) + geom_point(colour = "turquoise3") +geom_hline(yintercept = mean(F12$Flav), colour = "orchid3")+ ylab("Flavonol") + xlab("Tree ID") + ggtitle("Flavonol of F1 Samples")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))
#Histogram of Measurement Distribution
FHF <-ggplot(F12) +aes(Flav) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Flavonol") + ggtitle("Flavonol Distribution of F1 Trees") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
#Display Plots
grid.arrange(FMF,FHF)
#Flavonol ANOVA
FAF = lm(F1$Flav ~ F1$Tree.ID)
anova(FAF)
summary(FAF);r.squared
summary(FAF)$r.squared
summary(HAA)$r.squared
summary(HCA)$r.squared
summary(HFA)$r.squared
summary(HFA)$coefficients[,4]
anova(HFA)
summary(HFA)$coefficients[,4]
plot(summary(HFA)$r.squared)
plot(summary(HFA)$coefficients[,4])
#Chlorophyll ANOVA
HCA = lm(F1$Chl ~ F1$Height)
anova(HCA)
summary(HCA)$r.squared
#Flavonol ANOVA
HFA = lm(F1$Flav ~ F1$Height)
anova(HFA)
summary(HFA)$r.squared
plot(summary(HFA)$coefficients[,4])
summary(HFA)$coefficients[,4]
FlavCo = summary(HFA)$r.squared
NBICo = summary(HNA)$r.squared
B = rbind(FlavCo,NBICo)
B
B = cbind(FlavCo,NBICo)
B
B = merge(FlavCo,NBICo, by.all = TRUE)
B
FlavCo = summary(HFA)$r.squared
FlavCo
FlavCo = summary(HFA)$coefficients[,4]
NBICo = summary(HNA)$r.squared
B = merge(FlavCo,NBICo, by.all = TRUE)
B
B = cbind(FlavCo,NBICo)
B
NBICo = summary(HNA)$coefficients[,4]
B = cbind(FlavCo,NBICo)
B
anova(HNA)
summary(AnRoA)$r.squared
AnRoA = lm(F1$Anth ~ F1$Row)
anova(AnRoA)
summary(AnRoA)$r.squared
AnRoC = lm(F1$Chl ~ F1$Row)
anova(AnRoC)
summary(AnRoC)$r.squared
AnRoF = lm(F1$Flav ~ F1$Row)
anova(AnRoF)
summary(AnRoF)$r.squared
AnRoN = lm(F1$NBI ~ F1$Row)
anova(AnRoN)
summary(AnRoN)$r.squared
#Anthocyanin ANOVA
CAA = lm(F1$Anth ~ F1$Column)
anova(CAA)
summary(CAA)$r.squared
#Chlorophyll ANOVA
CCA = lm(F1$Chl ~ F1$Column)
anova(CCA)
summary(CCA)$r.squared
#Flavonol ANOVA
CFA = lm(F1$Flav ~ F1$Column)
anova(CFA)
summary(CFA)$r.squared
#NBI ANOVA
CNA = lm(F1$NBI ~ F1$Column)
anova(CNA)
summary(CNA)$r.squared
#Anthocyanin
CRHA = lm(F1$Anth ~ F1$Height*F1$Column*F1$Row)
anova(CRHA)
summary(CRHA)$r.squared
#Remove insignificant variables
CRHA2 = lm(F1$Anth ~ F1$Height*F1$Row)
anova(CRHA2)
summary(CRHA2)$r.squared
#Chlorophyll
CRHC = lm(F1$Chl ~ F1$Height*F1$Column*F1$Row)
anova(CRHC)
summary(CRHC)$r.squared
#Remove insignificant variables
CRHC2 = lm(F1$Chl ~ F1$Height*F1$Row)
anova(CRHC2)
summary(CRHC2)$r.squared
#Further Remove insignificant variables
CRHC3 = lm(F1$Chl ~ F1$Row)
anova(CRHC3)
summary(CRHC3)$r.squared
#Flavonol
CRHF = lm(F1$Flav ~ F1$Height*F1$Column*F1$Row)
anova(CRHF)
summary(CRHF)$r.squared
#NBI
CRHN = lm(F1$NBI ~ F1$Height*F1$Column*F1$Row)
anova(CRHN)
summary(CRHN)$r.squared
#Remove insignificant variables
CRHM2 = lm(F1$NBI ~ F1$Row*F1$Column)
anova(CRHM2)
summary(CRHM2)$r.squared
#Anova Checks
AnAnth = lm(Dat$Anth5 ~ Dat$Height*Dat$Column*Dat$Row)
anova(AnAnth)
summary(AnAnth)$r.squared
AnChl = lm(Dat$Chl5 ~ Dat$Height*Dat$Column*Dat$Row)
anova(AnChl)
summary(AnChl)$r.squared
AnFlav = lm(Dat$Flav5 ~ Dat$Height*Dat$Column*Dat$Row)
anova(AnFlav)
summary(AnFlav)$r.squared
AnNBI = lm(Dat$NBI5 ~ Dat$Height*Dat$Column*Dat$Row)
anova(AnNBI)
summary(AnNBI)$r.squared
summary(AnthComp)$r.squared
AnthComp = lm(Anth5 ~ Chl5*Flav5*NBI5, data = Dat)
anova(AnthComp)
summary(AnthComp)$r.squared
ChlComp = lm(Chl5 ~ Anth5*Flav5*NBI5, data = Dat)
anova(ChlComp)
summary(ChlComp)$r.squared
FlavComp = lm(Flav5 ~ Anth5*Chl5*NBI5, data = Dat)
anova(FlavComp)
summary(FlavComp)$r.squared
NBIComp = lm(NBI5 ~ Anth5*Chl5*Flav5, data = Dat)
anova(NBIComp)
summary(NBIComp)$r.squared
knitr::opts_chunk$set(echo = TRUE)
FBA2
FBA2
FBC2
FBF2
FBN2
FHA@
FHC2
FHA2
FHC2
grid.arrange(FHA2,FBA2,FMC2, ncol=3)
grid.arrange(FHA2,FBA2,FMC2, ncol=1)
grid.arrange(FHA2,FBA2,FMC2, ncol=2)
grid.arrange(FHA2,FBA2,FMA2, ncol=2)
grid.arrange(FHC2,FBC2,FMC2, ncol=2)
grid.arrange(FHF2,FBF2,FMF2, ncol=2)
grid.arrange(FHN2,FBN2,FMN2, ncol=2)
setwd("~/leafy-green")
VieW(HData)
View(HData)
write.xlsx(HData, "FData.xlsx", sheetName = "Final")
SData = read.xlsx("FData.xlsx", sheetName = "Final")
knitr::opts_chunk$set(echo = F,cache = F)
library(xlsx)
library(ggplot2)
library(gplots)
library(gridExtra)
library(corrplot)
library(dplyr)
library(png)
library(grid)
library(heatmaply)
SData = read.xlsx("FData.xlsx", sheetName = "Final")
ggplot(SData) + aes(x = Tree.ID, y = Anth5) + geom_boxplot(colour = "turquoise4") + ylab("Anthocyanin Measure") + xlab("F1") + ggtitle("F1 Anth After Correction") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$Anth5), colour = "orchid3")
ggplot(SData) + aes(x = Tree.ID, y = Anth) + geom_boxplot(colour = "turquoise4") + ylab("Anthocyanin Measure") + xlab("F1") + ggtitle("F1 Anth After Correction") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(SData$Anth), colour = "orchid3")
AF<- lm(Dat$Anth5 ~ Dat$Flower)
anova(AF)
summary(AF)$r.squared
CF<- lm(Dat$Chl5 ~ Dat$Flower)
anova(CF)
summary(CF)$r.squared
FF<- lm(Dat$Flav5 ~ Dat$Flower)
anova(FF)
summary(FF)$r.squared
NF<- lm(Dat$NBI5 ~ Dat$Flower)
anova(NF)
summary(NF)$r.squared
H08A = lm(H089$Anth ~ H089$Height08)
anova(H08A)
summary(H08A)$r.squared
H08C = lm(H089$Chl ~ H089$Height08)
anova(H08C)
summary(H08C)$r.squared
H08F = lm(H089$Flav ~ H089$Height08)
anova(H08F)
summary(H08F)$r.squared
H08N = lm(H089$NBI ~ H089$Height08)
anova(H08N)
summary(H08N)$r.squared
summary(H09A)$r.squared
