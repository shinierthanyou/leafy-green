AnRoA = lm(F1$Anth ~ F1$Row)
anova(AnRoA)
AnRoC = lm(F1$Chl ~ F1$Row)
anova(AnRoC)
AnRoF = lm(F1$Flav ~ F1$Row)
anova(AnRoF)
AnRoN = lm(F1$NBI ~ F1$Row)
anova(AnRoN)
DatC = summarise(DatC, CChl = mean(Chl, na.rm = T),CFlav = mean(Flav,na.rm = T), CNBI = mean(NBI,na.rm = T))
#Column Mean
DatC = group_by(Dat, Column)
DatC = summarise(DatC, CChl = mean(Chl, na.rm = T),CFlav = mean(Flav,na.rm = T), CNBI = mean(NBI,na.rm = T))
#Add Height Mean to Data
Dat =merge(Dat, DatC, by.x = "Column")
#Histogram
RoHA2 <-ggplot(Dat) +aes(Anth) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Anthocyanin") + ggtitle("Anthocyanin Distribution of F1 Rows After Correction") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
grid.arrange(RoHA,RoHA2)
#Histogram
RoHA2 <-ggplot(Dat) +aes(Anth4) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Anthocyanin") + ggtitle("Anthocyanin Distribution of F1 Rows After Correction") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
grid.arrange(RoHA,RoHA2)
Dat = F1
#Identifying outliers outside
OBA <-boxplot(Dat$Anth,range = 3.5, plot = F)$out
OBC <-boxplot(Dat$Chl,range = 3, plot = F)$out
OBF <-boxplot(Dat$Flav,range = 3, plot = F)$out
OBN <-boxplot(Dat$NBI,range = 3,plot=F)$out
#Isolating outliers exceeding
OA = Dat[which(Dat$Anth %in% OBA),];OA
OC = Dat[which(Dat$Anth %in% OBC),];OC
OF = Dat[which(Dat$Anth %in% OBF),];OF
ON = Dat[which(Dat$Anth %in% OBN),];ON
Dat <- Dat[-which(Dat$Anth %in% OBA),]
DATG <- ggplot(F1) + aes(x = Tree.ID, y = Anth,) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Anth") + xlab("Tree ID") + ggtitle("Anthocyanin Raw Data") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$Anth))
DATG2 <- ggplot(Dat) + aes(x = Tree.ID, y = Anth,) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Anth") + xlab("Tree ID") + ggtitle("Anthocyanin Outliers Removed") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$Anth))
grid.arrange(DATG,DATG2)
#Total Mean
Dat$ATmean = mean(Dat$Anth)
Dat$CTmean = mean(Dat$Chl)
Dat$FTmean = mean(Dat$Flav)
Dat$NTmean = mean(Dat$NBI)
#Remove Total Mean
Dat$Anth2 = Dat$Anth - Dat$ATmean
Dat$Chl2 = Dat$Chl - Dat$CTmean
Dat$Flav2 = Dat$Flav - Dat$FTmean
Dat$NBI2 = Dat$NBI - Dat$NTmean
#Height Mean for Anth and Flav
DatH = group_by(Dat, Height)
DatH = summarise(DatH, HAnth = mean(Anth, na.rm = T), HFlav = mean(Flav,na.rm = T))
#Add Height Mean to Data
Dat =merge(Dat, DatH, by.x = "Height")
#Calculate Height Mean Deviation from Total Mean
Dat$ATH <- Dat$ATmean - Dat$HAnth
Dat$FTH = Dat$FTmean - Dat$HFlav
#Controlling for Height Anth and Flav
Dat$Anth3 = Dat$Anth2 + Dat$ATH
Dat$Flav3 = Dat$Flav2 + Dat$FTH
#Column Mean for Chl, Flav,NBI
DatC = group_by(Dat, Column)
DatC = summarise(DatC, CChl = mean(Chl, na.rm = T),CFlav = mean(Flav,na.rm = T), CNBI = mean(NBI,na.rm = T))
#Add Height Mean to Data
Dat =merge(Dat, DatC, by.x = "Column")
#Calculate Height Mean Deviation from Total Mean
Dat$CTH = Dat$CTmean - Dat$CChl
Dat$FTH = Dat$FTmean - Dat$CFlav
Dat$NTH = Dat$NTmean - Dat$CNBI
#Controlling for Column Chl, Flav and NBI
Dat$Chl3 = Dat$Chl2 + Dat$CTH
Dat$Flav4 = Dat$Flav3 + Dat$FTH
Dat$NBI3 = Dat$NBI2 + Dat$NTH
#Row Mean for Anth, Chl, Flav and and NBI
DatR = group_by(Dat, Row)
DatR = summarise(DatR, RAnth = mean(Anth,na.rm = T),RChl = mean(Chl,na.rm = T), RFlav = mean(Flav,na.rm = T), RNBI = mean(NBI,na.rm = T))
#Add Row Mean to Data
Dat =merge(Dat, DatR, by.x = "Row")
#Calculate Row Mean Deviation from Total Mean
Dat$ATR = Dat$ATmean - Dat$RAnth
Dat$CTR = Dat$CTmean - Dat$RChl
Dat$FTR = Dat$FTmean - Dat$RFlav
Dat$NTR = Dat$NTmean - Dat$RNBI
#Controlling for Row in Anth, Chl, Flav and NBI
Dat$Anth4 = Dat$Anth3 + Dat$ATR
Dat$Chl4 = Dat$Chl3 + Dat$CTR
Dat$Flav5 = Dat$Flav4 + Dat$FTR
Dat$NBI4 = Dat$NBI3 + Dat$NTR
#Tree ID Summary
Dat12 = group_by(Dat,Tree.ID)
Dat12 = summarise(Dat12,Chl = mean(Chl3,na.rm=T), NBI = mean(NBI4, ra.nm = T), Anth = mean(Anth4, na.rm=T),Flav = mean(Flav5,na.rm =T))
#Height Summary
Dat13 = group_by(Dat,Height)
Dat13 = summarise(Dat13, Anth = mean(Anth4, na.rm = T), Chl = mean(Chl3, na.rm = T), Flav = mean(Flav5, na.rm = T), NBI = mean(NBI4, na.rm = T))
#Row Summary
Dat14 = group_by(Dat, Row)
Dat14 = summarise(Dat14, Anth = mean(Anth4, na.rm = T), Chl = mean(Chl3, na.rm = T), Flav = mean(Flav5, na.rm = T), NBI = mean(NBI4, na.rm = T))
#Column Summary
Dat15 = group_by(Dat, Column)
Dat15 = summarise(Dat15, Anth = mean(Anth4, na.rm = T), Chl = mean(Chl3, na.rm = T), Flav = mean(Flav5, na.rm = T), NBI = mean(NBI4, na.rm = T))
#Anthocyanin Boxplot
FBA2 = ggplot(Dat) + aes(x = Tree.ID, y = Anth4,) + geom_boxplot(colour = "turquoise4") + ylab("Anthocyanin Measure") + xlab("F1") + ggtitle("F1 Anth After Correction") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$Anth4), colour = "orchid3")
grid.arrange(FBA,FBA2)
#Anth Mean Plot
FMA2 <-ggplot(Dat12) +aes(x = Tree.ID, y = Anth) + geom_point(colour = "turquoise3") +geom_hline(yintercept = mean(Dat12$Anth), colour = "orchid3")+ ylab("Anthocyanin") + xlab("Tree ID") + ggtitle("Anthocyanin of F1 Samples")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))
grid.arrange(FMA,FMA2)
#Histogram of Measurement Distribution
FHA2 <-ggplot(Dat12) +aes(Anth) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Anthocyanin") + ggtitle("Anthocyanin Distribution of F1 Trees After Correction") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
grid.arrange(FHA,FHA2)
#Height Boxplot
HBA2 <- ggplot(Dat) + aes(x = Height, y = Anth4,) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Anthocyanin Measure") + xlab("Height") + ggtitle("Anth Height After Correction") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$Anth4))
grid.arrange(HBA,HBA2, ncol = 2)
#Height Histogram
HHA2 <-ggplot(Dat) +aes(Anth4,color=Height, fill=Height) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Anthocyanin") + ggtitle("Anthocyanin by Height After Correction") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
grid.arrange(HHA,HHA2)
#Height Means
HMA2 <-ggplot(Dat) +aes(x = Tree.ID, y = Anth4, colour = Height, fill = Height) + geom_point() +geom_hline(yintercept = mean(Dat$Anth4), colour = "dodgerblue1")+ ylab("Anthocyanin") + xlab("Tree ID") + ggtitle("Anthocyanin Height Measures After Correction")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))
grid.arrange(HMA,HMA2)
#Row
#Boxplot Anthocyanin by Row
RoBA2 <- ggplot(Dat) + aes(x = Row, y = Anth4) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Anthocyanin Measure") + xlab("Row") + ggtitle("Anthocyanin by Row After Correction") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$Anth4), colour = "lightpink")
grid.arrange(RoBA,RoBA2)
#Mean Distribution
RoMA2 <-ggplot(Dat14) +aes(x = Row, y = Anth) + geom_point(colour = "turquoise3") +geom_hline(yintercept = mean(Dat14$Anth), colour = "orchid3")+ ylab("Anth") + xlab("Tree ID") + ggtitle("Anthocyanin Row Means After Correction")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))
grid.arrange(RoMA,RoMA2)
#Histogram
RoHA2 <-ggplot(Dat) +aes(Anth4) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Anthocyanin") + ggtitle("Anthocyanin Distribution of F1 Rows After Correction") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
grid.arrange(RoHA,RoHA2)
#Column
#Boxplot Anthocyanin Column
CBA2 <- ggplot(Dat) + aes(x = Column, y = Anth4) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Anthocyanin Measure") + xlab("Column") + ggtitle("Anth Column After Correction") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$Anth4))
grid.arrange(CBA,CBA2, ncol=2)
#Histogram
RoHA2 <-ggplot(Dat14) +aes(Anth) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Anthocyanin") + ggtitle("Anthocyanin Distribution of F1 Rows After Correction") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
grid.arrange(RoHA,RoHA2)
View(Dat14)
#Column
#Boxplot Anthocyanin Column
CBA2 <- ggplot(Dat) + aes(x = Column, y = Anth4) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Anthocyanin Measure") + xlab("Column") + ggtitle("Anth Column After Correction") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$Anth4))
View(Dat14)
Dat = F1
#Identifying outliers outside
OBA <-boxplot(Dat$Anth,range = 3.5, plot = F)$out
OBC <-boxplot(Dat$Chl,range = 3, plot = F)$out
OBF <-boxplot(Dat$Flav,range = 3, plot = F)$out
OBN <-boxplot(Dat$NBI,range = 3,plot=F)$out
#Isolating outliers exceeding
OA = Dat[which(Dat$Anth %in% OBA),];OA
OC = Dat[which(Dat$Anth %in% OBC),];OC
OF = Dat[which(Dat$Anth %in% OBF),];OF
ON = Dat[which(Dat$Anth %in% OBN),];ON
Dat <- Dat[-which(Dat$Anth %in% OBA),]
DATG <- ggplot(F1) + aes(x = Tree.ID, y = Anth,) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Anth") + xlab("Tree ID") + ggtitle("Anthocyanin Raw Data") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$Anth))
DATG2 <- ggplot(Dat) + aes(x = Tree.ID, y = Anth,) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Anth") + xlab("Tree ID") + ggtitle("Anthocyanin Outliers Removed") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$Anth))
grid.arrange(DATG,DATG2)
#Total Mean
Dat$ATmean = mean(Dat$Anth)
Dat$CTmean = mean(Dat$Chl)
Dat$FTmean = mean(Dat$Flav)
Dat$NTmean = mean(Dat$NBI)
#Remove Total Mean
Dat$Anth2 = Dat$Anth - Dat$ATmean
Dat$Chl2 = Dat$Chl - Dat$CTmean
Dat$Flav2 = Dat$Flav - Dat$FTmean
Dat$NBI2 = Dat$NBI - Dat$NTmean
#Height Mean for Anth and Flav
DatH = group_by(Dat, Height)
DatH = summarise(DatH, HAnth = mean(Anth, na.rm = T), HFlav = mean(Flav,na.rm = T))
#Add Height Mean to Data
Dat =merge(Dat, DatH, by.x = "Height")
#Calculate Height Mean Deviation from Total Mean
Dat$ATH = Dat$ATmean - Dat$HAnth
Dat$FTH = Dat$FTmean - Dat$HFlav
#Controlling for Height Anth and Flav
Dat$Anth3 = Dat$Anth2 + Dat$ATH
Dat$Flav3 = Dat$Flav2 + Dat$FTH
#Column Mean for Chl, Flav,NBI
DatC = group_by(Dat, Column)
DatC = summarise(DatC, CChl = mean(Chl, na.rm = T),CFlav = mean(Flav,na.rm = T), CNBI = mean(NBI,na.rm = T))
#Add Height Mean to Data
Dat =merge(Dat, DatC, by.x = "Column")
#Calculate Height Mean Deviation from Total Mean
Dat$CTH = Dat$CTmean - Dat$CChl
Dat$FTH = Dat$FTmean - Dat$CFlav
Dat$NTH = Dat$NTmean - Dat$CNBI
#Controlling for Column Chl, Flav and NBI
Dat$Chl3 = Dat$Chl2 + Dat$CTH
Dat$Flav4 = Dat$Flav3 + Dat$FTH
Dat$NBI3 = Dat$NBI2 + Dat$NTH
#Row Mean for Anth, Chl, Flav and and NBI
DatR = group_by(Dat, Row)
DatR = summarise(DatR, RAnth = mean(Anth,na.rm = T),RChl = mean(Chl,na.rm = T), RFlav = mean(Flav,na.rm = T), RNBI = mean(NBI,na.rm = T))
#Add Row Mean to Data
Dat =merge(Dat, DatR, by.x = "Row")
#Calculate Row Mean Deviation from Total Mean
Dat$ATR = Dat$ATmean - Dat$RAnth
Dat$CTR = Dat$CTmean - Dat$RChl
Dat$FTR = Dat$FTmean - Dat$RFlav
Dat$NTR = Dat$NTmean - Dat$RNBI
#Controlling for Row in Anth, Chl, Flav and NBI
Dat$Anth4 = Dat$Anth3 + Dat$ATR
Dat$Chl4 = Dat$Chl3 + Dat$CTR
Dat$Flav5 = Dat$Flav4 + Dat$FTR
Dat$NBI4 = Dat$NBI3 + Dat$NTR
#Anova Checks
AnAnth = lm(Dat$Anth4 ~ Dat$Height*Dat$Column*Dat$Row)
anova(AnAnth)
AnChl = lm(Dat$Chl3 ~ Dat$Height*Dat$Column*Dat$Row)
anova(AnChl)
AnFlav = lm(Dat$Flav5 ~ Dat$Height*Dat$Column*Dat$Row)
anova(AnFlav)
AnNBI = lm(Dat$NBI4 ~ Dat$Height*Dat$Column*Dat$Row)
anova(AnNBI)
#Anthocyanin Boxplot
FBA2 = ggplot(Dat) + aes(x = Tree.ID, y = Anth4,) + geom_boxplot(colour = "turquoise4") + ylab("Anthocyanin Measure") + xlab("F1") + ggtitle("F1 Anth After Correction") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$Anth4), colour = "orchid3")
grid.arrange(FBA,FBA2)
#Anth Mean Plot
FMA2 <-ggplot(Dat12) +aes(x = Tree.ID, y = Anth) + geom_point(colour = "turquoise3") +geom_hline(yintercept = mean(Dat12$Anth), colour = "orchid3")+ ylab("Anthocyanin") + xlab("Tree ID") + ggtitle("Anthocyanin of F1 Samples")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))
grid.arrange(FMA,FMA2)
#Histogram of Measurement Distribution
FHA2 <-ggplot(Dat12) +aes(Anth) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Anthocyanin") + ggtitle("Anthocyanin Distribution of F1 Trees After Correction") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
grid.arrange(FHA,FHA2)
#Height Boxplot
HBA2 <- ggplot(Dat) + aes(x = Height, y = Anth4,) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Anthocyanin Measure") + xlab("Height") + ggtitle("Anth Height After Correction") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$Anth4))
grid.arrange(HBA,HBA2, ncol = 2)
#Height Histogram
HHA2 <-ggplot(Dat) +aes(Anth4,color=Height, fill=Height) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Anthocyanin") + ggtitle("Anthocyanin by Height After Correction") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
grid.arrange(HHA,HHA2)
#Height Means
HMA2 <-ggplot(Dat) +aes(x = Tree.ID, y = Anth4, colour = Height, fill = Height) + geom_point() +geom_hline(yintercept = mean(Dat$Anth4), colour = "dodgerblue1")+ ylab("Anthocyanin") + xlab("Tree ID") + ggtitle("Anthocyanin Height Measures After Correction")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))
grid.arrange(HMA,HMA2)
#Row
#Boxplot Anthocyanin by Row
RoBA2 <- ggplot(Dat) + aes(x = Row, y = Anth4) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Anthocyanin Measure") + xlab("Row") + ggtitle("Anthocyanin by Row After Correction") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$Anth4), colour = "lightpink")
grid.arrange(RoBA,RoBA2)
#Mean Distribution
RoMA2 <-ggplot(Dat14) +aes(x = Row, y = Anth) + geom_point(colour = "turquoise3") +geom_hline(yintercept = mean(Dat14$Anth), colour = "orchid3")+ ylab("Anth") + xlab("Tree ID") + ggtitle("Anthocyanin Row Means After Correction")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))
grid.arrange(RoMA,RoMA2)
#Histogram
RoHA2 <-ggplot(Dat14) +aes(Anth) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Anthocyanin") + ggtitle("Anthocyanin Distribution of F1 Rows After Correction") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
grid.arrange(RoHA,RoHA2)
#Column
#Boxplot Anthocyanin Column
CBA2 <- ggplot(Dat) + aes(x = Column, y = Anth4) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Anthocyanin Measure") + xlab("Column") + ggtitle("Anth Column After Correction") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$Anth4))
grid.arrange(CBA,CBA2, ncol=2)
#Anova Checks
AnAnth = lm(Dat$Anth4 ~ Dat$Height*Dat$Column*Dat$Row)
anova(AnAnth)
AnChl = lm(Dat$Chl4 ~ Dat$Height*Dat$Column*Dat$Row)
anova(AnChl)
AnFlav = lm(Dat$Flav5 ~ Dat$Height*Dat$Column*Dat$Row)
anova(AnFlav)
AnNBI = lm(Dat$NBI4 ~ Dat$Height*Dat$Column*Dat$Row)
anova(AnNBI)
Dat = F1
#Identifying outliers outside
OBA <-boxplot(Dat$Anth,range = 3.5, plot = F)$out
OBC <-boxplot(Dat$Chl,range = 3, plot = F)$out
OBF <-boxplot(Dat$Flav,range = 3, plot = F)$out
OBN <-boxplot(Dat$NBI,range = 3,plot=F)$out
#Isolating outliers exceeding
OA = Dat[which(Dat$Anth %in% OBA),];OA
OC = Dat[which(Dat$Anth %in% OBC),];OC
OF = Dat[which(Dat$Anth %in% OBF),];OF
ON = Dat[which(Dat$Anth %in% OBN),];ON
Dat <- Dat[-which(Dat$Anth %in% OBA),]
DATG <- ggplot(F1) + aes(x = Tree.ID, y = Anth,) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Anth") + xlab("Tree ID") + ggtitle("Anthocyanin Raw Data") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$Anth))
DATG2 <- ggplot(Dat) + aes(x = Tree.ID, y = Anth,) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Anth") + xlab("Tree ID") + ggtitle("Anthocyanin Outliers Removed") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$Anth))
grid.arrange(DATG,DATG2)
#Total Mean
Dat$ATmean = mean(Dat$Anth)
Dat$CTmean = mean(Dat$Chl)
Dat$FTmean = mean(Dat$Flav)
Dat$NTmean = mean(Dat$NBI)
#Remove Total Mean
Dat$Anth2 = Dat$Anth - Dat$ATmean
Dat$Chl2 = Dat$Chl - Dat$CTmean
Dat$Flav2 = Dat$Flav - Dat$FTmean
Dat$NBI2 = Dat$NBI - Dat$NTmean
#Height Mean for Anth and Flav
DatH = group_by(Dat, Height)
DatH = summarise(DatH, HAnth = mean(Anth, na.rm = T), CChl = mean(Chl, na.rm =T), HFlav = mean(Flav,na.rm = T), HNBI = mean(NBI, na.rm = T))
#Add Height Mean to Data
Dat =merge(Dat, DatH, by.x = "Height")
#Calculate Height Mean Deviation from Total Mean
Dat$ATH = Dat$ATmean - Dat$HAnth
Dat$CTH = Dat$CTmean - Dat$HChl
Dat = F1
#Identifying outliers outside
OBA <-boxplot(Dat$Anth,range = 3.5, plot = F)$out
OBC <-boxplot(Dat$Chl,range = 3, plot = F)$out
OBF <-boxplot(Dat$Flav,range = 3, plot = F)$out
OBN <-boxplot(Dat$NBI,range = 3,plot=F)$out
#Isolating outliers exceeding
OA = Dat[which(Dat$Anth %in% OBA),];OA
OC = Dat[which(Dat$Anth %in% OBC),];OC
OF = Dat[which(Dat$Anth %in% OBF),];OF
ON = Dat[which(Dat$Anth %in% OBN),];ON
Dat <- Dat[-which(Dat$Anth %in% OBA),]
DATG <- ggplot(F1) + aes(x = Tree.ID, y = Anth,) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Anth") + xlab("Tree ID") + ggtitle("Anthocyanin Raw Data") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$Anth))
DATG2 <- ggplot(Dat) + aes(x = Tree.ID, y = Anth,) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Anth") + xlab("Tree ID") + ggtitle("Anthocyanin Outliers Removed") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$Anth))
grid.arrange(DATG,DATG2)
#Total Mean
Dat$ATmean = mean(Dat$Anth)
Dat$CTmean = mean(Dat$Chl)
Dat$FTmean = mean(Dat$Flav)
Dat$NTmean = mean(Dat$NBI)
#Remove Total Mean
Dat$Anth2 = Dat$Anth - Dat$ATmean
Dat$Chl2 = Dat$Chl - Dat$CTmean
Dat$Flav2 = Dat$Flav - Dat$FTmean
Dat$NBI2 = Dat$NBI - Dat$NTmean
#Height Mean for Anth and Flav
DatH = group_by(Dat, Height)
DatH = summarise(DatH, HAnth = mean(Anth, na.rm = T), HChl = mean(Chl, na.rm =T), HFlav = mean(Flav,na.rm = T), HNBI = mean(NBI, na.rm = T))
#Add Height Mean to Data
Dat =merge(Dat, DatH, by.x = "Height")
#Calculate Height Mean Deviation from Total Mean
Dat$ATH = Dat$ATmean - Dat$HAnth
Dat$CTH = Dat$CTmean - Dat$HChl
Dat$FTH = Dat$FTmean - Dat$HFlav
Dat$NTH = Dat$NTmean - Dat$HNBI
#Controlling for Height Anth and Flav
Dat$Anth3 = Dat$Anth2 + Dat$ATH
Dat$Chl3 = Dat$Chl2 + Dat$CTH
Dat$Flav3 = Dat$Flav2 + Dat$FTH
Dat$NBI3 = Dat$NBI2 + Dat$NTH
#Column Mean for Chl, Flav,NBI
DatC = group_by(Dat, Column)
DatC = summarise(DatC, CAnth = mean(Anth, na.rm = T), CChl = mean(Chl, na.rm = T) ,CFlav = mean(Flav,na.rm = T), CNBI = mean(NBI,na.rm = T))
#Add Column Mean to Data
Dat =merge(Dat, DatC, by.x = "Column")
#Calculate Column Mean Deviation from Total Mean
Dat$ATC = Dat$ATmean - Dat$CAnth
Dat$CTC = Dat$CTmean - Dat$CChl
Dat$FTC = Dat$FTmean - Dat$CFlav
Dat$NTC = Dat$NTmean - Dat$CNBI
#Controlling for Column Chl, Flav and NBI
Dat$Anth4 = Dat$Anth3 + Dat$ATC
Dat$Chl4 = Dat$Chl2 + Dat$CTC
Dat$Flav4 = Dat$Flav3 + Dat$FTC
Dat$NBI3 = Dat$NBI2 + Dat$NTC
#Row Mean for Anth, Chl, Flav and and NBI
DatR = group_by(Dat, Row)
DatR = summarise(DatR, RAnth = mean(Anth,na.rm = T),RChl = mean(Chl,na.rm = T), RFlav = mean(Flav,na.rm = T), RNBI = mean(NBI,na.rm = T))
#Add Row Mean to Data
Dat =merge(Dat, DatR, by.x = "Row")
#Calculate Row Mean Deviation from Total Mean
Dat$ATR = Dat$ATmean - Dat$RAnth
Dat$CTR = Dat$CTmean - Dat$RChl
Dat$FTR = Dat$FTmean - Dat$RFlav
Dat$NTR = Dat$NTmean - Dat$RNBI
#Controlling for Row in Anth, Chl, Flav and NBI
Dat$Anth5 = Dat$Anth4 + Dat$ATR
Dat$Chl5 = Dat$Chl4 + Dat$CTR
Dat$Flav5 = Dat$Flav4 + Dat$FTR
Dat$NBI5 = Dat$NBI4 + Dat$NTR
Dat = F1
#Identifying outliers outside
OBA <-boxplot(Dat$Anth,range = 3.5, plot = F)$out
OBC <-boxplot(Dat$Chl,range = 3, plot = F)$out
OBF <-boxplot(Dat$Flav,range = 3, plot = F)$out
OBN <-boxplot(Dat$NBI,range = 3,plot=F)$out
#Isolating outliers exceeding
OA = Dat[which(Dat$Anth %in% OBA),];OA
OC = Dat[which(Dat$Anth %in% OBC),];OC
OF = Dat[which(Dat$Anth %in% OBF),];OF
ON = Dat[which(Dat$Anth %in% OBN),];ON
Dat <- Dat[-which(Dat$Anth %in% OBA),]
DATG <- ggplot(F1) + aes(x = Tree.ID, y = Anth,) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Anth") + xlab("Tree ID") + ggtitle("Anthocyanin Raw Data") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$Anth))
DATG2 <- ggplot(Dat) + aes(x = Tree.ID, y = Anth,) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Anth") + xlab("Tree ID") + ggtitle("Anthocyanin Outliers Removed") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$Anth))
grid.arrange(DATG,DATG2)
#Total Mean
Dat$ATmean = mean(Dat$Anth)
Dat$CTmean = mean(Dat$Chl)
Dat$FTmean = mean(Dat$Flav)
Dat$NTmean = mean(Dat$NBI)
#Remove Total Mean
Dat$Anth2 = Dat$Anth - Dat$ATmean
Dat$Chl2 = Dat$Chl - Dat$CTmean
Dat$Flav2 = Dat$Flav - Dat$FTmean
Dat$NBI2 = Dat$NBI - Dat$NTmean
#Height Mean for Anth and Flav
DatH = group_by(Dat, Height)
DatH = summarise(DatH, HAnth = mean(Anth, na.rm = T), HChl = mean(Chl, na.rm =T), HFlav = mean(Flav,na.rm = T), HNBI = mean(NBI, na.rm = T))
#Add Height Mean to Data
Dat =merge(Dat, DatH, by.x = "Height")
#Calculate Height Mean Deviation from Total Mean
Dat$ATH = Dat$ATmean - Dat$HAnth
Dat$CTH = Dat$CTmean - Dat$HChl
Dat$FTH = Dat$FTmean - Dat$HFlav
Dat$NTH = Dat$NTmean - Dat$HNBI
#Controlling for Height Anth and Flav
Dat$Anth3 = Dat$Anth2 + Dat$ATH
Dat$Chl3 = Dat$Chl2 + Dat$CTH
Dat$Flav3 = Dat$Flav2 + Dat$FTH
Dat$NBI3 = Dat$NBI2 + Dat$NTH
#Column Mean for Chl, Flav,NBI
DatC = group_by(Dat, Column)
DatC = summarise(DatC, CAnth = mean(Anth, na.rm = T), CChl = mean(Chl, na.rm = T) ,CFlav = mean(Flav,na.rm = T), CNBI = mean(NBI,na.rm = T))
#Add Column Mean to Data
Dat =merge(Dat, DatC, by.x = "Column")
#Calculate Column Mean Deviation from Total Mean
Dat$ATC = Dat$ATmean - Dat$CAnth
Dat$CTC = Dat$CTmean - Dat$CChl
Dat$FTC = Dat$FTmean - Dat$CFlav
Dat$NTC = Dat$NTmean - Dat$CNBI
#Controlling for Column Chl, Flav and NBI
Dat$Anth4 = Dat$Anth3 + Dat$ATC
Dat$Chl4 = Dat$Chl2 + Dat$CTC
Dat$Flav4 = Dat$Flav3 + Dat$FTC
Dat$NBI4 = Dat$NBI3 + Dat$NTC
#Row Mean for Anth, Chl, Flav and and NBI
DatR = group_by(Dat, Row)
DatR = summarise(DatR, RAnth = mean(Anth,na.rm = T),RChl = mean(Chl,na.rm = T), RFlav = mean(Flav,na.rm = T), RNBI = mean(NBI,na.rm = T))
#Add Row Mean to Data
Dat =merge(Dat, DatR, by.x = "Row")
#Calculate Row Mean Deviation from Total Mean
Dat$ATR = Dat$ATmean - Dat$RAnth
Dat$CTR = Dat$CTmean - Dat$RChl
Dat$FTR = Dat$FTmean - Dat$RFlav
Dat$NTR = Dat$NTmean - Dat$RNBI
#Controlling for Row in Anth, Chl, Flav and NBI
Dat$Anth5 = Dat$Anth4 + Dat$ATR
Dat$Chl5 = Dat$Chl4 + Dat$CTR
Dat$Flav5 = Dat$Flav4 + Dat$FTR
Dat$NBI5 = Dat$NBI4 + Dat$NTR
#Anova Checks
AnAnth = lm(Dat$Anth4 ~ Dat$Height*Dat$Column*Dat$Row)
anova(AnAnth)
AnChl = lm(Dat$Chl4 ~ Dat$Height*Dat$Column*Dat$Row)
anova(AnChl)
AnFlav = lm(Dat$Flav5 ~ Dat$Height*Dat$Column*Dat$Row)
anova(AnFlav)
AnNBI = lm(Dat$NBI4 ~ Dat$Height*Dat$Column*Dat$Row)
anova(AnNBI)
#Anova Checks
AnAnth = lm(Dat$Anth5 ~ Dat$Height*Dat$Column*Dat$Row)
anova(AnAnth)
AnChl = lm(Dat$Chl5 ~ Dat$Height*Dat$Column*Dat$Row)
anova(AnChl)
AnFlav = lm(Dat$Flav5 ~ Dat$Height*Dat$Column*Dat$Row)
anova(AnFlav)
AnNBI = lm(Dat$NBI5 ~ Dat$Height*Dat$Column*Dat$Row)
anova(AnNBI)
#Tree ID Summary
Dat12 = group_by(Dat,Tree.ID)
Dat12 = summarise(Dat12,Chl = mean(Chl5,na.rm=T), NBI = mean(NBI5, ra.nm = T), Anth = mean(Anth5, na.rm=T),Flav = mean(Flav5,na.rm =T))
#Height Summary
Dat13 = group_by(Dat,Height)
Dat13 = summarise(Dat13, Anth = mean(Anth5, na.rm = T), Chl = mean(Chl5, na.rm = T), Flav = mean(Flav5, na.rm = T), NBI = mean(NBI5, na.rm = T))
#Row Summary
Dat14 = group_by(Dat, Row)
Dat14 = summarise(Dat14, Anth = mean(Anth5, na.rm = T), Chl = mean(Chl5, na.rm = T), Flav = mean(Flav5, na.rm = T), NBI = mean(NBI5, na.rm = T))
#Column Summary
Dat15 = group_by(Dat, Column)
Dat15 = summarise(Dat15, Anth = mean(Anth5, na.rm = T), Chl = mean(Chl5, na.rm = T), Flav = mean(Flav5, na.rm = T), NBI = mean(NBI5, na.rm = T))
DatHM = group_by(Dat, Column, Row)
DatHM = summarise(DatHM, Anth = mean(Anth5,na.rm = T), Chl = mean(Chl5,na.rm = T), Flav = mean(Flav5,na.rm = T), NBI = mean(NBI5,na.rm = T))
write.xlsx(as.data.frame(DatHM), file = "DatHM.xlsx", sheetName ="Dat",col.names = T, row.names = F)
#New Heatmaps
#DatHM = group_by(Dat, Column, Row)
#DatHM = summarise(DatHM, Anth = mean(Anth5,na.rm = T), Chl = mean(Chl5,na.rm = T), Flav = mean(Flav5,na.rm = T), NBI = mean(NBI5,na.rm = T))
#write.xlsx(as.data.frame(DatHM), file = "DatHM.xlsx", sheetName ="Dat",col.names = T, row.names = F)
#Anthocyanin Heatmaps
AnthDoc <-read.xlsx("Anth.xlsx", sheetName = "Anth")
heatmaply(AnthDoc, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "Anth Before Correction")
AnthDoc2 <-read.xlsx("DatHM2.xlsx", sheetName = "Anth")
heatmaply(AnthDoc2, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "Anth After Correction")
#Chlorophyll Heatmaps
ChlDoc<-read.xlsx("Chl.xlsx", sheetName = "Chl")
heatmaply(ChlDoc, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "Chl Before Correction")
ChlDoc2 <-read.xlsx("DatHM2.xlsx", sheetName = "Chl")
heatmaply(ChlDoc2, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "Chl After Correction")
#Flavonol Heatmaps
FlavDoc<-read.xlsx("Flav.xlsx", sheetName = "Flav")
heatmaply(FlavDoc, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "Flav Before Correction")
FlavDoc2 <-read.xlsx("DatHM2.xlsx", sheetName = "Flav")
heatmaply(FlavDoc2, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "Flav After Correction")
#NBI Heatmaps
NBIDoc<-read.xlsx("NBI.xlsx", sheetName = "NBI")
heatmaply(NBIDoc, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "NBI Before Correction")
NBIDoc2 <-read.xlsx("DatHM2.xlsx", sheetName = "NBI")
NBIDoc2 = heatmaply(NBIDoc2, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "NBI After Correction");NBIDoc2
#Heatmaps
F1HM = group_by(F1, Column, Row)
F1HM = summarise(F1HM, Anth = mean(Anth,na.rm = T), Chl = mean(Chl,na.rm = T), Flav = mean(Flav,na.rm = T), NBI = mean(NBI,na.rm = T))
Write.xlsx(as.data.frame(F1HM), file = "F1HM.xlsx", sheetName ="F1",col.names = T, row.names = F)
write.xlsx(as.data.frame(F1HM), file = "F1HM.xlsx", sheetName ="F1",col.names = T, row.names = F)
#Heatmaps
#F1HM = group_by(F1, Column, Row)
#F1HM = summarise(F1HM, Anth = mean(Anth,na.rm = T), Chl = mean(Chl,na.rm = T), Flav = mean(Flav,na.rm = T), NBI = mean(NBI,na.rm = T))
#write.xlsx(as.data.frame(F1HM), file = "F1HM.xlsx", sheetName ="F1",col.names = T, row.names = F)
#DatHM = group_by(Dat, Column, Row)
#DatHM = summarise(DatHM, Anth = mean(Anth5,na.rm = T), Chl = mean(Chl5,na.rm = T), Flav = mean(Flav5,na.rm = T), NBI = mean(NBI5,na.rm = T))
#write.xlsx(as.data.frame(DatHM), file = "DatHM.xlsx", sheetName ="Dat",col.names = T, row.names = F)
#Anthocyanin Heatmaps
AnthDoc <-read.xlsx("F1HM2.xlsx", sheetName = "Anth")
heatmaply(AnthDoc, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "Anth Before Correction")
AnthDoc2 <-read.xlsx("F1HM2.xlsx", sheetName = "Anth")
heatmaply(AnthDoc2, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "Anth After Correction")
#Chlorophyll Heatmaps
ChlDoc<-read.xlsx("F1HM2.xlsx", sheetName = "Chl")
heatmaply(ChlDoc, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "Chl Before Correction")
ChlDoc2 <-read.xlsx("F1HM2.xlsx", sheetName = "Chl")
heatmaply(ChlDoc2, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "Chl After Correction")
#Flavonol Heatmaps
FlavDoc<-read.xlsx("Flav.xlsx", sheetName = "Flav")
heatmaply(FlavDoc, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "Flav Before Correction")
FlavDoc2 <-read.xlsx("DatHM2.xlsx", sheetName = "Flav")
heatmaply(FlavDoc2, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "Flav After Correction")
#NBI Heatmaps
NBIDoc<-read.xlsx("NBI.xlsx", sheetName = "NBI")
heatmaply(NBIDoc, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "NBI Before Correction")
NBIDoc2 <-read.xlsx("DatHM2.xlsx", sheetName = "NBI")
NBIDoc2 = heatmaply(NBIDoc2, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "NBI After Correction");NBIDoc2
