---
title: "ManukaAnalysis"
author: "Melissa Taane"
date: "06/05/2019"
output:
  html_document: default
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = F,cache = F)
library(xlsx)
library(ggplot2)
library(gplots)
library(gridExtra)
library(corrplot)
library(dplyr)
library(png)
library(grid)
library(heatmaply)
```


#### F1 Layout

Map indicates the layout of the F1 generation resulting from a cross between EC201 and EC103 parents. Column 1 is approximately lengthways facing north.

!["Map of F1 Trees"](Capture.png)

#### Height Diagram

Diagram indicates the areas of leaf collection regarding height.
Each Tree had 10 leaves collected, 3 from Low, 4 from Mid and 3 from High. The first leaf sampled was measured twice for replication comparison.

!["Diagram of leaf collection levels"](Tree.png)


#### Import and Arrange Data

"Full.xlsx" contains measurement information from sampling with the Dualex (https://www.force-a.com/en/capteurs-optiques-optical-sensors/dualex-scientific-chlorophyll-meter/), including;

+ Surface content of chlorophyll in ?g/cm? (Chl) 

+ Epidermal Flavoid content in absorbance units; Flavonol(Flav) and Anthocyanin(Anth) 

+ Nitrogen Balance Index status (NBI)

It also contains information about the block position, the leaf height information, and presense or absence of flowering

Sheet "Dup" contains only the samples that were replicated.

```{r Data Import, echo = T}
# Import Data Measures
Data <-read.xlsx("Full.xlsx", sheetName ="Full")
head(Data)
Data$Column = as.factor(Data$Column)
Data$Row = as.factor(Data$Row)

# Import Replicate Data
Dup <-read.xlsx("Full.xlsx", sheetName ="Dup")
head(Dup)

#Isolate Crimson Glory Outgroup
CG = Data[c(1:11),]

#Isolate East Cape 201 Parent
EC201 = Data[c(12:21),]

#Isolate East Cape 103 Parent
EC103 = Data[c(22:33),]

#Isolate Offspring from the Parental Cross
F1 = Data[c(34:1825),]
```

## Replicate Analysis

Replicates were taken by measuring a single leaf sample from each tree twice, in order to establish consistency and reliability of measurements with the Dualex.


### Replicate Data Overview

```{r replicate means}
#Anthocyanin
RepAnth = summary(Dup$Anth)

#Chlorophyll
RepChl = summary(Dup$Chl)

#Flavanoid
RepFlav = summary(Dup$Flav)

#NBI
RepNBI =summary(Dup$NBI)

as.table(rbind(RepAnth,RepChl,RepFlav,RepNBI))
```

### Replicate Group means

```{r}
Dup2 = group_by(Dup,Rep.)
Dup2 = summarise(Dup2, Anth = mean(Anth, na.rm = T),Chl = mean(Chl, na.rm = T), Flav = mean(Flav,na.rm = T), NBI = mean(NBI, na.rm = T))
head(Dup2)
```

### Anthocyanin Replicate Plots

```{r}

#Anthocyanin Replicate Comparison
RBA <- ggplot(Dup) + aes(x = Rep., y = Anth,) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Anthocyanin Measure") + xlab("Replicate Number") + ggtitle("Anthocyanin of Replicate Samples") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=5) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dup$Anth));RBA

#Anth Mean Plot
RMA <-ggplot(Dup) +aes(x = Tree.ID, y = Anth, colour = Rep.,fill = Rep.) + geom_point() +geom_hline(yintercept = mean(Dup$Anth), colour = "dodgerblue1")+ ylab("Anthocyanin Measure") + xlab("Tree ID") + ggtitle("Anthocyanin of Replicate Samples")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))

#Histogram of Measurement Distribution
RHA <-ggplot(Dup) +aes(Anth,color=Rep., fill=Rep.) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Anthocyanin Absorbance Units") + ggtitle("Anthocyanin of Replicate Samples") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))

#Display Plots
grid.arrange(RMA,RHA)
```

### Chlorphyll Replicate Plots

```{r}
#Chlorophyll Replicate Comparison
RBC <- ggplot(Dup) + aes(x = Rep., y = Chl) + geom_boxplot(fill = "dodgerblue1", size = 1.25)+ ylab("Surface Chlorophyll") + xlab("Replicate Number") + ggtitle("Chlorophyll of Replicate Samples")+stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=5) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dup$Chl));RBC

#Chl Mean Plot
RMC <-ggplot(Dup) +aes(x = Tree.ID, y = Chl, colour = Rep.,fill = Rep.) + geom_point() +geom_hline(yintercept = mean(Dup$Chl), colour = "dodgerblue1")+ ylab("Surface Chlorophyll") + xlab("Tree ID") + ggtitle("Chlorophyll of Replicate Samples")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))

#Histogram of Chl Measurement Distribution
RHC <-ggplot(Dup) +aes(Chl,color=Rep., fill=Rep.) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Surface Chlorophyll") + ggtitle("Chlorphyll of Replicate Samples") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))

#Display Plots
grid.arrange(RMC,RHC)
```

### Flavonol Replicate Plots

```{r}
#Flavonol Replicate Comparison
RBF <- ggplot(Dup) + aes(x = Rep., y = Flav) + geom_boxplot(fill = "dodgerblue1", size = 1.25)+ ylab("Surface Flavonol") + xlab("Replicate Number") + ggtitle("Flavonol of Replicate Samples")+stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=5) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dup$Flav)); RBF

#Flav Mean Plot
RMF <-ggplot(Dup) +aes(x = Tree.ID, y = Flav, colour = Rep.,fill = Rep.) + geom_point() +geom_hline(yintercept = mean(Dup$Flav), colour = "dodgerblue1")+ ylab("Surface Flavonol") + xlab("Tree ID") + ggtitle("Flavonol of Replicate Samples")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))

#Histogram of Flav Measurement Distribution
RHF <-ggplot(Dup) +aes(Flav,color=Rep., fill=Rep.) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Surface Flavonol") + ggtitle("Flavonol of Replicate Samples") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))

#Display Plots
grid.arrange(RMF,RHF)
```

### Nitrogen Balance Replicate Plots

```{r}
#Nitrogen Replicate Comparison
RBN <- ggplot(Dup) + aes(x = Rep., y = NBI) + geom_boxplot(fill = "dodgerblue1", size = 1.25)+ ylab("Surface Nitrogen") + xlab("Replicate Number") + ggtitle("Nitrogen of Replicate Samples")+stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=5) +theme_bw()+theme(plot.title = element_text(hjust = 0.5)) +geom_hline(yintercept = mean(Dup$NBI));RBN

#NBI Mean Plot
RMN <-ggplot(Dup) +aes(x = Tree.ID, y = NBI, colour = Rep.,fill = Rep.) + geom_point() +geom_hline(yintercept = mean(Dup$NBI), colour = "dodgerblue1")+ ylab("Surface Nitrogen") + xlab("Tree ID") + ggtitle("Nitrogen of Replicate Samples")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))

#Histogram of NBI Measurement Distribution
RHN <-ggplot(Dup) +aes(NBI,color=Rep., fill=Rep.) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Surface Nitrogen") + ggtitle("Nitrogen of Replicate Samples") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))

#Display Plots
grid.arrange(RMN,RHN)
```

There is no statistically significant differences between the two groups of measurements, this is a good sign indicative of the accuracy of the Dualex. 

### ANOVA of Replicates

```{r}
#Chlorophyll Anova
mod <-lm(Dup$Chl ~ Dup$Rep.)
anova(mod)
#Flavanol Anova
mod2 <-lm(Dup$Flav ~ Dup$Rep.)
anova(mod2)
#Anthocyanin Anova
mod3 <-lm(Dup$Anth ~ Dup$Rep.)
anova(mod3)
#NBI Anova
mod4 <-lm(Dup$NBI ~ Dup$Rep.)
anova(mod4)
```

The absence of statistically significant results indicates that our replicates are likely to be consistent.



## Allocation Analysis

Allocation refers to which group measurements were taken from, i.e. A Parental Tree (EC103 or EC201), Outgroup Tree (CG), Parental Offspring (F1)

### Allocation Data Overview

```{r Allocation Means}
#Anthocyanin Mean
AllAnth = summary(Data$Anth)
#Chlorophyll Mean
AllChl = summary(Data$Chl)
#Flavanol Mean
AllFlav = summary(Data$Flav)
#NBI Mean
AllNBI = summary(Data$NBI)

as.table(rbind(AllAnth,AllChl,AllFlav,AllNBI))
```

### Allocation Group Means

```{r}
Data2 = group_by(Data, Allocation)
Data2 = summarise(Data2, Anth = mean(Anth, na.rm = T),Chl = mean(Chl, na.rm = T), Flav = mean(Flav, na.rm = T), NBI = mean(NBI, na.rm = T))
head(Data2)
```

### Boxplot comparing mean, median and measurement distributions of Allocations

```{r Allocation Boxplots}
#Boxplot Anthocyanin Allocation
ABA<- ggplot(Data) + aes(x = Allocation, y = Anth) + geom_boxplot(fill = "dodgerblue1", size = 1)+ ylab("Anth") + xlab("Allocation") + ggtitle("Anth of Allocations")+stat_summary(fun.y=mean, colour="green", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5)) +geom_hline(yintercept = mean(Data$Anth))

#Boxplot Chlorophyll Allocation
ABC<- ggplot(Data) + aes(x = Allocation, y = Chl) + geom_boxplot(fill = "dodgerblue1", size = 1)+ ylab("Chl") + xlab("Allocation") + ggtitle("Chl of Allocations")+stat_summary(fun.y=mean, colour="green", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5)) +geom_hline(yintercept = mean(Data$Chl))

#Boxplot Flavanol Allocation
ABF<- ggplot(Data) + aes(x = Allocation, y = Flav) + geom_boxplot(fill = "dodgerblue1", size = 1)+ ylab("Flav") + xlab("Allocation") + ggtitle("Flav of Allocations")+stat_summary(fun.y=mean, colour="green", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5)) +geom_hline(yintercept = mean(Data$Flav))

#Boxplot NBI Allocation
ABN<- ggplot(Data) + aes(x = Allocation, y = NBI) + geom_boxplot(fill = "dodgerblue1", size = 1)+ ylab("NBI") + xlab("Allocation") + ggtitle("NBI of Allocations")+stat_summary(fun.y=mean, colour="green", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5)) +geom_hline(yintercept = mean(Data$NBI))

#Display Plots
grid.arrange(ABA,ABC,ABF,ABN,ncol=2)
```

### Allocation ANOVAs

```{r Allocation Anova}
#Chlorophyll
mod5 <-lm(Data$Chl ~ Data$Allocation)
anova(mod5)
#Nitrogen
mod6 <-lm(Data$NBI ~ Data$Allocation)
anova(mod5)
#Flavanol
mod7 <-lm(Data$Flav ~ Data$Allocation)
anova(mod7)
#Anthocyanin
mod8 <-lm(Data$Anth ~ Data$Allocation)
anova(mod8)
```

F1 Samples (Approx 3 years) appear more similar to that of the Crimson Glory plant than either/both parents - this is possibly due to age effects as CG is likely more similar in this regard being shorter (No age confirmed).
ANOVAs incidate there is significant differences between the allocations - this is to be expected.


## Parent Tree Analysis

### Parent Tree Means

```{r Parent t.tests}
#Binding parents into single dataset
Parent <- rbind(EC201,EC103)
#Summary Stats
Parent2 = group_by(Parent, Tree.ID)
Parent2 = summarise(Parent2,Anth = mean(Anth, na.rm = T),Chl = mean(Chl, na.rm = T), Flav = mean(Flav, na.rm = T), NBI = mean(NBI, na.rm = T))
head(Parent2)
```

### Parent Tree Data Overview

```{r}
#Anthocyanin
ParAnth = summary(Parent$Anth)
#Chlorophyll
ParChl = summary(Parent$Chl)
#Flavonol
ParFlav = summary(Parent$Flav)
#NBI
ParNBI = summary(Parent$NBI)

as.table(rbind(ParAnth,ParChl,ParFlav,ParNBI))
```

### Anthocyanin Parent Plots

```{r Anth Parent Plots}
#Anthocyanin Parent Comparison
PBA <- ggplot(Parent) + aes(x = Tree.ID, y = Anth,) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Anthocyanin Measure") + xlab("Parent") + ggtitle("Anthocyanin of Parent Samples") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=5) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Parent$Anth));PBA

#Anth Mean Plot
PMA<-ggplot(Parent) +aes(x = measure, y = Anth, colour = Tree.ID, fill = Tree.ID) + geom_point() +geom_hline(yintercept = mean(Parent$Anth), colour = "dodgerblue1")+ ylab("Anthocyanin") + xlab("Measure") + ggtitle("Anthocyanin of Parent Samples")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))

#Histogram of Measurement Distribution
PHA <-ggplot(Parent) +aes(Anth,color=Tree.ID, fill=Tree.ID) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Anthocyanin") + ggtitle("Anthocyanin Distribution of Parents") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))

#Display Plots
grid.arrange(PMA,PHA)
```

### Chlorophyll Parent Plots

```{r Chl Parent Plots}
#Chlorophyll Parent Comparison
PBC<- ggplot(Parent) + aes(x = Tree.ID, y = Chl,) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Chlorophyll Measure") + xlab("Parent") + ggtitle("Chlorophyll of Parent Samples") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=5) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Parent$Chl));PBC

#Chl Mean Plot
PMC <-ggplot(Parent) +aes(x = measure, y = Chl, colour = Tree.ID, fill = Tree.ID) + geom_point() +geom_hline(yintercept = mean(Parent$Chl), colour = "dodgerblue1")+ ylab("Chlorophyll") + xlab("Measure") + ggtitle("Chlorophyll of Parent Samples")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))

#Histogram of Measurement Distribution
PHC <-ggplot(Parent) +aes(Chl,color=Tree.ID, fill=Tree.ID) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Chlorophyll") + ggtitle("Chlorophyll Distribution of Parents") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))

#Display Plots
grid.arrange(PMC,PHC)
```

### Flavonol Parent Plots

```{r Flav Parent Plots}
#Flavonol Parent Comparison
PBF<- ggplot(Parent) + aes(x = Tree.ID, y = Flav,) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Flavonol Measure") + xlab("Parent") + ggtitle("Flavonol of Parent Samples") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=5) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Parent$Flav));PBF

#Flav Mean Plot
PMF<-ggplot(Parent) +aes(x = measure, y = Flav, colour = Tree.ID, fill = Tree.ID) + geom_point() +geom_hline(yintercept = mean(Parent$Flav), colour = "dodgerblue1")+ ylab("Flavonol") + xlab("Measure") + ggtitle("Flavonol of Parent Samples")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))

#Histogram of Measurement Distribution
PHF <-ggplot(Parent) +aes(Flav,color=Tree.ID, fill=Tree.ID) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Flavonol") + ggtitle("Flavonol Distribution of Parents") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))

#Display Plots
grid.arrange(PMF,PHF)
```

### Nitrogen Parent Plots

```{r NBI Parent Plots}
#Nitrogen Parent Comparison
PBN <- ggplot(Parent) + aes(x = Tree.ID, y = NBI,) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Nitrogen Measure") + xlab("Parent") + ggtitle("Nitrogen of Parent Samples") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=5) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Parent$NBI));PBN

#NBI Mean Plot
PMN <-ggplot(Parent) +aes(x = measure, y = NBI, colour = Tree.ID, fill = Tree.ID) + geom_point() +geom_hline(yintercept = mean(Parent$NBI), colour = "dodgerblue1")+ ylab("Nitrogen") + xlab("Measure") + ggtitle("Nitrogen of Parent Samples")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))

#Histogram of Measurement Distribution
PHN <-ggplot(Parent) +aes(NBI,color=Tree.ID, fill=Tree.ID) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Nitrogen") + ggtitle("Nitrogen Distribution of Parents") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))

#Display Plots
grid.arrange(PMN,PHN)
```

### Parent t.tests

```{r Parent t.test}
t.test(Parent$Anth ~ Parent$Tree.ID)
t.test(Parent$Chl ~ Parent$Tree.ID)
t.test(Parent$Flav ~ Parent$Tree.ID)
t.test(Parent$NBI ~ Parent$Tree.ID)
```

Interesting sample pattern here, Chl and NBI start low and work high, Flav does the opposite. Maybe accuracy of measurements? 

## Parental Cross Analysis (F1 Generation)

### A Brief Look at Some Tree Data

```{r F1}
#Grouping F1 Measures By Tree
F12 <-group_by(F1,Tree.ID)
F12 <- summarise(F12,Chl = mean(Chl,na.rm=T), NBI = mean(NBI, ra.nm = T), Anth = mean(Anth, na.rm=T),Flav = mean(Flav,na.rm =T))
head(F12)
```

### Anthocyanin Overview

```{r F1 Anth}
#Anthocyanin F1 Comparison
FBA<- ggplot(F1) + aes(x = Tree.ID, y = Anth,) + geom_boxplot(colour = "turquoise4") + ylab("Anthocyanin Measure") + xlab("F1") + ggtitle("Anthocyanin of F1 Samples") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$Anth), colour = "orchid3");FBA

#Anth Mean Plot
FMA <-ggplot(F12) +aes(x = Tree.ID, y = Anth) + geom_point(colour = "turquoise3") +geom_hline(yintercept = mean(F12$Anth), colour = "orchid3")+ ylab("Anthocyanin") + xlab("Tree ID") + ggtitle("Anthocyanin of F1 Samples")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))

#Histogram of Measurement Distribution
FHA <-ggplot(F12) +aes(Anth) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Anthocyanin") + ggtitle("Anthocyanin Distribution of F1 Trees") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))

#Display Plots
grid.arrange(FMA,FHA)

#Anthocyanin ANOVA
FAA = lm(F1$Anth ~ F1$Tree.ID)
anova(FAA)
```

### Chlorophyll Overview

```{r F1 Chl}
#Chlorophyll F1 Comparison
FBC <- ggplot(F1) + aes(x = Tree.ID, y = Chl,) + geom_boxplot(colour = "turquoise4") + ylab("Chlorophyll Measure") + xlab("F1") + ggtitle("Chlorophyll of F1 Samples") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$Chl), colour = "orchid3");FBC

#Chl Mean Plot
FMC <-ggplot(F12) +aes(x = Tree.ID, y = Chl) + geom_point(colour = "turquoise3") +geom_hline(yintercept = mean(F12$Chl), colour = "orchid3")+ ylab("Chlorophyll") + xlab("Tree ID") + ggtitle("Chlorophyll of F1 Samples")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))

#Histogram of Measurement Distribution
FHC <-ggplot(F12) +aes(Chl) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Chlorophyll") + ggtitle("Chlorophyll Distribution of F1 Trees") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))

#Display Plots
grid.arrange(FMC,FHC)

#Chlorophyll ANOVA
FAA = lm(F1$Chl ~ F1$Tree.ID)
anova(FAA)
```

### Flavonol Overview

```{r F1 Flav}
#Flavonol F1 Comparison
FBF <- ggplot(F1) + aes(x = Tree.ID, y = Flav,) + geom_boxplot(colour = "turquoise4") + ylab("Flavonol Measure") + xlab("F1") + ggtitle("Flavonol of F1 Samples") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$Flav), colour = "orchid3");FBF

#Flav Mean Plot
FMF <-ggplot(F12) +aes(x = Tree.ID, y = Flav) + geom_point(colour = "turquoise3") +geom_hline(yintercept = mean(F12$Flav), colour = "orchid3")+ ylab("Flavonol") + xlab("Tree ID") + ggtitle("Flavonol of F1 Samples")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))

#Histogram of Measurement Distribution
FHF <-ggplot(F12) +aes(Flav) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Flavonol") + ggtitle("Flavonol Distribution of F1 Trees") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))

#Display Plots
grid.arrange(FMF,FHF)

#Flavonol ANOVA
FAA = lm(F1$Flav ~ F1$Tree.ID)
anova(FAA)
```

### Nitrogen Overview

```{r F1 NBI}
#Nitrogen F1 Comparison
FBN <- ggplot(F1) + aes(x = Tree.ID, y = NBI,) + geom_boxplot(colour = "turquoise4") + ylab("Nitrogen Measure") + xlab("F1") + ggtitle("Nitrogen of F1 Samples") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$NBI), colour = "orchid3");FBN

#NBI Mean Plot
FMN <-ggplot(F12) +aes(x = Tree.ID, y = NBI) + geom_point(colour = "turquoise3") +geom_hline(yintercept = mean(F12$NBI), colour = "orchid3")+ ylab("Nitrogen") + xlab("Tree ID") + ggtitle("Nitrogen of F1 Samples")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))

#Histogram of Measurement Distribution
FHN <-ggplot(F12) +aes(NBI) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Nitrogen") + ggtitle("Nitrogen Distribution of F1 Trees") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))

#Display Plots
grid.arrange(FMN,FHN)

#Nitrogen ANOVA
FAA = lm(F1$NBI ~ F1$Tree.ID)
anova(FAA)
```

### A Closer Look at Invidual F1 Trees and Their Measurements


```{r investigating measure numbers of random samples, echo = TRUE}
Msr = group_by(F1, Tree.ID, measure)
Msr = summarise(Msr, Anth = mean(Anth), Flav = mean(Flav), Chl = mean(Chl),NBI = mean(NBI))

#Select Random Column
#sample(1:4,10, replace = T)
#[1] 3 3 2 1 1 4 1 2 4 3

#Select Random Row
#sample(1:50,10, replace = T)
#[1] 34 37 44 20 44 47  9 19 22 40
```

#### IN4G5

```{r}
#Col 3, Row 34 = IN4G5
IN4G5 = Msr[c(1432:1442),]
AnthG5 <-ggplot(IN4G5) + aes(x = measure, y = Anth) + ggtitle("IN4G5 Anthocyanin") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4G5$Anth), colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
ChlG5 <-ggplot(IN4G5) + aes(x = measure, y = Chl)+ ggtitle("IN4G5 Chlorophyll") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4G5$Chl),colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
FlavG5 <-ggplot(IN4G5) + aes(x = measure, y = Flav)+ ggtitle("IN4G5 Flavonol") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4G5$Flav),colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
NBIG5 <-ggplot(IN4G5) + aes(x = measure, y = NBI)+ ggtitle("IN4G5 Nitrogen") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4G5$NBI),colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
grid.arrange(AnthG5,ChlG5,FlavG5,NBIG5)
```

#### IN4EP

```{r}
#Col 3, Row 37 = IN4EP
IN4EP = Msr[c(935:945),]
AnthEP <-ggplot(IN4EP) + aes(x = measure, y = Anth) + ggtitle("IN4EP Anthocyanin") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4EP$Anth), colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
ChlEP <-ggplot(IN4EP) + aes(x = measure, y = Chl)+ ggtitle("IN4EP Chlorophyll") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4EP$Chl),colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
FlavEP <-ggplot(IN4EP) + aes(x = measure, y = Flav)+ ggtitle("IN4EP Flavonol") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4EP$Flav),colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
NBIEP <-ggplot(IN4EP) + aes(x = measure, y = NBI)+ ggtitle("IN4EP Nitrogen") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4EP$NBI),colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
grid.arrange(AnthEP,ChlEP,FlavEP,NBIEP)
```

#### IN4EY

```{r}
#Col 2, Row 44 = IN4EY
IN4EY = Msr[c(1012:1022),]
AnthEY <-ggplot(IN4EY) + aes(x = measure, y = Anth) + ggtitle("IN4EY Anthocyanin") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4EY$Anth), colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
ChlEY <-ggplot(IN4EY) + aes(x = measure, y = Chl)+ ggtitle("IN4EY Chlorophyll") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4EY$Chl),colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
FlavEY <-ggplot(IN4EY) + aes(x = measure, y = Flav)+ ggtitle("IN4EY Flavonol") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4EY$Flav),colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
NBIEY <-ggplot(IN4EY) + aes(x = measure, y = NBI)+ ggtitle("IN4EY Nitrogen") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4EY$NBI),colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
grid.arrange(AnthEY,ChlEY,FlavEY,NBIEY)
```

#### IN4CD

```{r}
#Col 1, Row 20 = IN4CD
IN4CD = Msr[c(204:214),]
AnthCD <-ggplot(IN4CD) + aes(x = measure, y = Anth) + ggtitle("IN4CD Anthocyanin") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4CD$Anth), colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
ChlCD <-ggplot(IN4CD) + aes(x = measure, y = Chl)+ ggtitle("IN4CD Chlorophyll") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4CD$Chl),colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
FlavCD <-ggplot(IN4CD) + aes(x = measure, y = Flav)+ ggtitle("IN4CD Flavonol") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4CD$Flav),colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
NBICD <-ggplot(IN4CD) + aes(x = measure, y = NBI)+ ggtitle("IN4CD Nitrogen") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4CD$NBI),colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
grid.arrange(AnthCD,ChlCD,FlavCD,NBICD)
```

#### IN4D8

```{r}
#Col 1, Row 44 = IN4D8
IN4D8 = Msr[c(463:472),]
AnthD8 <-ggplot(IN4D8) + aes(x = measure, y = Anth) + ggtitle("IN4D8 Anthocyanin") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4D8$Anth), colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
ChlD8 <-ggplot(IN4D8) + aes(x = measure, y = Chl)+ ggtitle("IN4D8 Chlorophyll") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4D8$Chl),colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
FlavD8 <-ggplot(IN4D8) + aes(x = measure, y = Flav)+ ggtitle("IN4D8 Flavonol") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4D8$Flav),colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
NBID8 <-ggplot(IN4D8) + aes(x = measure, y = NBI)+ ggtitle("IN4D8 Nitrogen") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4D8$NBI),colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
grid.arrange(AnthD8,ChlD8,FlavD8,NBID8)
```

#### IN4GV

```{r}
#Col4, Row 47 = IN4GV
IN4GV = Msr[c(1645:1654),]
AnthGV <-ggplot(IN4GV) + aes(x = measure, y = Anth) + ggtitle("IN4GV Anthocyanin") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4GV$Anth), colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
ChlGV <-ggplot(IN4GV) + aes(x = measure, y = Chl)+ ggtitle("IN4GV Chlorophyll") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4GV$Chl),colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
FlavGV <-ggplot(IN4GV) + aes(x = measure, y = Flav)+ ggtitle("IN4GV Flavonol") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4GV$Flav),colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
NBIGV <-ggplot(IN4GV) + aes(x = measure, y = NBI)+ ggtitle("IN4GV Nitrogen") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4GV$NBI),colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
grid.arrange(AnthGV,ChlGV,FlavGV,NBIGV)
```

#### IN4C2

```{r}
#Col 1, Row 9 = IN4C2
IN4C2 = Msr[c(93:103),]
AnthC2 <-ggplot(IN4C2) + aes(x = measure, y = Anth) + ggtitle("IN4C2 Anthocyanin") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4C2$Anth), colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
ChlC2 <-ggplot(IN4C2) + aes(x = measure, y = Chl)+ ggtitle("IN4C2 Chlorophyll") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4C2$Chl),colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
FlavC2 <-ggplot(IN4C2) + aes(x = measure, y = Flav)+ ggtitle("IN4C2 Flavonol") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4C2$Flav),colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
NBIC2 <-ggplot(IN4C2) + aes(x = measure, y = NBI)+ ggtitle("IN4C2 Nitrogen") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4C2$NBI),colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
grid.arrange(AnthC2,ChlC2,FlavC2,NBIC2)
```

#### IN4E3

```{r}
#Col 2, Row 19 = IN4E3
IN4E3 = Msr[c(740:750),]
AnthE3 <-ggplot(IN4E3) + aes(x = measure, y = Anth) + ggtitle("IN4E3 Anthocyanin") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4E3$Anth), colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
ChlE3 <-ggplot(IN4E3) + aes(x = measure, y = Chl)+ ggtitle("IN4E3 Chlorophyll") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4E3$Chl),colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
FlavE3 <-ggplot(IN4E3) + aes(x = measure, y = Flav)+ ggtitle("IN4E3 Flavonol") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4E3$Flav),colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
NBIE3 <-ggplot(IN4E3) + aes(x = measure, y = NBI)+ ggtitle("IN4E3 Nitrogen") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4E3$NBI),colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
grid.arrange(AnthE3,ChlE3,FlavE3,NBIE3)
```

#### IN4HK

```{r}
#Col 4, Row 22 = N/A -> Row 23 = IN4HK
IN4HK = Msr[c(1718:1728),]
AnthHK <-ggplot(IN4HK) + aes(x = measure, y = Anth) + ggtitle("IN4HK Anthocyanin") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4HK$Anth), colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
ChlHK <-ggplot(IN4HK) + aes(x = measure, y = Chl)+ ggtitle("IN4HK Chlorophyll") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4HK$Chl),colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
FlavHK <-ggplot(IN4HK) + aes(x = measure, y = Flav)+ ggtitle("IN4HK Flavonol") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4HK$Flav),colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
NBIHK <-ggplot(IN4HK) + aes(x = measure, y = NBI)+ ggtitle("IN4HK Nitrogen") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4HK$NBI),colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
grid.arrange(AnthHK,ChlHK,FlavHK,NBIHK)
```

#### IN4GC

```{r}
#Col 3, Row 40 = IN4GC
IN4GC = Msr[c(1508:1518),]
AnthGC <-ggplot(IN4GC) + aes(x = measure, y = Anth) + ggtitle("IN4GC Anthocyanin") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4GC$Anth), colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
ChlGC <-ggplot(IN4GC) + aes(x = measure, y = Chl)+ ggtitle("IN4GC Chlorophyll") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4GC$Chl),colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
FlavGC <-ggplot(IN4GC) + aes(x = measure, y = Flav)+ ggtitle("IN4GC Flavonol") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4GC$Flav),colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
NBIGC <-ggplot(IN4GC) + aes(x = measure, y = NBI)+ ggtitle("IN4GC Nitrogen") + geom_point(colour = "orchid3") + geom_hline(yintercept = mean(IN4GC$NBI),colour = "turquoise3") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
grid.arrange(AnthGC,ChlGC,FlavGC,NBIGC)
```

### F1 Height Analysis

```{r Height Analysis}
F13 = group_by(F1,Height)
F13 = summarise(F13, Anth = mean(Anth, na.rm = T), Chl = mean(Chl, na.rm = T), Flav = mean(Flav, na.rm = T), NBI = mean(NBI, na.rm = T))
head(F13)

#Boxplot Anthocyanin Height
HBA <- ggplot(F1) + aes(x = Height, y = Anth,) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Anthocyanin Measure") + xlab("Height") + ggtitle("Anthocyanin by Height") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$Anth))

#Boxplot Chlorophyll Height
HBC <- ggplot(F1) + aes(x = Height, y = Chl,) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Chlorophyll Measure") + xlab("Height") + ggtitle("Chlorophyll by Height") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$Chl))

#Boxplot Flavonol Height
HBF<- ggplot(F1) + aes(x = Height, y = Flav,) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Flavonol Measure") + xlab("Height") + ggtitle("Flavonol by Height") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$Flav))

#Boxplot Nitrogen Height
HBN <- ggplot(F1) + aes(x = Height, y = NBI,) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Nitrogen Measure") + xlab("Height") + ggtitle("Nitrogen by Height") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$NBI))


grid.arrange(HBA,HBC,HBF,HBN)
```


### Height Measure Distributions

### Anthocyanin

```{r}
HMA <-ggplot(F1) +aes(x = Tree.ID, y = Anth, colour = Height, fill = Height) + geom_point() +geom_hline(yintercept = mean(F1$Anth), colour = "dodgerblue1")+ ylab("Anthocyanin") + xlab("Tree ID") + ggtitle("Anthocyanin Height Measures")+theme_bw()+theme(plot.title = element_text(hjust = 0.5));HMA

HHA <-ggplot(F1) +aes(Anth,color=Height, fill=Height) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Anthocyanin") + ggtitle("Anthocyanin by Height") +theme_bw() +theme(plot.title = element_text(hjust = 0.5));HHA
```

### Chlorophyll

```{r}
HMC <-ggplot(F1) +aes(x = Tree.ID, y = Chl, colour = Height, fill = Height) + geom_point() +geom_hline(yintercept = mean(F1$Chl), colour = "dodgerblue1")+ ylab("Chlorophyll") + xlab("Tree ID") + ggtitle("Chlorophyll Height Measures")+theme_bw()+theme(plot.title = element_text(hjust = 0.5));HMC

HHC <-ggplot(F1) +aes(Chl,color=Height, fill=Height) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Chlorophyll") + ggtitle("Chlorophyll by Height") +theme_bw() +theme(plot.title = element_text(hjust = 0.5));HHC
```

### Flavonol

```{r}
HMF <-ggplot(F1) +aes(x = Tree.ID, y = Flav, colour = Height, fill = Height) + geom_point() +geom_hline(yintercept = mean(F1$Flav), colour = "dodgerblue1")+ ylab("Flavonol") + xlab("Tree ID") + ggtitle("Flavonol Height Measures")+theme_bw()+theme(plot.title = element_text(hjust = 0.5));HMF

HHF <-ggplot(F1) +aes(Flav,color=Height, fill=Height) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Flavonol") + ggtitle("Flavonol by Height") +theme_bw() +theme(plot.title = element_text(hjust = 0.5));HHF
```

### Nitrogen

```{r}
HMN <-ggplot(F1) +aes(x = Tree.ID, y = NBI, colour = Height, fill = Height) + geom_point() +geom_hline(yintercept = mean(F1$NBI), colour = "dodgerblue1")+ ylab("Nitrogen") + xlab("Tree ID") + ggtitle("Nitrogen Height Measures")+theme_bw()+theme(plot.title = element_text(hjust = 0.5));HMN

HHN <-ggplot(F1) +aes(NBI,color=Height, fill=Height) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Nitrogen") + ggtitle("Nitrogen by Height") +theme_bw() +theme(plot.title = element_text(hjust = 0.5));HHN
```


```{r Height Anova}
#Anthocyanin ANOVA
HAA = lm(F1$Anth ~ F1$Height)
anova(HAA)

#Chlorophyll ANOVA
HCA = lm(F1$Chl ~ F1$Height)
anova(HCA)

#Flavonol ANOVA
HFA = lm(F1$Flav ~ F1$Height)
anova(HFA)

#NBI ANOVA
HNA = lm(F1$NBI ~ F1$Height)
anova(HNA)
```

### Row Analysis

#### Sample of Row Means
```{r Row Analysis}
#Grouping data by ROw
F1R = group_by(F1,Row)
F1R = summarise(F1R,Chl = mean(Chl,na.rm=T), NBI = mean(NBI, ra.nm = T), Anth = mean(Anth, na.rm=T),Flav = mean(Flav,na.rm =T))
head(F1R)
```

#### Investigating Differences Between Rows with 2,3 and 4 Trees.

```{r}
#Comparing Rows with Differing Tree Numbers

#1 Row with 2 Trees
R2 = F1R[c(9),]
#39 Rows with 3 Trees
R3 = F1R[-c(16,26,4,40,36,5,50,42,44,46,9),]
#10  Rows with 4 Trees
R4 = F1R[c(16,26,4,40,36,5,50,42,44,46),]
```

#### Summary of Rows with 2 Trees

```{r}
#Row Sample Summaries
summary(R2)
```

#### Summary of Rows with 3 Trees

```{r}
summary(R3)
```

#### Summary of Rows with 4 Trees

```{r}
summary(R4)
```

#### Looking at Row Differences in Variance

```{r}
#Checking Variance (R2 discounted due to sample size of 1 row)
var(R3$Anth)
var(R4$Anth)
var(R3$Chl)
var(R4$Chl)
var(R3$Flav)
var(R4$Flav)
var(R3$NBI)
var(R4$NBI)
```

#### T.Tests to Compare Similarity Between Rows with 3 and Rows with 4 Trees.

```{r}
#T.test 
t.test(R4$Anth, R3$Anth, alternative = "two.sided", var.equal = FALSE)
t.test(R4$Chl, R3$Chl, alternative = "two.sided", var.equal = FALSE)
t.test(R4$Flav, R3$Flav, alternative = "two.sided", var.equal = FALSE)
t.test(R4$Flav, R3$Flav, alternative = "two.sided", var.equal = FALSE)
```

There appears to be no signficant differences between Rows with 3 trees and rows with 4 trees for any of the measures. 

### Row Plots and ANOVAs


### Anthocyanin 

```{r}
#Boxplot Anthocyanin by Row
RoBA<- ggplot(F1) + aes(x = Row, y = Anth) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Anthocyanin Measure") + xlab("Row") + ggtitle("Anthocyanin by Row") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$Anth), colour = "lightpink");RoBA

#Mean Distribution
RoMA<-ggplot(F1R) +aes(x = Row, y = Anth) + geom_point(colour = "turquoise3") +geom_hline(yintercept = mean(F1R$Anth), colour = "orchid3")+ ylab("Anthocyanin") + xlab("Tree ID") + ggtitle("Anthocyanin Row Means")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))

#Histogram
RoHA <-ggplot(F1R) +aes(Anth) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Anthocyanin") + ggtitle("Anthocyanin Distribution of F1 Rows") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))

grid.arrange(RoMA,RoHA)
```

### Chlorophyll 

```{r}
#Boxplot Chlorophyll by Row
RoBC<- ggplot(F1) + aes(x = Row, y = Chl) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Chlorophyll Measure") + xlab("Row") + ggtitle("Chlorophyll by Row") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$Chl), colour = "lightpink");RoBC

#Mean Distribution
RoMC<-ggplot(F1R) +aes(x = Row, y = Chl) + geom_point(colour = "turquoise3") +geom_hline(yintercept = mean(F1R$Chl), colour = "orchid3")+ ylab("Nitrogen") + xlab("Tree ID") + ggtitle("Chlorophyll Row Means")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))

#Histogram
RoHC <-ggplot(F1R) +aes(Chl) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Chlorophyll") + ggtitle("Chlorophyll Distribution of F1 Rows") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))

grid.arrange(RoMC,RoHC)
```

### Flavonol 

```{r}
#Boxplot Flavonol by Row
RoBF<- ggplot(F1) + aes(x = Row, y = Flav) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Flavonol Measure") + xlab("Row") + ggtitle("Flavonol by Row") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$Flav), colour = "lightpink");RoBF

#Mean Distribution
RoMF<-ggplot(F1R) +aes(x = Row, y = Flav) + geom_point(colour = "turquoise3") +geom_hline(yintercept = mean(F1R$Flav), colour = "orchid3")+ ylab("Nitrogen") + xlab("Tree ID") + ggtitle("Flavonol Row Means")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))

#Histogram
RoHF <-ggplot(F1R) +aes(Flav) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Flavonol") + ggtitle("Flavonol Distribution of F1 Rows") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))

grid.arrange(RoMF,RoHF)
```

### Nitrogen 

```{r}
#Boxplot Nitrogen by Row
RoBN<- ggplot(F1) + aes(x = Row, y = NBI) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Nitrogen Measure") + xlab("Row") + ggtitle("Nitrogen by Row") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$NBI), colour = "lightpink");RoBN

#Mean Distribution
RoMN<-ggplot(F1R) +aes(x = Row, y = NBI) + geom_point(colour = "turquoise3") +geom_hline(yintercept = mean(F1R$NBI), colour = "orchid3")+ ylab("Nitrogen") + xlab("Tree ID") + ggtitle("Nitrogen Row Means")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))

#Histogram
RoHN <-ggplot(F1R) +aes(NBI) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Nitrogen") + ggtitle("Nitrogen Distribution of F1 Rows") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))

grid.arrange(RoMN,RoHN)
```

#### Row ANOVA

```{r}
AnRoA = lm(F1$Anth ~ F1$Row)
anova(AnRoA)

AnRoC = lm(F1$Chl ~ F1$Row)
anova(AnRoC)

AnRoF = lm(F1$Flav ~ F1$Row)
anova(AnRoF)

AnRoN = lm(F1$NBI ~ F1$Row)
anova(AnRoN)
```
#### Column Analysis

### Column Means
```{r Column Analysis}
#Making Column Values Factors
F1$Column = as.factor(F1$Column)
#Grouping data by Column
F1C = group_by(F1,Column)
F1C = summarise(F1C,Chl = mean(Chl,na.rm=T), NBI = mean(NBI, ra.nm = T), Anth = mean(Anth, na.rm=T),Flav = mean(Flav,na.rm =T))
head(F1C)
```

### Data Overview of Column

```{r}
#Divide data into Columns maaan.
summary(F1$Column)

```

### Column Boxplots

```{r}
#Boxplot Anthocyanin Column
CBA <- ggplot(F1) + aes(x = Column, y = Anth,) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Anthocyanin Measure") + xlab("Column") + ggtitle("Anthocyanin by Column") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$Anth))

#Boxplot Chlorophyll Column
CBC<- ggplot(F1) + aes(x = Column, y = Chl,) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Chlorophyll Measure") + xlab("Column") + ggtitle("Chlorophyll by Column") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$Chl))

#Boxplot Flavonol Column
CBF <- ggplot(F1) + aes(x = Column, y = Flav,) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Flavonol Measure") + xlab("Column") + ggtitle("Flavonol by Column") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$Flav))

#Boxplot Nitrogen Column
CBN<- ggplot(F1) + aes(x = Column, y = NBI,) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Nitrogen Measure") + xlab("Column") + ggtitle("Nitrogen by Column") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$NBI))

grid.arrange(CBA,CBC,CBF,CBN)
```

### ANOVA

```{r}
#Anthocyanin ANOVA
CAA = lm(F1$Anth ~ F1$Column)
anova(CAA)

#Chlorophyll ANOVA
CCA = lm(F1$Chl ~ F1$Column)
anova(CCA)

#Flavonol ANOVA
CFA = lm(F1$Flav ~ F1$Column)
anova(CFA)

#NBI ANOVA
CNA = lm(F1$NBI ~ F1$Column)
anova(CNA)
```


```{r interactive terms}
#Anthocyanin
CRHA = lm(F1$Anth ~ F1$Height*F1$Column*F1$Row)
anova(CRHA)
#Remove insignificant variables
CRHA2 = lm(F1$Anth ~ F1$Height*F1$Row)
anova(CRHA2)
#Chlorophyll
CRHC = lm(F1$Chl ~ F1$Height*F1$Column*F1$Row)
anova(CRHC)
#Remove insignificant variables
CRHC2 = lm(F1$Chl ~ F1$Height*F1$Row)
anova(CRHC2)
#Further Remove insignificant variables
CRHC3 = lm(F1$Chl ~ F1$Row)
anova(CRHC3)

#Flavonol
CRHF = lm(F1$Flav ~ F1$Height*F1$Column*F1$Row)
anova(CRHF)

#NBI
CRHN = lm(F1$NBI ~ F1$Height*F1$Column*F1$Row)
anova(CRHN)
#Remove insignificant variables
CRHM2 = lm(F1$NBI ~ F1$Row*F1$Column)
anova(CRHM2)
```

### Controlling for Height,Column,Row effects 

```{r Controlling for effects, echo = TRUE}
Dat = F1

#Identifying outliers outside 
OBA <-boxplot(Dat$Anth,range = 3.5, plot = F)$out
OBC <-boxplot(Dat$Chl,range = 3, plot = F)$out
OBF <-boxplot(Dat$Flav,range = 3, plot = F)$out
OBN <-boxplot(Dat$NBI,range = 3,plot=F)$out

#Isolating outliers exceeding
OA = Dat[which(Dat$Anth %in% OBA),];OA
OC = Dat[which(Dat$Anth %in% OBC),];OC
OF = Dat[which(Dat$Anth %in% OBF),];OF
ON = Dat[which(Dat$Anth %in% OBN),];ON

Dat <- Dat[-which(Dat$Anth %in% OBA),]

DATG <- ggplot(F1) + aes(x = Tree.ID, y = Anth,) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Anth") + xlab("Tree ID") + ggtitle("Anthocyanin Raw Data") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$Anth))

DATG2 <- ggplot(Dat) + aes(x = Tree.ID, y = Anth,) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Anth") + xlab("Tree ID") + ggtitle("Anthocyanin Outliers Removed") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$Anth))

grid.arrange(DATG,DATG2)

#Total Mean
Dat$ATmean = mean(Dat$Anth)
Dat$CTmean = mean(Dat$Chl)
Dat$FTmean = mean(Dat$Flav)
Dat$NTmean = mean(Dat$NBI)

#Remove Total Mean
Dat$Anth2 = Dat$Anth - Dat$ATmean
Dat$Chl2 = Dat$Chl - Dat$CTmean
Dat$Flav2 = Dat$Flav - Dat$FTmean
Dat$NBI2 = Dat$NBI - Dat$NTmean

#Height Mean for Anth and Flav
DatH = group_by(Dat, Height)
DatH = summarise(DatH, HAnth = mean(Anth, na.rm = T), HChl = mean(Chl, na.rm =T), HFlav = mean(Flav,na.rm = T), HNBI = mean(NBI, na.rm = T))

#Add Height Mean to Data
Dat =merge(Dat, DatH, by.x = "Height")

#Calculate Height Mean Deviation from Total Mean 
Dat$ATH = Dat$ATmean - Dat$HAnth
Dat$CTH = Dat$CTmean - Dat$HChl
Dat$FTH = Dat$FTmean - Dat$HFlav
Dat$NTH = Dat$NTmean - Dat$HNBI

#Controlling for Height Anth and Flav
Dat$Anth3 = Dat$Anth2 + Dat$ATH
Dat$Chl3 = Dat$Chl2 + Dat$CTH
Dat$Flav3 = Dat$Flav2 + Dat$FTH
Dat$NBI3 = Dat$NBI2 + Dat$NTH

#Column Mean for Chl, Flav,NBI
DatC = group_by(Dat, Column)
DatC = summarise(DatC, CAnth = mean(Anth, na.rm = T), CChl = mean(Chl, na.rm = T) ,CFlav = mean(Flav,na.rm = T), CNBI = mean(NBI,na.rm = T))

#Add Column Mean to Data
Dat =merge(Dat, DatC, by.x = "Column")

#Calculate Column Mean Deviation from Total Mean
Dat$ATC = Dat$ATmean - Dat$CAnth
Dat$CTC = Dat$CTmean - Dat$CChl
Dat$FTC = Dat$FTmean - Dat$CFlav
Dat$NTC = Dat$NTmean - Dat$CNBI

#Controlling for Column Chl, Flav and NBI
Dat$Anth4 = Dat$Anth3 + Dat$ATC
Dat$Chl4 = Dat$Chl2 + Dat$CTC
Dat$Flav4 = Dat$Flav3 + Dat$FTC
Dat$NBI4 = Dat$NBI3 + Dat$NTC

#Row Mean for Anth, Chl, Flav and and NBI
DatR = group_by(Dat, Row)
DatR = summarise(DatR, RAnth = mean(Anth,na.rm = T),RChl = mean(Chl,na.rm = T), RFlav = mean(Flav,na.rm = T), RNBI = mean(NBI,na.rm = T))

#Add Row Mean to Data
Dat =merge(Dat, DatR, by.x = "Row")

#Calculate Row Mean Deviation from Total Mean 
Dat$ATR = Dat$ATmean - Dat$RAnth
Dat$CTR = Dat$CTmean - Dat$RChl
Dat$FTR = Dat$FTmean - Dat$RFlav
Dat$NTR = Dat$NTmean - Dat$RNBI

#Controlling for Row in Anth, Chl, Flav and NBI
Dat$Anth5 = Dat$Anth4 + Dat$ATR
Dat$Chl5 = Dat$Chl4 + Dat$CTR
Dat$Flav5 = Dat$Flav4 + Dat$FTR
Dat$NBI5 = Dat$NBI4 + Dat$NTR
```

### New ANOVAs

```{r}
#Anova Checks
AnAnth = lm(Dat$Anth5 ~ Dat$Height*Dat$Column*Dat$Row)
anova(AnAnth)
AnChl = lm(Dat$Chl5 ~ Dat$Height*Dat$Column*Dat$Row)
anova(AnChl)
AnFlav = lm(Dat$Flav5 ~ Dat$Height*Dat$Column*Dat$Row)
anova(AnFlav)
AnNBI = lm(Dat$NBI5 ~ Dat$Height*Dat$Column*Dat$Row)
anova(AnNBI)
```

### Comparison Heatmaps

```{r}
#Heatmaps
#F1HM = group_by(F1, Column, Row)
#F1HM = summarise(F1HM, Anth = mean(Anth,na.rm = T), Chl = mean(Chl,na.rm = T), Flav = mean(Flav,na.rm = T), NBI = mean(NBI,na.rm = T))
#write.xlsx(as.data.frame(F1HM), file = "F1HM.xlsx", sheetName ="F1",col.names = T, row.names = F)


#DatHM = group_by(Dat, Column, Row)
#DatHM = summarise(DatHM, Anth = mean(Anth5,na.rm = T), Chl = mean(Chl5,na.rm = T), Flav = mean(Flav5,na.rm = T), NBI = mean(NBI5,na.rm = T))
#write.xlsx(as.data.frame(DatHM), file = "DatHM.xlsx", sheetName ="Dat",col.names = T, row.names = F)

#Anthocyanin Heatmaps
AnthDoc <-read.xlsx("F1HM2.xlsx", sheetName = "Anth")
heatmaply(AnthDoc, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "Anth Before Correction")

AnthDoc2 <-read.xlsx("DatHM2.xlsx", sheetName = "Anth")
heatmaply(AnthDoc2, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "Anth After Correction")

#Chlorophyll Heatmaps
ChlDoc<-read.xlsx("F1HM2.xlsx", sheetName = "Chl")
heatmaply(ChlDoc, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "Chl Before Correction")

ChlDoc2 <-read.xlsx("DatHM2.xlsx", sheetName = "Chl")
heatmaply(ChlDoc2, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "Chl After Correction")

#Flavonol Heatmaps
FlavDoc<-read.xlsx("F1HM2.xlsx", sheetName = "Flav")
heatmaply(FlavDoc, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "Flav Before Correction")

FlavDoc2 <-read.xlsx("DatHM2.xlsx", sheetName = "Flav")
heatmaply(FlavDoc2, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "Flav After Correction")

#NBI Heatmaps
NBIDoc<-read.xlsx("F1HM2.xlsx", sheetName = "NBI")
heatmaply(NBIDoc, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "NBI Before Correction")

NBIDoc2 <-read.xlsx("DatHM2.xlsx", sheetName = "NBI")
NBIDoc2 = heatmaply(NBIDoc2, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "NBI After Correction");NBIDoc2
```

#### Looking at controlled data

```{r}
#Tree ID Summary
Dat12 = group_by(Dat,Tree.ID)
Dat12 = summarise(Dat12,Chl = mean(Chl5,na.rm=T), NBI = mean(NBI5, ra.nm = T), Anth = mean(Anth5, na.rm=T),Flav = mean(Flav5,na.rm =T))

#Height Summary
Dat13 = group_by(Dat,Height)
Dat13 = summarise(Dat13, Anth = mean(Anth5, na.rm = T), Chl = mean(Chl5, na.rm = T), Flav = mean(Flav5, na.rm = T), NBI = mean(NBI5, na.rm = T))

#Row Summary
Dat14 = group_by(Dat, Row)
Dat14 = summarise(Dat14, Anth = mean(Anth5, na.rm = T), Chl = mean(Chl5, na.rm = T), Flav = mean(Flav5, na.rm = T), NBI = mean(NBI5, na.rm = T))

#Column Summary
Dat15 = group_by(Dat, Column)
Dat15 = summarise(Dat15, Anth = mean(Anth5, na.rm = T), Chl = mean(Chl5, na.rm = T), Flav = mean(Flav5, na.rm = T), NBI = mean(NBI5, na.rm = T))
```

#### Anthocyanin Comparisons

```{r}
#Anthocyanin Boxplot
FBA2 = ggplot(Dat) + aes(x = Tree.ID, y = Anth5) + geom_boxplot(colour = "turquoise4") + ylab("Anthocyanin Measure") + xlab("F1") + ggtitle("F1 Anth After Correction") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$Anth5), colour = "orchid3")

grid.arrange(FBA,FBA2)

#Anth Mean Plot
FMA2 <-ggplot(Dat12) +aes(x = Tree.ID, y = Anth) + geom_point(colour = "turquoise3") +geom_hline(yintercept = mean(Dat12$Anth), colour = "orchid3")+ ylab("Anthocyanin") + xlab("Tree ID") + ggtitle("Anthocyanin of F1 Samples")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))

grid.arrange(FMA,FMA2)

#Histogram of Measurement Distribution
FHA2 <-ggplot(Dat12) +aes(Anth) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Anthocyanin") + ggtitle("Anthocyanin Distribution of F1 Trees After Correction") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))

grid.arrange(FHA,FHA2)

#Height Boxplot
HBA2 <- ggplot(Dat) + aes(x = Height, y = Anth5) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Anthocyanin Measure") + xlab("Height") + ggtitle("Anth Height After Correction") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$Anth5))

grid.arrange(HBA,HBA2, ncol = 2)

#Height Histogram
HHA2 <-ggplot(Dat) +aes(Anth5,color=Height, fill=Height) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Anthocyanin") + ggtitle("Anthocyanin by Height After Correction") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))

grid.arrange(HHA,HHA2)

#Height Means
HMA2 <-ggplot(Dat) +aes(x = Tree.ID, y = Anth5, colour = Height, fill = Height) + geom_point() +geom_hline(yintercept = mean(Dat$Anth5), colour = "dodgerblue1")+ ylab("Anthocyanin") + xlab("Tree ID") + ggtitle("Anthocyanin Height Measures After Correction")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))

grid.arrange(HMA,HMA2)

#Row
#Boxplot Anthocyanin by Row
RoBA2 <- ggplot(Dat) + aes(x = Row, y = Anth5) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Anthocyanin Measure") + xlab("Row") + ggtitle("Anthocyanin by Row After Correction") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$Anth5), colour = "lightpink")

grid.arrange(RoBA,RoBA2)

#Mean Distribution
RoMA2 <-ggplot(Dat14) +aes(x = Row, y = Anth) + geom_point(colour = "turquoise3") +geom_hline(yintercept = mean(Dat14$Anth), colour = "orchid3")+ ylab("Anth") + xlab("Tree ID") + ggtitle("Anthocyanin Row Means After Correction")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))

grid.arrange(RoMA,RoMA2)

#Histogram
RoHA2 <-ggplot(Dat14) +aes(Anth) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Anthocyanin") + ggtitle("Anthocyanin Distribution of F1 Rows After Correction") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))

grid.arrange(RoHA,RoHA2)

#Column
#Boxplot Anthocyanin Column
CBA2 <- ggplot(Dat) + aes(x = Column, y = Anth5) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Anthocyanin Measure") + xlab("Column") + ggtitle("Anth Column After Correction") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$Anth5))

grid.arrange(CBA,CBA2, ncol=2)
```

#### Chlorophyll Comparisons

```{r}
#Chlorophyll Boxplot
FBC2 = ggplot(Dat) + aes(x = Tree.ID, y = Chl5,) + geom_boxplot(colour = "turquoise4") + ylab("Chlorophyll Measure") + xlab("F1") + ggtitle("F1 Chl After Correction") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$Chl5), colour = "orchid3")

grid.arrange(FBC,FBC2)

#Chl Mean Plot
FMC2 <-ggplot(Dat12) +aes(x = Tree.ID, y = Chl) + geom_point(colour = "turquoise3") +geom_hline(yintercept = mean(Dat12$Chl), colour = "orchid3")+ ylab("Chlorophyll") + xlab("Tree ID") + ggtitle("Chlorophyll of F1 Samples")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))

grid.arrange(FMC,FMC2)

#Histogram of Measurement Distribution
FHC2 <-ggplot(Dat12) +aes(Chl) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Chlorophyll") + ggtitle("Chlorophyll Distribution of F1 Trees After Correction") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))

grid.arrange(FHC,FHC2)

#Height Boxplot
HBC2 <- ggplot(Dat) + aes(x = Height, y = Chl5,) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Chlorophyll Measure") + xlab("Height") + ggtitle("Chl Height After Correction") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$Chl5))

grid.arrange(HBC,HBC2, ncol = 2)

#Height Histogram
HHC2 <-ggplot(Dat) +aes(Chl5,color=Height, fill=Height) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Chlorophyll") + ggtitle("Chlorophyll by Height After Correction") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))

grid.arrange(HHC,HHC2)

#Height Means
HMC2 <-ggplot(Dat) +aes(x = Tree.ID, y = Chl5, colour = Height, fill = Height) + geom_point() +geom_hline(yintercept = mean(Dat$Chl5), colour = "dodgerblue1")+ ylab("Chlorophyll") + xlab("Tree ID") + ggtitle("Chlorophyll Height Measures After Correction")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))

grid.arrange(HMC,HMC2)

#Row
#Boxplot Chlorophyll by Row
RoBC2 <- ggplot(Dat) + aes(x = Row, y = Chl5) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Chlorophyll Measure") + xlab("Row") + ggtitle("Chlorophyll by Row After Correction") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$Chl5), colour = "lightpink")

grid.arrange(RoBC,RoBC2)

#Mean Distribution
RoMC2 <-ggplot(Dat14) +aes(x = Row, y = Chl) + geom_point(colour = "turquoise3") +geom_hline(yintercept = mean(Dat14$Chl), colour = "orchid3")+ ylab("Chl") + xlab("Tree ID") + ggtitle("Chlorophyll Row Means After Correction")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))

grid.arrange(RoMC,RoMC2)

#Histogram
RoHC2 <-ggplot(Dat14) +aes(Chl) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Chlorophyll") + ggtitle("Chlorophyll Distribution of F1 Rows After Correction") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))

grid.arrange(RoHC,RoHC2)

#Column
#Boxplot Chlorophyll Column
CBC2 <- ggplot(Dat) + aes(x = Column, y = Chl5) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Chlorophyll Measure") + xlab("Column") + ggtitle("Chl Column After Correction") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$Chl5))

grid.arrange(CBC,CBC2, ncol=2)
```

#### Flavonol Comparisons

```{r}
#Flavonol Boxplot
FBF2 = ggplot(Dat) + aes(x = Tree.ID, y = Flav5,) + geom_boxplot(colour = "turquoise4") + ylab("Flavonol Measure") + xlab("F1") + ggtitle("F1 Flav After Correction") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$Flav5), colour = "orchid3")

grid.arrange(FBF,FBF2,ncol=1)

#Flav Mean Plot
FMF2 <-ggplot(Dat12) +aes(x = Tree.ID, y = Flav) + geom_point(colour = "turquoise3") +geom_hline(yintercept = mean(Dat12$Flav), colour = "orchid3")+ ylab("Flavonol") + xlab("Tree ID") + ggtitle("Flavonol of F1 Samples")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))

grid.arrange(FMF,FMF2)

#Histogram of Measurement Distribution
FHF2 <-ggplot(Dat12) +aes(Flav) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Flavonol") + ggtitle("Flavonol Distribution of F1 Trees After Correction") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))

grid.arrange(FHF,FHF2)

#Height Boxplot
HBF2 <- ggplot(Dat) + aes(x = Height, y = Flav5,) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Flavonol Measure") + xlab("Height") + ggtitle("Flav Height After Correction") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$Flav5))

grid.arrange(HBF,HBF2, ncol = 2)

#Height Histogram
HHF2 <-ggplot(Dat) +aes(Flav5,color=Height, fill=Height) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Flavonol") + ggtitle("Flavonol by Height After Correction") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))

grid.arrange(HHF,HHF2)

#Height Means
HMF2 <-ggplot(Dat) +aes(x = Tree.ID, y = Flav5, colour = Height, fill = Height) + geom_point() +geom_hline(yintercept = mean(Dat$Flav5), colour = "dodgerblue1")+ ylab("Flavonol") + xlab("Tree ID") + ggtitle("Flavonol Height Measures After Correction")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))

grid.arrange(HMF,HMF2)

#Row
#Boxplot Flavonol by Row
RoBF2 <- ggplot(Dat) + aes(x = Row, y = Flav5) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Flavonol Measure") + xlab("Row") + ggtitle("Flavonol by Row After Correction") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$Flav5), colour = "lightpink")

grid.arrange(RoBF,RoBF2)

#Mean Distribution
RoMF2 <-ggplot(Dat14) +aes(x = Row, y = Flav) + geom_point(colour = "turquoise3") +geom_hline(yintercept = mean(Dat14$Flav), colour = "orchid3")+ ylab("Flav") + xlab("Tree ID") + ggtitle("Flavonol Row Means After Correction")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))

grid.arrange(RoMF,RoMF2)

#Histogram
RoHF2 <-ggplot(Dat14) +aes(Flav) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Flavonol") + ggtitle("Flavonol Distribution of F1 Rows After Correction") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))

grid.arrange(RoHF,RoHF2)

#Column
#Boxplot Flavonol Column
CBF2 <- ggplot(Dat) + aes(x = Column, y = Flav5) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Flavonol Measure") + xlab("Column") + ggtitle("Flav Column After Correction") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$Flav5))

grid.arrange(CBF,CBF2, ncol=2)
```

#### Nitrogen Comparisons

```{r}
#Nitrogen Boxplot
FBN2 = ggplot(Dat) + aes(x = Tree.ID, y = NBI5,) + geom_boxplot(colour = "turquoise4") + ylab("Nitrogen Measure") + xlab("F1") + ggtitle("F1 NBI After Correction") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$NBI5), colour = "orchid3")

grid.arrange(FBN,FBN2)

#NBI Mean Plot
FMN2 <-ggplot(Dat12) +aes(x = Tree.ID, y = NBI) + geom_point(colour = "turquoise3") +geom_hline(yintercept = mean(Dat12$NBI), colour = "orchid3")+ ylab("Nitrogen") + xlab("Tree ID") + ggtitle("Nitrogen of F1 Samples")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))

grid.arrange(FMN,FMN2)

#Histogram of Measurement Distribution
FHN2 <-ggplot(Dat12) +aes(NBI) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Nitrogen") + ggtitle("Nitrogen Distribution of F1 Trees After Correction") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))

grid.arrange(FHN,FHN2)

#Height Boxplot
HBN2 <- ggplot(Dat) + aes(x = Height, y = NBI5,) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Nitrogen Measure") + xlab("Height") + ggtitle("NBI Height After Correction") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$NBI5))

grid.arrange(HBN,HBN2, ncol = 2)

#Height Histogram
HHN2 <-ggplot(Dat) +aes(NBI5,color=Height, fill=Height) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Nitrogen") + ggtitle("Nitrogen by Height After Correction") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))

grid.arrange(HHN,HHN2)

#Height Means
HMN2 <-ggplot(Dat) +aes(x = Tree.ID, y = NBI5, colour = Height, fill = Height) + geom_point() +geom_hline(yintercept = mean(Dat$NBI5), colour = "dodgerblue1")+ ylab("Nitrogen") + xlab("Tree ID") + ggtitle("Nitrogen Height Measures After Correction")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))

grid.arrange(HMN,HMN2)

#Row
#Boxplot Nitrogen by Row
RoBN2 <- ggplot(Dat) + aes(x = Row, y = NBI5) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Nitrogen Measure") + xlab("Row") + ggtitle("Nitrogen by Row After Correction") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$NBI5), colour = "lightpink")

grid.arrange(RoBN,RoBN2)

#Mean Distribution
RoMN2 <-ggplot(Dat14) +aes(x = Row, y = NBI) + geom_point(colour = "turquoise3") +geom_hline(yintercept = mean(Dat14$NBI), colour = "orchid3")+ ylab("NBI") + xlab("Tree ID") + ggtitle("Nitrogen Row Means After Correction")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))

grid.arrange(RoMN,RoMN2)

#Histogram
RoHN2 <-ggplot(Dat14) +aes(NBI) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Nitrogen") + ggtitle("Nitrogen Distribution of F1 Rows After Correction") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))

grid.arrange(RoHN,RoHN2)

#Column
#Boxplot Nitrogen Column
CBN2 <- ggplot(Dat) + aes(x = Column, y = NBI5) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Nitrogen Measure") + xlab("Column") + ggtitle("NBI Column After Correction") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dat$NBI5))

grid.arrange(CBN,CBN2, ncol=2)
```


#### Correlations Between Measures

Comparing correlations between the 4 dualex measures

```{r compare}
#Loes Method 
plot9 <-ggplot(Dat) + aes(x = Anth5, y = Chl5) + geom_point(shape = 21) +theme_bw() +geom_smooth()
plot10 <-ggplot(Dat) + aes(x = Anth5, y = Flav5) + geom_point(shape = 21) +theme_bw()+geom_smooth()
plot11<-ggplot(Dat) + aes(x = Anth5, y = NBI5) +geom_point(shape = 21) +theme_bw()+geom_smooth()
plot12<-ggplot(Dat) + aes(x = Chl5, y = Flav5) + geom_point(shape = 21) +theme_bw()+geom_smooth()
plot13<-ggplot(Dat) + aes(x = Chl5, y = NBI5) + geom_point(shape = 21) +theme_bw()+geom_smooth()
plot14<-ggplot(Dat) + aes(x = Flav5, y = NBI5) + geom_point(shape = 21) +theme_bw()+geom_smooth()
grid.arrange(plot9,plot10,plot11,plot12,plot13,plot14)

AnthComp = lm(Anth5 ~ Chl5*Flav5*NBI5, data = Dat)
anova(AnthComp)

ChlComp = lm(Chl5 ~ Anth5*Flav5*NBI5, data = Dat)
anova(ChlComp)

FlavComp = lm(Flav5 ~ Anth5*Chl5*NBI5, data = Dat)
anova(FlavComp)

NBIComp = lm(NBI5 ~ Anth5*Chl5*Flav5, data = Dat)
anova(NBIComp)
```

#### Flowering

```{r}
#Plots Flowering vs Non-Flowering
plot39<- ggplot(Dat) + aes(x = Flower, y = Anth5) + geom_boxplot()
plot40<- ggplot(Dat) + aes(x = Flower, y = Chl5) + geom_boxplot()
plot41<- ggplot(Dat) + aes(x = Flower, y = Flav5) + geom_boxplot()
plot42<- ggplot(Dat) + aes(x = Flower, y = NBI5) + geom_boxplot()

grid.arrange(plot39,plot40,plot41,plot42)

AF<- lm(Dat$Anth5 ~ Dat$Flower)
anova(AF)

CF<- lm(Dat$Chl5 ~ Dat$Flower)
anova(CF)

FF<- lm(Dat$Flav5 ~ Dat$Flower)
anova(FF)

NF<- lm(Dat$NBI5 ~ Dat$Flower)
anova(NF)
```
#### Environment and Height

```{r Heights from 2018}
EH = read.xlsx("HeightL.xlsx", sheetName = "Sheet1")
heatmaply(EH,Colv = FALSE, Rowv = FALSE, xlab = "Column",ylab = "Row", main = "Tree Height Across Planting Block")
```




