AnthDoc2 <-read.xlsx("DatHM2.xlsx", sheetName = "Anth")
heatmaply(AnthDoc2, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "Anth After Correction")
#Chlorophyll Heatmaps
ChlDoc<-read.xlsx("Chl.xlsx", sheetName = "Chl")
heatmaply(ChlDoc, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "Chl Before Correction")
ChlDoc2 <-read.xlsx("DatHM2.xlsx", sheetName = "Chl")
heatmaply(ChlDoc2, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "Chl After Correction")
#Flavonol Heatmaps
FlavDoc<-read.xlsx("Flav.xlsx", sheetName = "Flav")
heatmaply(FlavDoc, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "Flav Before Correction")
FlavDoc2 <-read.xlsx("DatHM2.xlsx", sheetName = "Flav")
heatmaply(FlavDoc2, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "Flav After Correction")
#NBI Heatmaps
NBIDoc<-read.xlsx("NBI.xlsx", sheetName = "NBI")
heatmaply(NBIDoc, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "NBI Before Correction")
NBIDoc2 <-read.xlsx("DatHM2.xlsx", sheetName = "NBI")
heatmaply(NBIDoc2, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "NBI After Correction")
plot9 <-ggplot(Dat) + aes(x = Anth4, y = Chl3) + geom_point()
plot10 <-ggplot(Dat) + aes(x = Anth4, y = Flav5) + geom_point()
plot11<-ggplot(Dat) + aes(x = Anth4, y = NBI4) + geom_point()
plot12<-ggplot(Dat) + aes(x = Chl3, y = Flav5) + geom_point()
plot13<-ggplot(Dat) + aes(x = Chl3, y = NBI4) + geom_point()
plot14<-ggplot(Dat) + aes(x = Flav5, y = NBI4) + geom_point()
grid.arrange(plot9,plot10,plot11,plot12,plot13,plot14)
AnthComp = lm(Anth4 ~ Chl3*Flav5*NBI4, data = Dat)
anova(AnthComp)
ChlComp = lm(Chl3 ~ Anth4*Flav5*NBI4, data = Dat)
anova(ChlComp)
FlavComp = lm(Flav5 ~ Anth4*Chl3*NBI4, data = Dat)
anova(FlavComp)
NBIComp = lm(NBI4 ~ Anth4*Chl3*Flav5, data = Dat)
anova(NBIComp)
#Plots Flowering vs Non-Flowering
plot39<- ggplot(Dat) + aes(x = Flower, y = Anth4) + geom_boxplot()
plot40<- ggplot(Dat) + aes(x = Flower, y = Chl3) + geom_boxplot()
plot41<- ggplot(Dat) + aes(x = Flower, y = Flav5) + geom_boxplot()
plot42<- ggplot(Dat) + aes(x = Flower, y = NBI4) + geom_boxplot()
grid.arrange(plot39,plot40,plot41,plot42)
AF<- lm(Dat$Anth4 ~ Dat$Flower)
anova(AF)
CF<- lm(Dat$Chl3 ~ Dat$Flower)
anova(CF)
FF<- lm(Dat$Flav5 ~ Dat$Flower)
anova(FF)
NF<- lm(Dat$NBI4 ~ Dat$Flower)
anova(NF)
View(Dat)
DatC = group_by(Dat, Tree.ID)
View(DatC)
DatC = summarise(DatC, Anth = mean(Anth4,na.rm = T), Chl = mean(Chl3,na.rm = T), Flav = mean(Flav5,na.rm = T), NBI = mean(NBI4,na.rm = T))
View(DatC)
#Boxplot
Cplot1 <- ggplot(DatC) + aes(x = Tree.ID, y = Anth ) + geom_boxplot() + ylab("Anth Measure") + xlab("Tree ID") + ggtitle("Anth of F1 after Corrections");plotCplot1
#Boxplot
Cplot1 <- ggplot(DatC) + aes(x = Tree.ID, y = Anth ) + geom_boxplot() + ylab("Anth Measure") + xlab("Tree ID") + ggtitle("Anth of F1 after Corrections");Cplot1
#Scatter
Cplot11 <-ggplot(Dat) +aes(x = Tree.ID, y = Anth4) + geom_point()+ ylab("Anth Measure") + xlab("Tree ID") + ggtitle("Anth of F1 after Corrections");Cplot11
#Scatter
Cplot11 <-ggplot(Dat) +aes(x = Tree.ID, y = Anth4) + geom_boxplot()+ ylab("Anth Measure") + xlab("Tree ID") + ggtitle("Anth of F1 after Corrections");Cplot11
#Boxplot
Cplot1 <- ggplot(DatC) + aes(x = Tree.ID, y = Anth ) + geom_point() + ylab("Anth Measure") + xlab("Tree ID") + ggtitle("Anth of F1 after Corrections");Cplot1
#Histogram
Cplot12 <-ggplot(DatC) +aes(Anth) +geom_histogram() + stat_bin(binwidth = 2) + ylab("Frequency") + xlab("Anth Measure") + ggtitle("Anth of F1 after Corrections");Cplot12
#Histogram
Cplot12 <-ggplot(DatC) +aes(Anth) +geom_histogram() + stat_bin(binwidth = 30) + ylab("Frequency") + xlab("Anth Measure") + ggtitle("Anth of F1 after Corrections");Cplot12
#Histogram
Cplot12 <-ggplot(Dat) +aes(Anth4) +geom_histogram() + stat_bin(binwidth = 30) + ylab("Frequency") + xlab("Anth Measure") + ggtitle("Anth of F1 after Corrections");Cplot12
#Histogram
Cplot12 <-ggplot(Dat) +aes(Anth4) +geom_histogram() + stat_bin(binwidth = 0.001) + ylab("Frequency") + xlab("Anth Measure") + ggtitle("Anth of F1 after Corrections");Cplot12
#Histogram
Cplot12 <-ggplot(DatC) +aes(Anth4) +geom_histogram() + stat_bin(binwidth = 0.001) + ylab("Frequency") + xlab("Anth Measure") + ggtitle("Anth of F1 after Corrections");Cplot12
#Histogram
Cplot12 <-ggplot(DatC) +aes(Anth) +geom_histogram() + stat_bin(binwidth = 0.001) + ylab("Frequency") + xlab("Anth Measure") + ggtitle("Anth of F1 after Corrections");Cplot12
DatC = group_by(Dat, Tree.ID)
DatC = summarise(DatC, Anth = mean(Anth4,na.rm = T), Chl = mean(Chl3,na.rm = T), Flav = mean(Flav5,na.rm = T), NBI = mean(NBI4,na.rm = T))
#Anthocyanin
#Boxplot
Cplot1 <-ggplot(Dat) +aes(x = Tree.ID, y = Anth4) + geom_boxplot()+ ylab("Anth Measure") + xlab("Tree ID") + ggtitle("Anth of F1 after Corrections");Cplot1
#Scatter
Cplot11 <- ggplot(DatC) + aes(x = Tree.ID, y = Anth ) + geom_point() + ylab("Anth Measure") + xlab("Tree ID") + ggtitle("Anth of F1 after Corrections");Cplot11
#Histogram
Cplot12 <-ggplot(DatC) +aes(Anth) +geom_histogram() + stat_bin(binwidth = 0.001) + ylab("Frequency") + xlab("Anth Measure") + ggtitle("Anth of F1 after Corrections")
grid.arrange(Cplot11,Cplot12)
mean(DatC$Ant)
mean(DatC$Anth)
Cplot2 <-ggplot(Dat) +aes(x = Tree.ID, y = Chl3) + geom_boxplot()+ ylab("Chl Measure") + xlab("Tree ID") + ggtitle("Chl of F1 after Corrections");Cplot2
#Scatter
Cplot21 <- ggplot(DatC) + aes(x = Tree.ID, y = Chl) + geom_point() + ylab("Chl Measure") + xlab("Tree ID") + ggtitle("Chl of F1 after Corrections")
#Histogram
Cplot22 <-ggplot(DatC) +aes(Chl) +geom_histogram() + stat_bin(binwidth = 0.01) + ylab("Frequency") + xlab("Chl Measure") + ggtitle("Chl of F1 after Corrections")
grid.arrange(Cplot11,Cplot12)
#Chlorophyll
#Boxplot
Cplot2 <-ggplot(Dat) +aes(x = Tree.ID, y = Chl3) + geom_boxplot()+ ylab("Chl Measure") + xlab("Tree ID") + ggtitle("Chl of F1 after Corrections");Cplot2
#Scatter
Cplot21 <- ggplot(DatC) + aes(x = Tree.ID, y = Chl) + geom_point() + ylab("Chl Measure") + xlab("Tree ID") + ggtitle("Chl of F1 after Corrections")
#Histogram
Cplot22 <-ggplot(DatC) +aes(Chl) +geom_histogram() + stat_bin(binwidth = 0.01) + ylab("Frequency") + xlab("Chl Measure") + ggtitle("Chl of F1 after Corrections")
grid.arrange(Cplot21,Cplot22)
#Flavonol
#Boxplot
Cplot3 <-ggplot(Dat) +aes(x = Tree.ID, y = Flav5) + geom_boxplot()+ ylab("Flav Measure") + xlab("Tree ID") + ggtitle("Flav of F1 after Corrections");Cplot3
#Scatter
Cplot31 <- ggplot(DatC) + aes(x = Tree.ID, y = Flav ) + geom_point() + ylab("Flav Measure") + xlab("Tree ID") + ggtitle("Flav of F1 after Corrections")
#Histogram
Cplot32 <-ggplot(DatC) +aes(Flav) +geom_histogram() + stat_bin(binwidth = 0.001) + ylab("Frequency") + xlab("Flav Measure") + ggtitle("Flav of F1 after Corrections")
grid.arrange(Cplot31,Cplot32)
#Boxplot
Cplot4 <-ggplot(Dat) +aes(x = Tree.ID, y = NBI4) + geom_boxplot()+ ylab("NBI Measure") + xlab("Tree ID") + ggtitle("NBI of F1 after Corrections");Cplot4
#Scatter
Cplot41 <- ggplot(DatC) + aes(x = Tree.ID, y = NBI ) + geom_point() + ylab("NBI Measure") + xlab("Tree ID") + ggtitle("NBI of F1 after Corrections")
#Histogram
Cplot42 <-ggplot(DatC) +aes(NBI) +geom_histogram() + stat_bin(binwidth = 0.001) + ylab("Frequency") + xlab("NBI Measure") + ggtitle("NBI of F1 after Corrections")
grid.arrange(Cplot11,Cplot12)
Cplot4 <-ggplot(Dat) +aes(x = Tree.ID, y = NBI4) + geom_boxplot()+ ylab("NBI Measure") + xlab("Tree ID") + ggtitle("NBI of F1 after Corrections");Cplot4
#Scatter
Cplot41 <- ggplot(DatC) + aes(x = Tree.ID, y = NBI ) + geom_point() + ylab("NBI Measure") + xlab("Tree ID") + ggtitle("NBI of F1 after Corrections")
#Histogram
Cplot42 <-ggplot(DatC) +aes(NBI) +geom_histogram() + stat_bin(binwidth = 0.001) + ylab("Frequency") + xlab("NBI Measure") + ggtitle("NBI of F1 after Corrections")
grid.arrange(Cplot41,Cplot42)
#Anthocyanin
#Boxplot
Cplot1 <-ggplot(Dat) +aes(x = Tree.ID, y = Anth4) + geom_boxplot()+ ylab("Anth Measure") + xlab("Tree ID") + ggtitle("Anth of F1 after Corrections");Cplot1
#Scatter
Cplot11 <- ggplot(DatC) + aes(x = Tree.ID, y = Anth ) + geom_point() + ylab("Anth Measure") + xlab("Tree ID") + ggtitle("Anth of F1 after Corrections")
#Histogram
Cplot12 <-ggplot(DatC) +aes(Anth) +geom_histogram() + stat_bin(binwidth = 0.001) + ylab("Frequency") + xlab("Anth Measure") + ggtitle("Anth of F1 after Corrections")
grid.arrange(Cplot11,Cplot12)
mean(Dat$Anth4)
mean(DatC$Anth)
summary(DatC$Anth)
summary(F1$Anth)
#Anthocyanin
#Boxplot
Cplot1 <-ggplot(Dat) +aes(x = Tree.ID, y = Anth4) + geom_boxplot()+ ylab("Anth Measure") + xlab("Tree ID") + ggtitle("Anth of F1 after Corrections");Cplot1
#Scatter
Cplot11 <- ggplot(DatC) + aes(x = Tree.ID, y = Anth ) + geom_point() + ylab("Anth Measure") + xlab("Tree ID") + ggtitle("Anth of F1 after Corrections")
#Histogram
Cplot12 <-ggplot(DatC) +aes(Anth) +geom_histogram() + stat_bin(binwidth = 0.001) + ylab("Frequency") + xlab("Anth Measure") + ggtitle("Anth of F1 after Corrections")
grid.arrange(Cplot11,Cplot12)
#Previous distribution
grid.arrange(FAnth,FHAnth)
grid.arrange(Cplot1,Cplot12)
#Previous distribution
grid.arrange(FAnth,FHAnth)
#Histogram
Cplot12 <-ggplot(Dat) +aes(Anth4) +geom_histogram() + stat_bin(binwidth = 0.001) + ylab("Frequency") + xlab("Anth Measure") + ggtitle("Anth of F1 after Corrections")
grid.arrange(Cplot1,Cplot12)
grid.arrange(Cplot1,Cplot12)
#Previous distribution
grid.arrange(FAnth,FHAnth)
grid.arrange(Cplot2,Cplot22)
grid.arrange(Cplot2,Cplot22)
grid.arrange(FChl,FHChl)
#Previous Distribution
grid.arrange(FFlav,FHFlav)
grid.arrange(Cplot3,Cplot32)
#Previous Distribution
grid.arrange(FFlav,FHFlav)
Cplot32
#Anthocyanin
CAM = mean(DatC$Anth)
#Anthocyanin
CAM = mean(Dat$Anth4)
#Boxplot
Cplot1 <-ggplot(Dat) +aes(x = Tree.ID, y = Anth4) + geom_boxplot()+ ylab("Anth Measure") + xlab("Tree ID") + ggtitle("Anth of F1 after Corrections")+geom_hline(yintercept = CAM);Cplot1
grid.arrange(Cplot1,Cplot12)
DatC = group_by(Dat, Tree.ID)
DatC = summarise(DatC, Anth = mean(Anth4,na.rm = T), Chl = mean(Chl3,na.rm = T), Flav = mean(Flav5,na.rm = T), NBI = mean(NBI4,na.rm = T))
#Anthocyanin
CAM = mean(Dat$Anth4)
#Boxplot
Cplot1 <-ggplot(Dat) +aes(x = Tree.ID, y = Anth4) + geom_boxplot()+ ylab("Anth Measure") + xlab("Tree ID") + ggtitle("Anth of F1 after Corrections")+geom_hline(yintercept = CAM);Cplot1
#Histogram
Cplot12 <-ggplot(DatC) +aes(Anth) +geom_histogram() + stat_bin(binwidth = 0.001) + ylab("Frequency") + xlab("Anth Measure") + ggtitle("Anth of F1 after Corrections")
grid.arrange(Cplot1,Cplot12)
#Previous distribution
grid.arrange(FAnth,FHAnth)
#Chlorophyll
CCM = mean(Dat$Chl3)
#Boxplot
Cplot2 <-ggplot(Dat) +aes(x = Tree.ID, y = Chl3) + geom_boxplot()+ ylab("Chl Measure") + xlab("Tree ID") + ggtitle("Chl of F1 after Corrections")+geom_hline(yintercept = CCM);Cplot2
#Histogram
Cplot22 <-ggplot(DatC) +aes(Chl) +geom_histogram() + stat_bin(binwidth = 0.01) + ylab("Frequency") + xlab("Chl Measure") + ggtitle("Chl of F1 after Corrections")
grid.arrange(Cplot2,Cplot22)
#Previous Distribution
grid.arrange(FChl,FHChl)
#Flavonol
CFM = mean(Dat$Flav5)
#Boxplot
Cplot3 <-ggplot(Dat) +aes(x = Tree.ID, y = Flav5) + geom_boxplot()+ ylab("Flav Measure") + xlab("Tree ID") + ggtitle("Flav of F1 after Corrections"+geom_hline(yintercept = CFM));Cplot3
#Histogram
Cplot32 <-ggplot(DatC) +aes(Flav) +geom_histogram() + stat_bin(binwidth = 0.001) + ylab("Frequency") + xlab("Flav Measure") + ggtitle("Flav of F1 after Corrections")
grid.arrange(Cplot3,Cplot32)
#Previous Distribution
grid.arrange(FFlav,FHFlav)
#NBI
CNM = mean(Dat$NBI4)
#Boxplot
Cplot4 <-ggplot(Dat) +aes(x = Tree.ID, y = NBI4) + geom_boxplot()+ ylab("NBI Measure") + xlab("Tree ID") + ggtitle("NBI of F1 after Corrections")+geom_hline(yintercept = CNM);Cplot4
#Histogram
Cplot42 <-ggplot(DatC) +aes(NBI) +geom_histogram() + stat_bin(binwidth = 0.001) + ylab("Frequency") + xlab("NBI Measure") + ggtitle("NBI of F1 after Corrections")
grid.arrange(Cplot41,Cplot42)
#Previous Distribution
grid.arrange(FNBI,FHNBI)
#Boxplot
Cplot3 <-ggplot(Dat) +aes(x = Tree.ID, y = Flav5) + geom_boxplot()+ ylab("Flav Measure") + xlab("Tree ID") + ggtitle("Flav of F1 after Corrections"+geom_hline(yintercept = CFM,color = "purple4"))
#Histogram
Cplot32 <-ggplot(DatC) +aes(Flav) +geom_histogram() + stat_bin(binwidth = 0.001) + ylab("Frequency") + xlab("Flav Measure") + ggtitle("Flav of F1 after Corrections")
grid.arrange(Cplot3,Cplot32)
DatC = group_by(Dat, Tree.ID)
DatC = summarise(DatC, Anth = mean(Anth4,na.rm = T), Chl = mean(Chl3,na.rm = T), Flav = mean(Flav5,na.rm = T), NBI = mean(NBI4,na.rm = T))
#Anthocyanin
CAM = mean(Dat$Anth4)
#Boxplot
Cplot1 <-ggplot(Dat) +aes(x = Tree.ID, y = Anth4) + geom_boxplot()+ ylab("Anth Measure") + xlab("Tree ID") + ggtitle("Anth of F1 after Corrections")+geom_hline(yintercept = CAM)
Cplot12 <-ggplot(DatC) +aes(Anth) +geom_histogram() + stat_bin(binwidth = 0.001) + ylab("Frequency") + xlab("Anth Measure") + ggtitle("Anth of F1 after Corrections")
grid.arrange(Cplot1,Cplot12)
#Previous distribution
grid.arrange(FAnth,FHAnth)
#Chlorophyll
CCM = mean(Dat$Chl3)
#Boxplot
Cplot2 <-ggplot(Dat) +aes(x = Tree.ID, y = Chl3) + geom_boxplot()+ ylab("Chl Measure") + xlab("Tree ID") + ggtitle("Chl of F1 after Corrections")+geom_hline(yintercept = CCM)
#Histogram
Cplot22 <-ggplot(DatC) +aes(Chl) +geom_histogram() + stat_bin(binwidth = 0.01) + ylab("Frequency") + xlab("Chl Measure") + ggtitle("Chl of F1 after Corrections")
grid.arrange(Cplot2,Cplot22)
#Previous Distribution
grid.arrange(FChl,FHChl)
#Flavonol
CFM = mean(Dat$Flav5)
#Boxplot
Cplot3 <-ggplot(Dat) +aes(x = Tree.ID, y = Flav5) + geom_boxplot()+ ylab("Flav Measure") + xlab("Tree ID") + ggtitle("Flav of F1 after Corrections"+geom_hline(yintercept = CFM,color = "purple4"))
#Histogram
Cplot32 <-ggplot(DatC) +aes(Flav) +geom_histogram() + stat_bin(binwidth = 0.001) + ylab("Frequency") + xlab("Flav Measure") + ggtitle("Flav of F1 after Corrections")
grid.arrange(Cplot3,Cplot32)
#Previous Distribution
grid.arrange(FFlav,FHFlav)
#NBI
CNM = mean(Dat$NBI4)
#Boxplot
Cplot4 <-ggplot(Dat) +aes(x = Tree.ID, y = NBI4) + geom_boxplot()+ ylab("NBI Measure") + xlab("Tree ID") + ggtitle("NBI of F1 after Corrections")+geom_hline(yintercept = CNM);Cplot4
#Histogram
Cplot42 <-ggplot(DatC) +aes(NBI) +geom_histogram() + stat_bin(binwidth = 0.001) + ylab("Frequency") + xlab("NBI Measure") + ggtitle("NBI of F1 after Corrections")
grid.arrange(Cplot41,Cplot42)
#Previous Distribution
grid.arrange(FNBI,FHNBI)
#Height
#Boxplot
Cplot1 <-ggplot(Dat) +aes(x = Height, y = Anth4) + geom_boxplot()+ ylab("Anth Measure") + xlab("Tree ID") + ggtitle("Anth of F1 after Corrections")+geom_hline(yintercept = CAM)
#Boxplot
Cplot12 <-ggplot(Dat) +aes(x = Height, y = Anth4) + geom_boxplot()+ ylab("Anth Measure") + xlab("Tree ID") + ggtitle("Anth of F1 after Corrections")+geom_hline(yintercept = CAM)
#Previous distribution
CAnth
#Boxplot
Cplot12 <-ggplot(Dat) +aes(x = Height, y = Anth4) + geom_boxplot()+ ylab("Anth Measure") + xlab("Tree ID") + ggtitle("Anth of F1 after Corrections")+geom_hline(yintercept = CAM)
#Previous distribution
CAnth
#Height
#Boxplot
Cplot12 <-ggplot(Dat) +aes(x = Height, y = Anth4) + geom_boxplot()+ ylab("Anth Measure") + xlab("Tree ID") + ggtitle("Anth of F1 after Corrections")+geom_hline(yintercept = CAM);Cplot12
#Previous distribution
CAnth
#Boxplot
Cplot12 <-ggplot(Dat) +aes(x = Height, y = Anth4) + geom_boxplot()+ ylab("Anth Measure") + xlab("Tree ID") + ggtitle("Anth of F1 after Corrections")+geom_hline(yintercept = CAM);Cplot12
#Previous distribution
CAnth
#Height
#Boxplot
Cplot12 <-ggplot(Dat) +aes(x = Column, y = Anth4) + geom_boxplot()+ ylab("Anth Measure") + xlab("Tree ID") + ggtitle("Anth of F1 after Corrections")+geom_hline(yintercept = CAM);Cplot12
#Boxplot
Cplot12 <-ggplot(Dat) +aes(x = Column, y = Anth4) + geom_boxplot()+ ylab("Anth Measure") + xlab("Tree ID") + ggtitle("Anth of F1 after Corrections")+geom_hline(yintercept = CAM);Cplot12
#Previous distribution
CAnth
#Previous distribution
grid.arrange(CAnth,Cplot12)
#Previous distribution
grid.arrange(CAnth,Cplot12, ncol = 2)
grid.arrange(Cplot1,FAnth)
grid.arrange(Cplot1,FAnth, ncol = 2)
#Previous distribution
grid.arrange(CAnth,Cplot12, ncol = 2)
# Row Boxplot
Cplot13 <-ggplot(Dat) +aes(x = Row, y = Anth4) + geom_boxplot()+ ylab("Anth Measure") + xlab("Row") + ggtitle("Anth of F1 after Corrections")+geom_hline(yintercept = CAM)
grid.arrange(RoAnth, Cplot13)
RoAnth
Cplot13 <-ggplot(Dat) +aes(x = Row, y = Anth4) + geom_boxplot()+ ylab("Anth Measure") + xlab("Row") + ggtitle("Anth of F1 after Corrections")+geom_hline(yintercept = CAM);Cplot13
#Height Compare
Cplot14 <-ggplot(Dat) +aes(x = Height, y = Anth4) + geom_boxplot()+ ylab("Anth Measure") + xlab("Height") + ggtitle("Anth of F1 after Corrections")+geom_hline(yintercept = CAM)
grid.arrange(HAnth,Cplot14)
grid.arrange(HAnth,Cplot14,ncol=2)
#Chlorophyll
CCM = mean(Dat$Chl3)
#Boxplot
Cplot2 <-ggplot(Dat) +aes(x = Tree.ID, y = Chl3) + geom_boxplot()+ ylab("Chl Measure") + xlab("Tree ID") + ggtitle("Chl of F1 after Corrections")+geom_hline(yintercept = CCM)
#Histogram
Cplot21 <-ggplot(DatC) +aes(Chl) +geom_histogram() + stat_bin(binwidth = 0.01) + ylab("Frequency") + xlab("Chl Measure") + ggtitle("Chl of F1 after Corrections")
grid.arrange(Cplot2,Cplot21)
#Previous Distribution
grid.arrange(FChl,FHChl)
#Column Compare
Cplot22 <-ggplot(Dat) +aes(x = Column, y = Chl3) + geom_boxplot()+ ylab("Chl Measure") + xlab("Tree ID") + ggtitle("Chl of F1 after Corrections")+geom_hline(yintercept = CAM)
#Previous distribution
grid.arrange(CChl,Cplot22, ncol = 2)
# Row Compare
RoChl
Cplot23 <-ggplot(Dat) +aes(x = Row, y = Chl3) + geom_boxplot()+ ylab("Chl Measure") + xlab("Row") + ggtitle("Chl of F1 after Corrections")+geom_hline(yintercept = CAM);Cplot13
#Height Compare
Cplot24 <-ggplot(Dat) +aes(x = Height, y = Chl3) + geom_boxplot()+ ylab("Chl Measure") + xlab("Height") + ggtitle("Chl of F1 after Corrections")+geom_hline(yintercept = CAM)
grid.arrange(HChl,Cplot24,ncol=2)
#Chlorophyll
CCM = mean(Dat$Chl3)
#Boxplot
Cplot2 <-ggplot(Dat) +aes(x = Tree.ID, y = Chl3) + geom_boxplot()+ ylab("Chl Measure") + xlab("Tree ID") + ggtitle("Chl of F1 after Corrections")+geom_hline(yintercept = CCM)
#Histogram
Cplot21 <-ggplot(DatC) +aes(Chl) +geom_histogram() + stat_bin(binwidth = 0.01) + ylab("Frequency") + xlab("Chl Measure") + ggtitle("Chl of F1 after Corrections")
grid.arrange(Cplot2,Cplot21)
#Previous Distribution
grid.arrange(FChl,FHChl)
#Column Compare
Cplot22 <-ggplot(Dat) +aes(x = Column, y = Chl3) + geom_boxplot()+ ylab("Chl Measure") + xlab("Tree ID") + ggtitle("Chl of F1 after Corrections")+geom_hline(yintercept = CAM)
#Previous distribution
grid.arrange(CChl,Cplot22, ncol = 2)
# Row Compare
RoChl
Cplot23 <-ggplot(Dat) +aes(x = Row, y = Chl3) + geom_boxplot()+ ylab("Chl Measure") + xlab("Row") + ggtitle("Chl of F1 after Corrections")+geom_hline(yintercept = CAM);Cplot23
#Height Compare
Cplot24 <-ggplot(Dat) +aes(x = Height, y = Chl3) + geom_boxplot()+ ylab("Chl Measure") + xlab("Height") + ggtitle("Chl of F1 after Corrections")+geom_hline(yintercept = CAM)
grid.arrange(HChl,Cplot24,ncol=2)
#Chlorophyll
CCM = mean(Dat$Chl3)
#Boxplot
Cplot2 <-ggplot(Dat) +aes(x = Tree.ID, y = Chl3) + geom_boxplot()+ ylab("Chl Measure") + xlab("Tree ID") + ggtitle("Chl of F1 after Corrections")+geom_hline(yintercept = CCM)
#Histogram
Cplot21 <-ggplot(DatC) +aes(Chl) +geom_histogram() + stat_bin(binwidth = 0.01) + ylab("Frequency") + xlab("Chl Measure") + ggtitle("Chl of F1 after Corrections")
grid.arrange(Cplot2,Cplot21)
#Previous Distribution
grid.arrange(FChl,FHChl)
#Column Compare
Cplot22 <-ggplot(Dat) +aes(x = Column, y = Chl3) + geom_boxplot()+ ylab("Chl Measure") + xlab("Column") + ggtitle("Chl of F1 after Corrections")+geom_hline(yintercept = CAM)
#Previous distribution
grid.arrange(CChl,Cplot22, ncol = 2)
# Row Compare
RoChl
Cplot23 <-ggplot(Dat) +aes(x = Row, y = Chl3) + geom_boxplot()+ ylab("Chl Measure") + xlab("Row") + ggtitle("Chl of F1 after Corrections")+geom_hline(yintercept = CAM);Cplot23
#Height Compare
Cplot24 <-ggplot(Dat) +aes(x = Height, y = Chl3) + geom_boxplot()+ ylab("Chl Measure") + xlab("Height") + ggtitle("Chl of F1 after Corrections")+geom_hline(yintercept = CAM)
grid.arrange(HChl,Cplot24,ncol=2)
#Flavonol
CFM = mean(Dat$Flav5)
#Boxplot
Cplot3 <-ggplot(Dat) +aes(x = Tree.ID, y = Flav5) + geom_boxplot()+ ylab("Flav Measure") + xlab("Tree ID") + ggtitle("Flav of F1 after Corrections"+geom_hline(yintercept = CFM,color = "purple4"))
#Histogram
Cplot31 <-ggplot(DatC) +aes(Flav) +geom_histogram() + stat_bin(binwidth = 0.001) + ylab("Frequency") + xlab("Flav Measure") + ggtitle("Flav of F1 after Corrections")
grid.arrange(Cplot3,Cplot31)
#Previous Distribution
grid.arrange(FFlav,FHFlav)
#Column Compare
Cplot32 <-ggplot(Dat) +aes(x = Column, y = Flav5) + geom_boxplot()+ ylab("Flav Measure") + xlab("Column") + ggtitle("Flav of F1 after Corrections")+geom_hline(yintercept = CFM)
#Previous distribution
grid.arrange(CFlav,Cplot32, ncol = 2)
# Row Compare
RoFlav
Cplot33 <-ggplot(Dat) +aes(x = Row, y = Flav5) + geom_boxplot()+ ylab("Flav Measure") + xlab("Row") + ggtitle("Flav of F1 after Corrections")+geom_hline(yintercept = CFM);Cplot33
#Height Compare
Cplot14 <-ggplot(Dat) +aes(x = Height, y = Anth4) + geom_boxplot()+ ylab("Anth Measure") + xlab("Height") + ggtitle("Anth of F1 after Corrections")+geom_hline(yintercept = CFM)
grid.arrange(HFlav,Cplot34,ncol=2)
#Flavonol
CFM = mean(Dat$Flav5)
#Boxplot
Cplot3 <-ggplot(Dat) +aes(x = Tree.ID, y = Flav5) + geom_boxplot()+ ylab("Flav Measure") + xlab("Tree ID") + ggtitle("Flav of F1 after Corrections"+geom_hline(yintercept = CFM,color = "purple4"))
#Histogram
Cplot31 <-ggplot(DatC) +aes(Flav) +geom_histogram() + stat_bin(binwidth = 0.001) + ylab("Frequency") + xlab("Flav Measure") + ggtitle("Flav of F1 after Corrections")
grid.arrange(Cplot3,Cplot31)
#Previous Distribution
grid.arrange(FFlav,FHFlav)
#Column Compare
Cplot32 <-ggplot(Dat) +aes(x = Column, y = Flav5) + geom_boxplot()+ ylab("Flav Measure") + xlab("Column") + ggtitle("Flav of F1 after Corrections")+geom_hline(yintercept = CFM)
#Previous distribution
grid.arrange(CFlav,Cplot32, ncol = 2)
# Row Compare
RoFlav
Cplot33 <-ggplot(Dat) +aes(x = Row, y = Flav5) + geom_boxplot()+ ylab("Flav Measure") + xlab("Row") + ggtitle("Flav of F1 after Corrections")+geom_hline(yintercept = CFM);Cplot33
#Height Compare
Cplot34 <-ggplot(Dat) +aes(x = Height, y = Anth4) + geom_boxplot()+ ylab("Anth Measure") + xlab("Height") + ggtitle("Anth of F1 after Corrections")+geom_hline(yintercept = CFM)
grid.arrange(HFlav,Cplot34,ncol=2)
#NBI
CNM = mean(Dat$NBI4)
#Boxplot
Cplot4 <-ggplot(Dat) +aes(x = Tree.ID, y = NBI4) + geom_boxplot()+ ylab("NBI Measure") + xlab("Tree ID") + ggtitle("NBI of F1 after Corrections")+geom_hline(yintercept = CNM)
#Histogram
Cplot41 <-ggplot(DatC) +aes(NBI) +geom_histogram() + stat_bin(binwidth = 0.001) + ylab("Frequency") + xlab("NBI Measure") + ggtitle("NBI of F1 after Corrections")
grid.arrange(Cplot4,Cplot41)
#Previous Distribution
grid.arrange(FNBI,FHNBI)
#Column Compare
Cplot42 <-ggplot(Dat) +aes(x = Column, y = NBI4) + geom_boxplot()+ ylab("NBI Measure") + xlab("Column") + ggtitle("NBI of F1 after Corrections")+geom_hline(yintercept = CNM)
#Previous distribution
grid.arrange(CNBI,Cplot42, ncol = 2)
# Row Compare
RoNBI
Cplot43 <-ggplot(Dat) +aes(x = Row, y = NBI4) + geom_boxplot()+ ylab("NBI Measure") + xlab("Row") + ggtitle("NBI of F1 after Corrections")+geom_hline(yintercept = CNM);Cplot43
#Height Compare
Cplot44 <-ggplot(Dat) +aes(x = Height, y = NBI4) + geom_boxplot()+ ylab("NBI Measure") + xlab("Height") + ggtitle("NBI of F1 after Corrections")+geom_hline(yintercept = CNM)
grid.arrange(HAnth,Cplot14,ncol=2)
#NBI
CNM = mean(Dat$NBI4)
#Boxplot
Cplot4 <-ggplot(Dat) +aes(x = Tree.ID, y = NBI4) + geom_boxplot()+ ylab("NBI Measure") + xlab("Tree ID") + ggtitle("NBI of F1 after Corrections")+geom_hline(yintercept = CNM)
#Histogram
Cplot41 <-ggplot(DatC) +aes(NBI) +geom_histogram() + stat_bin(binwidth = 0.001) + ylab("Frequency") + xlab("NBI Measure") + ggtitle("NBI of F1 after Corrections")
grid.arrange(Cplot4,Cplot41)
#Previous Distribution
grid.arrange(FNBI,FHNBI)
#Column Compare
Cplot42 <-ggplot(Dat) +aes(x = Column, y = NBI4) + geom_boxplot()+ ylab("NBI Measure") + xlab("Column") + ggtitle("NBI of F1 after Corrections")+geom_hline(yintercept = CNM)
#Previous distribution
grid.arrange(CNBI,Cplot42, ncol = 2)
# Row Compare
RoNBI
Cplot43 <-ggplot(Dat) +aes(x = Row, y = NBI4) + geom_boxplot()+ ylab("NBI Measure") + xlab("Row") + ggtitle("NBI of F1 after Corrections")+geom_hline(yintercept = CNM);Cplot43
#Height Compare
Cplot44 <-ggplot(Dat) +aes(x = Height, y = NBI4) + geom_boxplot()+ ylab("NBI Measure") + xlab("Height") + ggtitle("NBI of F1 after Corrections")+geom_hline(yintercept = CNM)
grid.arrange(HNBI,Cplot44,ncol=2)
setwd("~/leafy-green/Code Peter Jaksons")
library(xlsx)
library(ggplot2)
library(dplyr)
library(asreml)
library(asremlPlus)
library(nadiv)
library(gridExtra)
library(knitr)
library(gridExtra)
library(grid)
library(reshape2)
library(gplots)
library(sommer)
install.packages("asreml","asremlPlus","nadiv","sommer")
library(xlsx)
library(ggplot2)
library(dplyr)
library(asreml)
library(asremlPlus)
library(nadiv)
library(gridExtra)
library(knitr)
library(gridExtra)
library(grid)
library(reshape2)
library(gplots)
library(sommer)
install.packages("asreml","asremlPlus","nadiv","sommer")
##### read data #####
data_D <- read.xlsx("Height phenotype 20 April 2018.xlsx",sheetName = "Phenotypes April 2018",startRow = 1)
snp_D <- read.csv("EC103xEC201_GBS_40clusters_abxaa.csv",header=T)
corr_D <- read.xlsx("Similarity of individuals Joinmap calculated.xlsx",sheetIndex = 2,startRow = 1)
##### data mgmt #####
data_D <- data_D[,1:5]
data_D <- data_D[!is.na(data_D$NA.),]
data_D$id <- paste0("X",data_D$NA.)
data_D$Rowf <- as.factor(data_D$Row)
data_D$Treef <- as.factor(data_D$Tree)
snp_D[snp_D=="--"] <- NA
snp_D[snp_D=="aa"] <- 0
snp_D[snp_D=="ab"] <- 1
snp_D[snp_D=="bb"] <- 2
snp_D <- snp_D[,-1]
rownames_C <- colnames(snp_D)
snp_M <- data.matrix(snp_D)
snp_M <- t(snp_M)
snp_M <- snp_M[row.names(snp_M) %in% data_D$id,]
A <-  A.mat(snp_M[])
A[1:10,1:10]
colfunc <- colorRampPalette(c("steelblue4","springgreen","yellow"))
heatmap.2(A[1:100,1:100], col = colfunc(100),Colv = "Rowv",revC=TRUE)
#
# library(gdata)
# lowerTriangle(corr_M) <- upperTriangle(corr_M)
# upperTriangle(corr_M) <- lowerTriangle(corr_M)
# A <- corr_M
#######################################################################################
#                                                                                     #
#                                     Analyses                                        #
#                                                                                     #
#######################################################################################
ggplot(data=data_D,aes(x=Row,y=Tree,fill=Height))+
geom_tile()+
scale_fill_gradientn(colours = terrain.colors(10))
citation("sommer")
ggplot(data=data_D,aes(x=Height,group=pruning,fill=pruning))+
geom_histogram(alpha=0.5)
ggplot(data=data_D,aes(x=Height,group=pruning,fill=pruning))+
geom_density(alpha=0.5)
Covarrubias-Pazaran G. 2016. Genome assisted prediction of quantitative traits using the R package sommer. PLoS ONE 11(6):1-15.
mix1 <-  mmer2(Height~pruning,
random=~g(id)+ Rowf + Treef + spl2D(Row,Tree),
rcov=~units,
G= list(id=A), silent=TRUE,
data=data_D)
summary(mix1)
plot(mix1)
fittedvals <- spatPlots(mix1,row = "Row", range = "Tree")
vm0 <- variogram(mix1, xcoor = "Row", ycoor = "Tree")
plot(vm0$F1)
plot(data_D$Height,mix1$fitted.y)
str(mix1)
data_D$Height_pred <- mix1$u.hat$`g(id)`
fitted.y
ggplot(data_D,aes(x=Height,y=Height_pred,color=pruning))+
geom_point()+labs(x="Observed tree height",y="Predicted Relative tree height")
write.csv(data_D,"predicted_Height.csv")
