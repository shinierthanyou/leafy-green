setwd("~/leafy-green")
!["Map of F1 Trees"](Capture.png){.center}
knitr::opts_chunk$set(echo = F,cache = F)
library(xlsx)
library(ggplot2)
library(gplots)
library(gridExtra)
library(corrplot)
library(dplyr)
library(png)
library(grid)
library(heatmaply)
#Chlorophyll Replicate Comparison
RBC <- ggplot(Dup) + aes(x = Rep., y = Chl) + geom_boxplot(fill = "dodgerblue1", size = 1.25)+ ylab("Surface Chlorophyll ($g/cm^2$)") + xlab("Replicate Number") + ggtitle("Chlorophyll of Replicate Samples")+stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=5) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dup$Chl));RBC
# Import Data Measures
Data <-read.xlsx("Full.xlsx", sheetName ="Full")
head(Data)
Data$Column = as.factor(Data$Column)
Data$Row = as.factor(Data$Row)
# Import Replicate Data
Dup <-read.xlsx("Full.xlsx", sheetName ="Dup")
head(Dup)
#Isolate Crimson Glory Outgroup
CG = Data[c(1:11),]
#Isolate East Cape 201 Parent
EC201 = Data[c(12:21),]
#Isolate East Cape 103 Parent
EC103 = Data[c(22:33),]
#Isolate Offspring from the Parental Cross
F1 = Data[c(34:1825),]
#Anthocyanin
RepAnth = summary(Dup$Anth)
#Chlorophyll
RepChl = summary(Dup$Chl)
#Flavanoid
RepFlav = summary(Dup$Flav)
#NBI
RepNBI =summary(Dup$NBI)
as.table(rbind(RepAnth,RepChl,RepFlav,RepNBI))
Dup2 = group_by(Dup,Rep.)
Dup2 = summarise(Dup2, Anth = mean(Anth, na.rm = T),Chl = mean(Chl, na.rm = T), Flav = mean(Flav,na.rm = T), NBI = mean(NBI, na.rm = T))
head(Dup2)
#Anthocyanin Replicate Comparison
RBA <- ggplot(Dup) + aes(x = Rep., y = Anth,) + geom_boxplot(fill = "dodgerblue1", size = 1.25) + ylab("Anothcyanin Absorbance") + xlab("Replicate Number") + ggtitle("Anthocyanin Distribution and Mean of Replicate Groups") +stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=5) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dup$Anth));RBA
#Anth Mean Plot
RMA <-ggplot(Dup) +aes(x = Tree.ID, y = Anth, colour = Rep.,fill = Rep.) + geom_point() +geom_hline(yintercept = mean(Dup$Anth), colour = "dodgerblue1")+ ylab("Anthocyanin Absorbance") + xlab("Tree ID") + ggtitle("Anthocyanin Absorbance of Replicated Samples") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
#Histogram of Measurement Distribution
RHA <-ggplot(Dup) +aes(Anth,color=Rep., fill=Rep.) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Anthocyanin Absorbance") + ggtitle("Anthocyanin Distribution of Replicate Samples") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
#Display Plots
grid.arrange(RMA,RHA)
#Chlorophyll Replicate Comparison
RBC <- ggplot(Dup) + aes(x = Rep., y = Chl) + geom_boxplot(fill = "dodgerblue1", size = 1.25)+ ylab("Surface Chlorophyll ($g/cm^2$)") + xlab("Replicate Number") + ggtitle("Chlorophyll of Replicate Samples")+stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=5) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dup$Chl));RBC
#Chl Mean Plot
RMC <-ggplot(Dup) +aes(x = Tree.ID, y = Chl, colour = Rep.,fill = Rep.) + geom_point() +geom_hline(yintercept = mean(Dup$Chl), colour = "dodgerblue1")+ ylab("Surface Chlorophyll") + xlab("Tree ID") + ggtitle("Chlorophyll of Replicate Samples")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))
#Histogram of Chl Measurement Distribution
RHC <-ggplot(Dup) +aes(Chl,color=Rep., fill=Rep.) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Surface Chlorophyll") + ggtitle("Chlorphyll of Replicate Samples") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
#Display Plots
grid.arrange(RMC,RHC)
#Flavonol Replicate Comparison
RBF <- ggplot(Dup) + aes(x = Rep., y = Flav) + geom_boxplot(fill = "dodgerblue1", size = 1.25)+ ylab("Flavonol Absorbance") + xlab("Replicate Number") + ggtitle("Flavonol Distribution and Mean of Replicate Groups")+stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=5) +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(Dup$Flav)); RBF
#Flav Mean Plot
RMF <-ggplot(Dup) +aes(x = Tree.ID, y = Flav, colour = Rep.,fill = Rep.) + geom_point() +geom_hline(yintercept = mean(Dup$Flav), colour = "dodgerblue1")+ ylab("Flavonol Absorbance") + xlab("Tree ID") + ggtitle("Flavonol of Replicate Samples")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))
#Histogram of Flav Measurement Distribution
RHF <-ggplot(Dup) +aes(Flav,color=Rep., fill=Rep.) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+ geom_density(alpha=.2) + ylab("Frequency") + xlab("Surface Flavonol") + ggtitle("Flavonol Distribution of Replicate Samples") +theme_bw() +theme(plot.title = element_text(hjust = 0.5))
#Display Plots
grid.arrange(RMF,RHF)
#Boxplot Anthocyanin Allocation
ABA<- ggplot(Data) + aes(x = Allocation, y = Anth) + geom_boxplot(fill = "dodgerblue1", size = 1)+ ylab("Anth") + xlab("Allocation") + ggtitle("Anth of Allocations")+stat_summary(fun.y=mean, colour="green", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5)) +geom_hline(yintercept = mean(Data$Anth))
#Boxplot Chlorophyll Allocation
ABC<- ggplot(Data) + aes(x = Allocation, y = Chl) + geom_boxplot(fill = "dodgerblue1", size = 1)+ ylab("Chl") + xlab("Allocation") + ggtitle("Chl of Allocations")+stat_summary(fun.y=mean, colour="green", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5)) +geom_hline(yintercept = mean(Data$Chl))
#Boxplot Flavanol Allocation
ABF<- ggplot(Data) + aes(x = Allocation, y = Flav) + geom_boxplot(fill = "dodgerblue1", size = 1)+ ylab("Flav") + xlab("Allocation") + ggtitle("Flav of Allocations")+stat_summary(fun.y=mean, colour="green", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5)) +geom_hline(yintercept = mean(Data$Flav))
#Boxplot NBI Allocation
ABN<- ggplot(Data) + aes(x = Allocation, y = NBI) + geom_boxplot(fill = "dodgerblue1", size = 1)+ ylab("NBI") + xlab("Allocation") + ggtitle("NBI of Allocations")+stat_summary(fun.y=mean, colour="green", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5)) +geom_hline(yintercept = mean(Data$NBI))
#Display Plots
grid.arrange(ABA,ABC,ABF,ABN,ncol=2, main = "Boxplots of Stuff")
#Display Plots
grid.arrange(ABA,ABC,ABF,ABN,ncol=2, ggtitle("Means n shit"))
#Boxplot Anthocyanin Allocation
ABA<- ggplot(Data) + aes(x = Allocation, y = Anth) + geom_boxplot(fill = "dodgerblue1", size = 1)+ ylab("Anthocyanin") + xlab("Allocation") + ggtitle("Anth Abosorbance of Allocations")+stat_summary(fun.y=mean, colour="green", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5)) +geom_hline(yintercept = mean(Data$Anth))
#Boxplot Chlorophyll Allocation
ABC<- ggplot(Data) + aes(x = Allocation, y = Chl) + geom_boxplot(fill = "dodgerblue1", size = 1)+ ylab("Chlorophyll") + xlab("Allocation") + ggtitle("Surface Chl of Allocations")+stat_summary(fun.y=mean, colour="green", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5)) +geom_hline(yintercept = mean(Data$Chl))
#Boxplot Flavanol Allocation
ABF<- ggplot(Data) + aes(x = Allocation, y = Flav) + geom_boxplot(fill = "dodgerblue1", size = 1)+ ylab("Flavonol") + xlab("Allocation") + ggtitle("Flav Absortbance of Allocations")+stat_summary(fun.y=mean, colour="green", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5)) +geom_hline(yintercept = mean(Data$Flav))
#Boxplot NBI Allocation
ABN<- ggplot(Data) + aes(x = Allocation, y = NBI) + geom_boxplot(fill = "dodgerblue1", size = 1)+ ylab("NBI") + xlab("Allocation") + ggtitle("NBI of Allocations")+stat_summary(fun.y=mean, colour="green", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5)) +geom_hline(yintercept = mean(Data$NBI))
#Display Plots
grid.arrange(ABA,ABC,ABF,ABN,ncol=2,)
#Boxplot Anthocyanin Allocation
ABA<- ggplot(Data) + aes(x = Allocation, y = Anth) + geom_boxplot(fill = "dodgerblue1", size = 1)+ ylab("Anthocyanin") + xlab("Allocation") + ggtitle("Anth Abosorbance of Allocations")+stat_summary(fun.y=mean, colour="green", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5)) +geom_hline(yintercept = mean(Data$Anth))
#Boxplot Chlorophyll Allocation
ABC<- ggplot(Data) + aes(x = Allocation, y = Chl) + geom_boxplot(fill = "dodgerblue1", size = 1)+ ylab("Chlorophyll") + xlab("Allocation") + ggtitle("Surface Chl of Allocations")+stat_summary(fun.y=mean, colour="green", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5)) +geom_hline(yintercept = mean(Data$Chl))
#Boxplot Flavanol Allocation
ABF<- ggplot(Data) + aes(x = Allocation, y = Flav) + geom_boxplot(fill = "dodgerblue1", size = 1)+ ylab("Flavonol") + xlab("Allocation") + ggtitle("Flav Absortbance of Allocations")+stat_summary(fun.y=mean, colour="green", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5)) +geom_hline(yintercept = mean(Data$Flav))
#Boxplot NBI Allocation
ABN<- ggplot(Data) + aes(x = Allocation, y = NBI) + geom_boxplot(fill = "dodgerblue1", size = 1)+ ylab("NBI") + xlab("Allocation") + ggtitle("NBI of Allocations")+stat_summary(fun.y=mean, colour="green", geom="point", shape=18, size=3) +theme_bw()+theme(plot.title = element_text(hjust = 0.5)) +geom_hline(yintercept = mean(Data$NBI))
#Display Plots
grid.arrange(ABA,ABC,ABF,ABN,ncol=2)
View(Parent)
# Import Data Measures
Data <-read.xlsx("Full.xlsx", sheetName ="Full")
head(Data)
Data$Column = as.factor(Data$Column)
Data$Row = as.factor(Data$Row)
# Import Replicate Data
Dup <-read.xlsx("Full.xlsx", sheetName ="Dup")
head(Dup)
#Isolate Crimson Glory Outgroup
CG = Data[c(1:11),]
#Isolate East Cape 201 Parent
EC201 = Data[c(12:21),]
#Isolate East Cape 103 Parent
EC103 = Data[c(22:33),]
#Isolate Offspring from the Parental Cross
F1 = Data[c(34:1825),]
#Binding parents into single dataset
Parent <- rbind(EC201,EC103)
#Anthocyanin
ParAnth = summary(Parent$Anth)
#Chlorophyll
ParChl = summary(Parent$Chl)
#Flavonol
ParFlav = summary(Parent$Flav)
#NBI
ParNBI = summary(Parent$NBI)
as.table(rbind(ParAnth,ParChl,ParFlav,ParNBI))
VieW(Parent)
View(Parent)
setwd("~/leafy-green/Code Peter Jaksons")
library(xlsx)
library(ggplot2)
library(dplyr)
library(asreml)
library(asremlPlus)
library(nadiv)
library(gridExtra)
library(knitr)
library(gridExtra)
library(grid)
library(reshape2)
library(gplots)
library(sommer)
install.packages("asreml","asremlPlus","nadiv","sommer")
source("https://bioconductor.org/biocLite.R")
biocLite(“asreml”)
biocLite(asreml)
source("https://bioconductor.org/biocLite.R")
?BiocManager
install.packages("rTools","asreml","asremlPlus","nadiv","sommer")
##### Setup option #####
my_theme <- theme_bw()+theme(panel.grid = element_blank())
theme_set(my_theme)
options( stringsAsFactors=F,
max.print = 1000,
scipen=8,
digits=4)
##### read data #####
data_D <- read.xlsx("Height phenotype 20 April 2018.xlsx",sheetName = "Phenotypes April 2018",startRow = 1)
setwd("~/leafy-green/Code Peter Jaksons")
##### read data #####
data_D <- read.xlsx("Height phenotype 20 April 2018.xlsx",sheetName = "Phenotypes April 2018",startRow = 1)
snp_D <- read.csv("EC103xEC201_GBS_40clusters_abxaa.csv",header=T)
corr_D <- read.xlsx("Similarity of individuals Joinmap calculated.xlsx",sheetIndex = 2,startRow = 1)
##### data mgmt #####
data_D <- data_D[,1:5]
data_D <- data_D[!is.na(data_D$NA.),]
data_D$id <- paste0("X",data_D$NA.)
data_D$Rowf <- as.factor(data_D$Row)
data_D$Treef <- as.factor(data_D$Tree)
snp_D[snp_D=="--"] <- NA
snp_D[snp_D=="aa"] <- 0
snp_D[snp_D=="ab"] <- 1
snp_D[snp_D=="bb"] <- 2
snp_D <- snp_D[,-1]
rownames_C <- colnames(snp_D)
snp_M <- data.matrix(snp_D)
snp_M <- t(snp_M)
snp_M <- snp_M[row.names(snp_M) %in% data_D$id,]
A <-  A.mat(snp_M[])
A[1:10,1:10]
colfunc <- colorRampPalette(c("steelblue4","springgreen","yellow"))
heatmap.2(A[1:100,1:100], col = colfunc(100),Colv = "Rowv",revC=TRUE)
A <-  A.mat(snp_M[])
A[1:10,1:10]
