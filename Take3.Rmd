---
title: "Summary"
author: "Melissa Taane"
date: "7/12/2019"
output:
  html_document: default
  pdf_document: default
---

```{r setup}
knitr::opts_chunk$set(echo = FALSE,cache = TRUE)
library(xlsx)
library(ggplot2)
library(gplots)
library(gridExtra)
library(corrplot)
library(dplyr)
library(png)
library(grid)
library(heatmaply)
```


```{r data read and controlled}
#Import and Arrange Data

Data <- read.xlsx(file = "Entire.xlsx", sheetName = "Sheet1")
F1 = Data[c(34:1846),]
F1 = F1[-c(13)]

#Assign Description

F1$Height09 = as.character(F1$Height09)
F1$Height09 = as.numeric(F1$Height09)
F1$Column = as.factor(F1$Column)
F1$Flower.Level = as.factor(F1$Flower.Level)

#Removing Anthocyanin Outliers

OBA <-boxplot(F1$Anth,range = 3.5, plot = F)$out
OA = F1[which(F1$Anth %in% OBA),];OA
F1 <- F1[-which(F1$Anth %in% OBA),]

#Overall Means

F1$MAnth = mean(F1$Anth, na.rm = T)
F1$MChl = mean(F1$Chl, na.rm = T)
F1$MFlav = mean(F1$Flav, na.rm = T)
F1$M18 = mean(F1$Height08, na.rm = T)
F1$M19 = mean(F1$Height09, na.rm = T)

#Remove Overall Mean

F1$Anth2 = F1$Anth - F1$MAnth
F1$Chl2 = F1$Chl - F1$MChl
F1$Flav2 = F1$Flav - F1$MFlav
F1$H182 = F1$Height08 - F1$M18
F1$H192 = F1$Height09 - F1$M19

#Leaf Height Chemical Mean 

LM = group_by(F1, Height)
LM = summarise(LM, LMAnth = mean(Anth, na.rm = T), LMChl = mean(Chl, na.rm =T), LMFlav = mean(Flav,na.rm = T))
F1 = merge(F1, LM, by.x = "Height", all = TRUE)

#Overall Mean - Leaf Height Mean

F1$LMAnth2 = F1$MAnth - F1$LMAnth
F1$LMChl2 = F1$MChl - F1$LMChl
F1$LMFlav2 = F1$MFlav - F1$LMFlav

#Update Measures

F1$Anth3 = F1$Anth2 + F1$LMAnth2
F1$Chl3 = F1$Chl2 + F1$LMChl2
F1$Flav3 = F1$Flav2 + F1$LMFlav2

#Row Mean

RM = group_by(F1, Row)
RM = summarise(RM, RAnth = mean(Anth, na.rm = T), RChl = mean(Chl, na.rm =T), RFlav = mean(Flav,na.rm = T), R18 = mean(Height08, na.rm = T), R19 = mean(Height09, na.rm =T ))
F1 = merge(F1, RM, by.x = "Row", all = TRUE)

#Overall Mean - Row Mean

F1$RAnth2 = F1$MAnth - F1$RAnth
F1$RChl2 = F1$MChl - F1$RChl
F1$RFlav2 = F1$MFlav - F1$RFlav
F1$R182 = F1$M18 - F1$R18
F1$R192 = F1$M19 - F1$R19

#Update Measures

F1$Anth4 = F1$Anth2 + F1$RAnth2
F1$Chl4 = F1$Chl2 + F1$RChl2
F1$Flav4 = F1$Flav2 + F1$RFlav2
F1$H184 = F1$H182 + F1$R182
F1$H194 = F1$H192 + F1$R192

#Column Mean

CM = group_by(F1, Column)
CM = summarise(CM, CAnth = mean(Anth, na.rm = T), CChl = mean(Chl, na.rm =T), CFlav = mean(Flav,na.rm = T), C18 = mean(Height08, na.rm = T), C19 = mean(Height09, na.rm =T))
F1 = merge(F1, CM, by.x = "Column", all = TRUE)

#Overall Mean - Column Mean

F1$CAnth2 = F1$MAnth - F1$CAnth
F1$CChl2 = F1$MChl - F1$CChl
F1$CFlav2 = F1$MFlav - F1$CFlav
F1$C182 = F1$M18 - F1$C18
F1$C192 = F1$M19 - F1$C19

#Update Measures

F1$Anth5 = F1$Anth4 + F1$CAnth2
F1$Chl5 = F1$Chl4 + F1$CChl2
F1$Flav5 = F1$Flav4 + F1$CFlav2
F1$H185 = F1$H184 + F1$C182
F1$H195 = F1$H194 + F1$C192


#Height Differences Between 2018 and 2019

F1$HDiff = F1$H195 - F1$H185
```

## Tree Plots

```{r Tree plots}
Tree = group_by(F1,Tree.ID)
Tree = summarise(Tree, AnthT = mean(Anth5, na.rm = T), ChlT = mean(Chl5, na.rm =T), FlavT = mean(Flav5,na.rm = T), H18T = mean(H185, na.rm = T), H19T = mean(H195, na.rm =T), HDT = mean(HDiff, na.rm =T))
```

### Anthocyanin

```{r Tree Anth}
AnthDoc <-read.xlsx("ABC2.xlsx", sheetName = "Anth")
heatmaply(AnthDoc, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "Anthocyanin Map")

AP3 = ggplot(F1) + aes(x = Tree.ID, y = Anth5) + geom_boxplot(fill = "dodgerblue1") + ylab("Anth") + xlab("Tree.ID") + ggtitle("Anthocyanin Measures Tree Distributions") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = 0, colour = "red");AP3

AP32 <-ggplot(Tree) +aes(x = Tree.ID, y = AnthT) + geom_point() +geom_hline(yintercept = mean(F1$Anth5, na.rm = T), colour = "dodgerblue1")+ ylab("Anthocyanin") + xlab("Tree.ID") + ggtitle("Anthocyanin Tree Means")+theme_bw()+theme(plot.title = element_text(hjust = 0.5));AP32

AP33 <-ggplot(Tree) +aes(AnthT) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Anthocyanin") + ggtitle("Anthocyanin Distribution of F1 Trees After Correction") +theme_bw() +theme(plot.title = element_text(hjust = 0.5));AP33
```

+ ANOVA

```{r}
modA1 = lm(F1$Anth5 ~ F1$Tree.ID)
anova(modA1)
```
+ R.squared

```{r}
summary(modA1)$r.squared
```

### Chlorophyll

```{r Tree Chl}

ChlDoc <-read.xlsx("ABC2.xlsx", sheetName = "Chl")
heatmaply(ChlDoc, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "Chlorophyll Map")

CP3 = ggplot(F1) + aes(x = Tree.ID, y = Chl5) + geom_boxplot(fill = "dodgerblue1") + ylab("Chl") + xlab("Tree.ID") + ggtitle("Chlorophyll") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = 0, colour = "red");CP3

CP32 <-ggplot(Tree) +aes(x = Tree.ID, y = ChlT) + geom_point() +geom_hline(yintercept = mean(F1$Chl5, na.rm = T), colour = "dodgerblue1")+ ylab("Chlorophyll") + xlab("Tree.ID") + ggtitle("Chlorophyll Tree Means")+theme_bw()+theme(plot.title = element_text(hjust = 0.5));CP32

CP33 <-ggplot(Tree) +aes(ChlT) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Chlorophyll") + ggtitle("Chlorophyll Distribution of F1 Trees After Correction") +theme_bw() +theme(plot.title = element_text(hjust = 0.5));CP33
```

+ ANOVA

```{r}
modC1 = lm(F1$Chl5 ~ F1$Tree.ID)
anova(modC1)
```

+ R.squared

```{r}
summary(modC1)$r.squared
```

### Flavonol

```{r Tree Flav}

FlavDoc <-read.xlsx("ABC2.xlsx", sheetName = "Flav")
heatmaply(FlavDoc, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "Flavonol Map")

FP3 = ggplot(F1) + aes(x = Tree.ID, y = Flav5) + geom_boxplot(fill = "dodgerblue1") + ylab("Flav") + xlab("Tree.ID") + ggtitle("Flavonol") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = 0, colour = "red");FP3

FP32 <-ggplot(Tree) +aes(x = Tree.ID, y = FlavT) + geom_point() +geom_hline(yintercept = mean(F1$Flav5, na.rm = T), colour = "dodgerblue1")+ ylab("Flavonol") + xlab("Tree.ID") + ggtitle("Flavonol Tree Means")+theme_bw()+theme(plot.title = element_text(hjust = 0.5));FP32

FP33 <-ggplot(Tree) +aes(FlavT) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Flavonol") + ggtitle("Flavonol Distribution of F1 Trees After Correction") +theme_bw() +theme(plot.title = element_text(hjust = 0.5));FP33
```

+ ANOVA

```{r}
modF1 = lm(F1$Flav5 ~ F1$Tree.ID)
anova(modF1)
```

+ R.squared

```{r}
summary(modF1)$r.squared
```

### Height 2018

```{r Tree Height 2018}
H18Doc <-read.xlsx("ABC2.xlsx", sheetName = "2018")
heatmaply(H18Doc, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "2018 Heights")

H18P3 = ggplot(F1) + aes(x = Tree.ID, y = H185) + geom_boxplot(fill = "dodgerblue1") + ylab("Height") + xlab("Tree.ID") + ggtitle("Height 2018") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = 0, colour = "red");H18P3

H18P32 <-ggplot(Tree) +aes(x = Tree.ID, y = H18T) + geom_point() +geom_hline(yintercept = mean(F1$H185, na.rm = T), colour = "dodgerblue1")+ ylab("Height") + xlab("Tree.ID") + ggtitle("2018 Tree Height Means")+theme_bw()+theme(plot.title = element_text(hjust = 0.5));H18P32

H18P33 <-ggplot(Tree) +aes(H18T) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Height") + ggtitle("2018 Height Distribution F1 Trees After Correction") +theme_bw() +theme(plot.title = element_text(hjust = 0.5));H18P33
```

+ ANOVA

```{r}
mod181 = lm(F1$H185 ~ F1$Tree.ID)
anova(mod181)
```

+ R.squared

```{r}
summary(mod181)$r.squared
```

### Height 2019

```{r Tree Height 2019}

H19Doc <-read.xlsx("ABC2.xlsx", sheetName = "2018")
heatmaply(H19Doc, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "2019 Heights")

H19P3 = ggplot(F1) + aes(x = Tree.ID, y = H195) + geom_boxplot(fill = "dodgerblue1") + ylab("Height") + xlab("Tree.ID") + ggtitle("2019 Height") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = 0, colour = "red");H19P3

H19P32 <-ggplot(Tree) +aes(x = Tree.ID, y = H19T) + geom_point() +geom_hline(yintercept = mean(F1$H195, na.rm = T), colour = "dodgerblue1")+ ylab("2019 Height") + xlab("Tree.ID") + ggtitle("2019 Tree Height Means")+theme_bw()+theme(plot.title = element_text(hjust = 0.5));H19P32

H19P33 <-ggplot(Tree) +aes(H19T) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Flavonol") + ggtitle("2019 Heights of F1 Trees After Correction") +theme_bw() +theme(plot.title = element_text(hjust = 0.5));H19P33
```

+ ANOVA

```{r}
mod191 = lm(F1$H195 ~ F1$Tree.ID)
anova(mod191)
```

+ R.squared

```{r}
summary(mod191)$r.squared
```

### Height Difference 2018-2019

```{r Tree Height Diff}

HDDoc <-read.xlsx("ABC2.xlsx", sheetName = "HDiff")
heatmaply(HDDoc, xlab = "Column",ylab ="Row", Rowv = FALSE, Colv = FALSE, main = "Height Differences Between 2018 and 2019")

HDP3 = ggplot(F1) + aes(x = Tree.ID, y = HDiff) + geom_boxplot(fill = "dodgerblue1") + ylab("Height") + xlab("Tree.ID") + ggtitle("Height Differences 2018-19") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = 0, colour = "red");HDP3

HDP32 <-ggplot(Tree) +aes(x = Tree.ID, y = HDT) + geom_point() +geom_hline(yintercept = mean(F1$H195, na.rm = T), colour = "dodgerblue1")+ ylab("Height") + xlab("Tree.ID") + ggtitle("2018-19 Height Difference Tree Means")+theme_bw()+theme(plot.title = element_text(hjust = 0.5));HDP32

HDP33 <-ggplot(Tree) +aes(HDT) +geom_histogram(aes(y=..density..), alpha=0.5, position="identity",colour = "turquoise3",fill ="turquoise1" )+ geom_density(alpha=.2,colour = "orchid1",fill = "orchid3") + ylab("Frequency") + xlab("Height") + ggtitle("Height Distribution of Tree Differences 2018-19 After Correction") +theme_bw() +theme(plot.title = element_text(hjust = 0.5));HDP33
```

+ Anova

```{r}
modHD1 = lm(F1$HDiff ~ F1$Tree.ID)
anova(modHD1)
```

+ R.squared

```{r}
summary(modHD1)$r.squared
```

## Leaf Height Plots

### Anthocyanin
```{r Anth Leaf plots}
AP4 = ggplot(data = subset(F1, !is.na(Height))) + aes(x =Height, y = Anth5) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Flav") + xlab("Height") + ggtitle("Anthocyanin by Collection Height") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = 0, colour = "red")+stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3);AP4
```

+ ANOVA

```{r}
modA2 = lm(F1$Anth5 ~ F1$Height)
anova(modA2)
```

+ R.squared

```{r}
summary(modA2)$r.squared
```

### Chlorophyll

```{r Chl Leaf Plots}
CP4 = ggplot(data = subset(F1, !is.na(Height))) + aes(x = Height, y = Chl5) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Chl") + xlab("Height") + ggtitle("Chlorophyll by Collection Height") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = 0, colour = "red")+stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3);CP4
```

+ ANOVA

```{r}
modC2 = lm(F1$Chl5 ~ F1$Height)
anova(modC2)
```

+ R.squared

```{r}
summary(modC2)$r.squared
```

### Flavonol

```{r Flav Leaf Plots}
FP4 = ggplot(data = subset(F1, !is.na(Height))) + aes(x = Height, y = Flav5) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Flav") + xlab("Height") + ggtitle("Flavonol by Collection Height") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = 0, colour = "red")+stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3);FP4
```

+ ANOVA

```{r}
modF2 = lm(F1$Flav5 ~ F1$Height)
anova(modF2)
```

+ R.squared

```{r}
summary(modF2)$r.squared
```

## Row Plots

```{r Row plots}
R = group_by(F1, Row)
R = summarise(R, AnthR = mean(Anth5, na.rm = T), ChlR = mean(Chl5, na.rm =T), FlavR = mean(Flav5,na.rm = T), H18R = mean(H185, na.rm = T), H19R = mean(H195, na.rm =T), HDR = mean(HDiff, na.rm =T))
```

### Anthocyanin

```{r}
#Anthocyanin
AP1 = ggplot(F1) + aes(x = Row, y = Anth5) + geom_boxplot(fill = "dodgerblue1") + ylab("Anth") + xlab("Row") + ggtitle("Anthocyanin by Row") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = 0, colour = "red");AP1

AP12 <-ggplot(R) +aes(x = Row, y = AnthR) + geom_point() +geom_hline(yintercept = mean(F1$Anth5, na.rm = T), colour = "dodgerblue1")+ ylab("Anthocyanin") + xlab("Row") + ggtitle("Anthocyanin Row Means")+theme_bw()+theme(plot.title = element_text(hjust = 0.5));AP12
```

+ ANOVA

```{r}
modA3 = lm(F1$Anth5 ~ F1$Row)
anova(modA3)
```

+ R.squared

```{r}
summary(modA3)$r.squared
```

### Chlorophyll

```{r}
#Chlorophyll
CP1 = ggplot(F1) + aes(x = Row, y = Chl5) + geom_boxplot(fill = "dodgerblue1") + ylab("Chl") + xlab("Row") + ggtitle("Chlorophyll by Row") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = 0, colour = "red");CP1

CP12 <-ggplot(R) +aes(x = Row, y = ChlR) + geom_point() +geom_hline(yintercept = mean(F1$Chl5, na.rm = T), colour = "dodgerblue1")+ ylab("Chlorophyll") + xlab("Row") + ggtitle("Chlorophyll Row Means")+theme_bw()+theme(plot.title = element_text(hjust = 0.5));CP12
```

+ ANOVA

```{r}
modC3 = lm(F1$Chl5 ~ F1$Row)
anova(modC3)
```

+ R.squared

```{r}
summary(modC3)$r.squared
```

### Flavonol

```{r}
#Flavonol
FP1 = ggplot(F1) + aes(x = Row, y = Flav5) + geom_boxplot(fill = "dodgerblue1") + ylab("Flav") + xlab("Row") + ggtitle("Flavonol by Row") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = 0, colour = "red");FP1

FP12 <-ggplot(R) +aes(x = Row, y = FlavR) + geom_point() +geom_hline(yintercept = mean(F1$Flav5, na.rm = T), colour = "dodgerblue1")+ ylab("Flavonol") + xlab("Row") + ggtitle("Flavonol Row Means")+theme_bw()+theme(plot.title = element_text(hjust = 0.5));FP12
```

+ ANOVA

```{r}
modF3 = lm(F1$Flav5 ~ F1$Row)
anova(modF3)
```

+ R.squared

```{r}
summary(modF3)$r.squared
```

### Height 2018

```{r}
#2018 Heights
H8P1 = ggplot(F1) + aes(x = Row, y = H185) + geom_boxplot(fill = "dodgerblue1") + ylab("Height") + xlab("Row") + ggtitle("Height Measures by Row 2018") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = 0, colour = "red");H8P1

H8P12 <-ggplot(R) +aes(x = Row, y = H18R) + geom_point() +geom_hline(yintercept = mean(F1$H185, na.rm = T), colour = "dodgerblue1")+ ylab("Height") + xlab("Row") + ggtitle("Height Row Means 2018")+theme_bw()+theme(plot.title = element_text(hjust = 0.5));H8P12
```

+ ANOVA

```{r}
mod183 = lm(F1$H185 ~ F1$Row)
anova(mod183)
```

+ R.squared

```{r}
summary(mod183)$r.squared
```

### Height 2019

```{r}

H9P1 = ggplot(F1) + aes(x = Row, y = H195) + geom_boxplot(fill = "dodgerblue1") + ylab("Height)") + xlab("Row") + ggtitle("Height Measures by Row 2019") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = 0, colour = "red");H9P1

H9P12 <-ggplot(R) +aes(x = Row, y = H19R) + geom_point() +geom_hline(yintercept = mean(F1$H195, na.rm = T), colour = "dodgerblue1")+ ylab("Height") + xlab("Row") + ggtitle("Height Row Means 2019")+theme_bw()+theme(plot.title = element_text(hjust = 0.5));H9P12
```

+ ANOVA

```{r}
mod193 = lm(F1$H195 ~ F1$Row)
anova(mod193)
```

+ R.squared

```{r }
summary(mod193)$r.squared
```

### Height Difference 2018-2019

```{r}
#2018-19 Height Difference
HDP1 = ggplot(F1) + aes(x = Row, y = HDiff) + geom_boxplot(fill = "dodgerblue1") + ylab("Height)") + xlab("Row") + ggtitle("Height Difference Between Years by Row") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = 0, colour = "red");HDP1

HDP12 <-ggplot(R) +aes(x = Row, y = HDR) + geom_point() +geom_hline(yintercept = mean(F1$HDiff, na.rm = T), colour = "dodgerblue1")+ ylab("Height") + xlab("Row") + ggtitle("Height Difference 2018-19")+theme_bw()+theme(plot.title = element_text(hjust = 0.5));HDP12
```

+ ANOVA

```{r}
modHD3 = lm(F1$HDiff ~ F1$Row)
anova(modHD3)
```

+R.squared

```{r}
summary(modHD3)$r.squared
```

## Column Plots

### Anthocyanin

```{r Column plots}
AP2 = ggplot(F1) + aes(x = Column, y = Anth5) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Anth") + xlab("Column") + ggtitle("Anthocyanin by Column") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = 0, colour = "red")+stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3);AP2
```

+ ANOVA

```{r}
modA4 = lm(F1$Anth5 ~ F1$Column)
anova(modA4)
```

+ R.squared

```{r}
summary(modA4)$r.squared
```

### Chlorophyll

```{r}
CP2 = ggplot(F1) + aes(x = Column, y = Chl5) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Chl") + xlab("Column") + ggtitle("Chlorophyll by Column") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = 0, colour = "red")+stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3);CP2
```

+ ANOVA

```{r}
modC4 = lm(F1$Chl5 ~ F1$Column)
anova(modC4)
```

+ R.squared

```{r}
summary(modC4)$r.squared
```

### Flavonol

```{r}
FP2 = ggplot(F1) + aes(x = Column, y = Flav5) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Flav") + xlab("Column") + ggtitle("Flavonol by Column") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = 0, colour = "red")+stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3);FP2
```

+ ANOVA

```{r}
modF4 = lm(F1$Flav5 ~ F1$Column)
anova(modF4)
```

+ R.squared

```{r}
summary(modF4)$r.squared
```

### Height 2018

```{r}
H8P2 = ggplot(F1) + aes(x = Column, y = H185) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Height") + xlab("Column") + ggtitle("Height Measures by Column 2018") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = 0, colour = "red")+stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3);H8P2

mod184 = lm(F1$H185 ~ F1$Column)
anova(mod184)
summary(mod184)$r.squared
```

### Height 2019

```{r}
H9P2 = ggplot(F1) + aes(x = Column, y = H195) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Height)") + xlab("Column") + ggtitle("Height Measures by Column 2019") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = 0, colour = "red")+stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3);H9P2
```

+ ANOVA

```{r}
mod194 = lm(F1$H195 ~ F1$Column)
anova(mod194)
```

+ R.squared

```{r}
summary(mod194)$r.squared
```

### Height Difference 2018-2019

```{r}
HDP2 = ggplot(F1) + aes(x = Column, y = HDiff) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Height)") + xlab("Column") + ggtitle("Height Difference Between Years by Column") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$HDiff, na.rm = T), colour = "red")+stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3);HDP2
```

+ ANOVA

```{r}
modHD4 = lm(F1$HDiff ~ F1$Column)
anova(modHD4)
```

+ R.squared

```{r}
summary(modHD4)$r.squared
```

## Flowering and Flowering Levels

Flowering refers to presence or not of flowers, Flower Level refers to a measure relating to the number of flowers present (0 = no flowers, 1 = 1-10, 2 = 10-20, 3 = 20+)

### Anthocyanin

```{r Flowering}
AP5 = ggplot(F1) + aes(x = Flower.Level , y = Anth5) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Anthocyanin Levels") + xlab("Flowering Level") + ggtitle("Flowering Levels and Anthocyanin") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$Anth5, na.rm = T), colour = "red")+stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3);AP5
```

+ ANOVA Flowering Level

```{r}
modA5 = lm(F1$Anth5 ~ F1$Flower.Level)
anova(modA5)
```

+ R.squared Flowering Level

```{r}
summary(modA5)$r.squared
```

```{r }
AP52 = ggplot(F1) + aes(x = Flower , y = Anth5) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Anthocyanin Levels") + xlab("Flowering") + ggtitle("Flowering and Anthocyanin") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$Anth5, na.rm = T), colour = "red")+stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3);AP52
```

+ ANOVA Flowering Presence

```{r}
modA6 = lm(F1$Anth5 ~ F1$Flower)
```

+ R.squared Flowering Presence

```{r}
anova(modA6)
summary(modA6)$r.squared
```

### Chlorophyll

```{r }
CP5 = ggplot(F1) + aes(x = Flower.Level , y = Chl5) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Chlorophyll Levels") + xlab("Flowering Level") + ggtitle("Flowering Levels and Chlorophyll") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$Chl5, na.rm = T), colour = "red")+stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3);CP5
```

+ ANOVA Flowering Level

```{r}
modC5 = lm(F1$Chl5 ~ F1$Flower.Level)
anova(modC5)
```

+ R.squared Flowering Level

```{r}
summary(modC5)$r.squared
```

```{r}
CP52 = ggplot(F1) + aes(x = Flower , y = Chl5) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Chlorophyll Levels") + xlab("Flowering") + ggtitle("Flowering and Chlorophyll") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$Chl5, na.rm = T), colour = "red")+stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3);CP52
```

+ ANOVA Flowering Presence

```{r}
modC6 = lm(F1$Chl5 ~ F1$Flower)
anova(modC6)
```

+ R.squared Flowering Presence

```{r}
summary(modC6)$r.squared
```

### Flavonol

```{r}
FP5 = ggplot(F1) + aes(x = Flower.Level , y = Flav5) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Flavonol Levels") + xlab("Flowering Level") + ggtitle("Flowering Levels and Flavonol") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$Flav5, na.rm = T), colour = "red")+stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3);FP5
```

+ ANOVA Flowering Levels

```{r}
modF5 = lm(F1$Flav5 ~ F1$Flower.Level)
anova(modF5)
```

+ R.squared Flowering Levels

```{r}
summary(modF5)$r.squared
```

```{r}
FP52 = ggplot(F1) + aes(x = Flower , y = Flav5) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Flavonol Levels") + xlab("Flowering") + ggtitle("Flowering and Flavonol") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$Flav5, na.rm = T), colour = "red")+stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3);FP52
```

+ ANOVA Flowering Presence

```{r}
modF6 = lm(F1$Flav5 ~ F1$Flower)
anova(modF6)
```

+ R.squared Flowering Presence

```{r}
summary(modF6)$r.squared
```

### Height 2018

```{r}
H18P5 = ggplot(F1) + aes(x = Flower.Level , y = H185) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Height") + xlab("Flowering Level") + ggtitle("Flowering Levels and Height 2018") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$H185, na.rm = T), colour = "red")+stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3);H18P5
```

+ ANOVA Flowering Levels

```{r}
mod185 = lm(F1$H185 ~ F1$Flower.Level)
anova(mod185)
```

+ R.squared Flowering Levels

```{r}
summary(mod185)$r.squared
```


```{r}
H18P52 = ggplot(F1) + aes(x = Flower , y = H185) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Height") + xlab("Flowering") + ggtitle("Flowering and Height 2018") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$H185, na.rm = T), colour = "red")+stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3);H18P52
```

+ ANOVA Flower Presence

```{r}
mod186 = lm(F1$H185 ~ F1$Flower)
anova(mod186)
```

+ R.squared Flower Presence

```{r}
summary(mod186)$r.squared
```

### Height 2019

```{r }
H19P5 = ggplot(F1) + aes(x = Flower.Level , y = H195) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Height") + xlab("Flowering Level") + ggtitle("Flowering Levels and Height 2019") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$H195, na.rm = T), colour = "red")+stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3);H19P5
```

+ ANOVA Flowering Level

```{r}
mod195 = lm(F1$H195 ~ F1$Flower.Level)
anova(mod195)
```

+ R.squared Flowering Level

```{r}
summary(mod195)$r.squared
```

```{r}
H19P52 = ggplot(F1) + aes(x = Flower , y = H185) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Height") + xlab("Flowering") + ggtitle("Flowering and Height 2018") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$H185, na.rm = T), colour = "red")+stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3);H19P52
```

+ ANOVA Flower Presence

```{r}
mod196 = lm(F1$H195 ~ F1$Flower)
anova(mod196)
```

+ R.squared Flower Presence

```{r}
summary(mod196)$r.squared
```

### Height Difference 2018-2019

```{r}
HDP5 = ggplot(F1) + aes(x = Flower.Level , y = HDiff) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Height") + xlab("Flowering Level") + ggtitle("Flowering Levels and Height Difference 2018-19") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$HDiff, na.rm = T), colour = "red")+stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3);HDP5
```

+ ANOVA Flowering Level

```{r}
modHD5 = lm(F1$HDiff ~ F1$Flower.Level)
anova(modHD5)
```

+ R.squared Flowering Level

```{r}
summary(modHD5)$r.squared
```

```{r}
HD52 = ggplot(F1) + aes(x = Flower , y = HDiff) + geom_boxplot(fill = "dodgerblue1", size = 1) + ylab("Height") + xlab("Flowering") + ggtitle("Flowering and Height Differences 2018-2019") +theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_hline(yintercept = mean(F1$H185, na.rm = T), colour = "red")+stat_summary(fun.y=mean, colour="gray90", geom="point", shape=18, size=3);HD52
```

+ ANOVA Flowering Presence

```{r}
modHD6 = lm(F1$HDiff ~ F1$Flower)
anova(modHD6)
```

+ R.squared Flowering Presence

```{r}
summary(modHD6)$r.squared
```

## Measure Correlations

### Anthocyanin and Chlorophyll

```{r}
CorA1 = ggplot(F1) +aes(x = Anth5, y = Chl5) + geom_point(colour = "turquoise3") + ylab("Chlorophyll") + xlab("Anthocyanin") + ggtitle("Anthocyanin and Chlorophyll")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth();CorA1
```

+ ANOVA

```{r}
modA7 = lm(F1$Anth5 ~ F1$Chl5)
anova(modA7)
```

+ R.squared

```{r}
summary(modA7)$r.squared
```

### Anthocyanin and Flavonol

```{r}
CorA2 = ggplot(F1) +aes(x = Anth5, y = Flav5) + geom_point(colour = "turquoise3") + ylab("Flavonol") + xlab("Anthocyanin") + ggtitle("Anthocyanin and Flavonol")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth();CorA2
```

+ ANOVA

```{r}
modA8 = lm(F1$Anth5 ~ F1$Flav5)
anova(modA8)
```

+ R.squared

```{r}
summary(modA8)$r.squared
```

### Anothcyanin and Height 2018

```{r}
CorA3 = ggplot(F1) +aes(x = Anth5, y = H185) + geom_point(colour = "turquoise3") + ylab("Height") + xlab("Anthocyanin") + ggtitle("Anthocyanin and Height 2018")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth();CorA3
```

+ ANOVA

```{r}
modA9 = lm(F1$Anth5 ~ F1$H185)
anova(modA9)
```

+ R.squared

```{r}
summary(modA9)$r.squared
```

### Anthocyanin and Height 2019

```{r}
CorA4 = ggplot(F1) +aes(x = Anth5, y = H195) + geom_point(colour = "turquoise3") + ylab("Height") + xlab("Anthocyanin") + ggtitle("Anthocyanin and Height 2019")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth();CorA4
```

+ ANOVA

```{r}
modA10 = lm(F1$Anth5 ~ F1$H195)
anova(modA10)
```

+ R.squared

```{r}
summary(modA10)$r.squared
```

### Anthocyanin and Height Difference Between 2018 and 2019

```{r}
CorA5 = ggplot(F1) +aes(x = Anth5, y = HDiff) + geom_point(colour = "turquoise3") + ylab("Height") + xlab("Anthocyanin") + ggtitle("Anthocyanin and Height Difference 2018-19")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth();CorA5
```

+ ANOVA

```{r}
modA11 = lm(F1$Anth5 ~ F1$HDiff)
anova(modA11)
```

+ R.squared

```{r}
summary(modA11)$r.squared
```

### Chlorophyll and Flavonol

```{r}
CorC1 = ggplot(F1) +aes(x = Chl5, y = Flav5) + geom_point(colour = "turquoise3") + ylab("Flavonol") + xlab("Chlorophyll") + ggtitle("Chlorophyll and Flavonol")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth();CorC1
```

+ ANOVA

```{r}
modC7 = lm(F1$Chl5 ~ F1$Flav5)
anova(modA8)
```

+ R.squared

```{r}
summary(modA8)$r.squared
```

### Chlorophyll and Height 2018

```{r}
CorC2 = ggplot(F1) +aes(x = Chl5, y = H185) + geom_point(colour = "turquoise3") + ylab("Height") + xlab("Chlorophyll") + ggtitle("Chlorophyll and Height 2018")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth();CorC2
```

+ ANOVA

```{r}
modC8 = lm(F1$Chl5 ~ F1$H185)
anova(modC8)
```

+ R.squared

```{r}
summary(modC8)$r.squared
```

### Chlorophyll and Height 2019

```{r}
CorC3 = ggplot(F1) +aes(x = Chl5, y = H195) + geom_point(colour = "turquoise3") + ylab("Height") + xlab("Chlorophyll") + ggtitle("Chlorophyll and Height 2019")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth();CorC3
```

+ ANOVA

```{r}
modC9 = lm(F1$Chl5 ~ F1$H195)
anova(modC9)
```

+ R.squared

```{r}
summary(modC9)$r.squared
```

### Chlorophyll and Height Difference Between 2018 and 2019

```{r}
CorC4 = ggplot(F1) +aes(x = Chl5, y = HDiff) + geom_point(colour = "turquoise3") + ylab("Height") + xlab("Chlorophyll") + ggtitle("Chlorophyll and Height Difference 2018-19")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth();CorC4
```

+ ANOVA

```{r}
modC10 = lm(F1$Chl5 ~ F1$HDiff)
anova(modC10)
```

+ R.squared

```{r}
summary(modC10)$r.squared
```

### Flavonol and Height 2018

```{r}
CorF1 = ggplot(F1) +aes(x = Flav5, y = H185) + geom_point(colour = "turquoise3") + ylab("Height") + xlab("Flavonol") + ggtitle("Flavonol and Height 2018")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth();CorF1
```

+ ANOVA

```{r}
modF7 = lm(F1$Flav5 ~ F1$H185)
anova(modF7)
```

+ R.squared

```{r}
summary(modF7)$r.squared
```

### Flavonoil and Height 2019

```{r}
CorF2 = ggplot(F1) +aes(x = Flav5, y = H195) + geom_point(colour = "turquoise3") + ylab("Height") + xlab("Flavonol") + ggtitle("Flavonol and Height 2019")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth();CorF2
```

+ ANOVA

```{r}
modF8 = lm(F1$Flav5 ~ F1$H195)
anova(modF8)
```

+ R.squared

```{r}
summary(modF8)$r.squared
```

### Flavonol and Height Difference Between 2018 and 2019

```{r}
CorF9 = ggplot(F1) +aes(x = Flav5, y = HDiff) + geom_point(colour = "turquoise3") + ylab("Height") + xlab("Flavonol") + ggtitle("Flavonol and Height Difference 2018-19")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth();CorF9
```

+ ANOVA

```{r}
modF9 = lm(F1$Flav5 ~ F1$HDiff)
anova(modF9)
```

+ R.squared

```{r}
summary(modF9)$r.squared
```

### Height 2018 and 2019

```{r}
Cor181 = ggplot(F1) +aes(x = H185, y = H195) + geom_point(colour = "turquoise3") + ylab("Height 2019") + xlab("Height 2018") + ggtitle("Height 2018 Compared with 2019")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth();Cor181
```

+ ANOVA

```{r}
mod187 = lm(F1$H185 ~ F1$H195)
anova(mod187)
```

+ R.squared

```{r}
summary(mod187)$r.squared
```

### Height 2018 and Height Difference Between 2018 and 2019

```{r}
Cor182 = ggplot(F1) +aes(x = H185, y = HDiff) + geom_point(colour = "turquoise3") + ylab("Height Difference") + xlab("Height 2018") + ggtitle("2018 Height and Height Difference 2018-19")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth();Cor182
```

+ ANOVA

```{r}
mod188 = lm(F1$H185 ~ F1$HDiff)
anova(mod188)
```

+ R.squared

```{r}
summary(mod188)$r.squared
```

### Height 2019 and Height Difference Between 2018 and 2019

```{r}
Cor192 = ggplot(F1) +aes(x = H195, y = HDiff) + geom_point(colour = "turquoise3") + ylab("Height Difference") + xlab("Height 2019") + ggtitle("2019 Height and Height Difference 2018-19")+theme_bw()+theme(plot.title = element_text(hjust = 0.5))+geom_smooth();Cor192
```

+ ANOVA

```{r}
mod198 = lm(F1$H195 ~ F1$HDiff)
anova(mod188)
```

+ R.squared

```{r}
summary(mod188)$r.squared
```